ARM GAS  /tmp/ccsur3Tq.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"hall_detection.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.Hall_start_detection,"ax",%progbits
  18              		.align	1
  19              		.global	Hall_start_detection
  20              		.arch armv7e-m
  21              		.syntax unified
  22              		.thumb
  23              		.thumb_func
  24              		.fpu fpv4-sp-d16
  26              	Hall_start_detection:
  27              	.LFB235:
  28              		.file 1 "Core/Src/hall_detection.c"
   1:Core/Src/hall_detection.c **** /*
   2:Core/Src/hall_detection.c ****  * hall_detection.c
   3:Core/Src/hall_detection.c ****  *
   4:Core/Src/hall_detection.c ****  *  Created on: Jan 30, 2024
   5:Core/Src/hall_detection.c ****  *      Author: javier.munoz.saez@upc.edu
   6:Core/Src/hall_detection.c ****  */
   7:Core/Src/hall_detection.c **** 
   8:Core/Src/hall_detection.c **** #include "hall_detection.h" 		/*!< contains all enums, structs and includes neccesary for this .c, 
   9:Core/Src/hall_detection.c **** 
  10:Core/Src/hall_detection.c **** //Uncomment only one
  11:Core/Src/hall_detection.c **** //#define REAL_PHASES_A_B_calculated_C		/*!< our ADC is reading real current signals A and B, C=-A-
  12:Core/Src/hall_detection.c **** #define REAL_PHASES_A_C_calculated_B		/*!< our ADC is reading real current signals A and C, B=-A-C 
  13:Core/Src/hall_detection.c **** //#define REAL_PHASES_B_C_calculated_A		/*!< our ADC is reading real current signals B and C, A=-B-
  14:Core/Src/hall_detection.c **** 
  15:Core/Src/hall_detection.c **** #define TESTuart
  16:Core/Src/hall_detection.c **** 
  17:Core/Src/hall_detection.c **** 
  18:Core/Src/hall_detection.c **** #ifdef TESTuart
  19:Core/Src/hall_detection.c **** #include "usart.h"
  20:Core/Src/hall_detection.c **** #endif
  21:Core/Src/hall_detection.c **** 
  22:Core/Src/hall_detection.c **** #define MAXTICKs 1*888888		/*!< timeout for the algorithm, measured in 0.05s ticks , so 1000*0.05=5
  23:Core/Src/hall_detection.c **** #define currentAplusBplusC (uint32_t)(3*(4096)/2)	/*!< the sum of the average of each currents shou
  24:Core/Src/hall_detection.c **** #define currentADCoffset (float) 0.0				/*!< as we are using already processed filtered currents, n
  25:Core/Src/hall_detection.c **** #define TOLERANCE_FACTOR_FOR_STATIONARY_CURRENTS 0.25
  26:Core/Src/hall_detection.c **** #define WAITING_STATIONARY_MAXZEROCROSSINGS 6
  27:Core/Src/hall_detection.c **** #define NUMBER_OF_VALID_MATCHING_RESULTS 3
  28:Core/Src/hall_detection.c **** 
  29:Core/Src/hall_detection.c **** 
  30:Core/Src/hall_detection.c **** 
ARM GAS  /tmp/ccsur3Tq.s 			page 2


  31:Core/Src/hall_detection.c **** 
  32:Core/Src/hall_detection.c **** //LOCAL VARIABLES (only declared inside this .c file)
  33:Core/Src/hall_detection.c **** uint32_t ticks; 								/*!< ticks are the time measurement unit of this algorithm, each run of the
  34:Core/Src/hall_detection.c **** detection_state_enum detection_state=detection_DISABLED;	/*!< main enable disable variable, when it
  35:Core/Src/hall_detection.c **** hall_detection_general_struct general={0};
  36:Core/Src/hall_detection.c **** const hall_detection_general_struct empty_general={0};
  37:Core/Src/hall_detection.c **** 
  38:Core/Src/hall_detection.c **** 
  39:Core/Src/hall_detection.c **** 
  40:Core/Src/hall_detection.c **** 
  41:Core/Src/hall_detection.c **** 
  42:Core/Src/hall_detection.c **** 
  43:Core/Src/hall_detection.c **** 
  44:Core/Src/hall_detection.c **** 
  45:Core/Src/hall_detection.c **** 
  46:Core/Src/hall_detection.c **** //PUBLIC FUNCTIONS (also declared in the .h file)
  47:Core/Src/hall_detection.c **** void Hall_start_detection();
  48:Core/Src/hall_detection.c **** uint32_t Hall_is_detection_finished();
  49:Core/Src/hall_detection.c **** void Hall_Identification_Test_measurement(
  50:Core/Src/hall_detection.c **** 		hall_pin_info* H1_gpio,
  51:Core/Src/hall_detection.c **** 		hall_pin_info* H2_gpio,
  52:Core/Src/hall_detection.c **** 		hall_pin_info* H3_gpio,
  53:Core/Src/hall_detection.c **** 		volatile float* ADCcurr1,
  54:Core/Src/hall_detection.c **** 		volatile float* ADCcurr2
  55:Core/Src/hall_detection.c **** 		);
  56:Core/Src/hall_detection.c **** 
  57:Core/Src/hall_detection.c **** 
  58:Core/Src/hall_detection.c **** 
  59:Core/Src/hall_detection.c **** //PRIVATE FUNCTIONS (only declared inside this .c file)
  60:Core/Src/hall_detection.c **** //state machine
  61:Core/Src/hall_detection.c **** void resetVariables_adquisition					(hall_detection_general_struct *gen);
  62:Core/Src/hall_detection.c **** void resetVariables_diferences					(hall_detection_general_struct *gen);
  63:Core/Src/hall_detection.c **** void resetVariables_results						(hall_detection_general_struct *gen);
  64:Core/Src/hall_detection.c **** void wait_for_the_current_stationary(detection_state_enum* state,hall_detection_general_struct *gen
  65:Core/Src/hall_detection.c **** void adquisition					(detection_state_enum* state,hall_detection_general_struct *gen,hall_pin_info*
  66:Core/Src/hall_detection.c **** void interpretation					(detection_state_enum* state,hall_detection_general_struct *gen);
  67:Core/Src/hall_detection.c **** void validation						(detection_state_enum* state,hall_detection_general_struct *gen);
  68:Core/Src/hall_detection.c **** void present_and_finish				(detection_state_enum* state,hall_detection_general_struct *gen);
  69:Core/Src/hall_detection.c **** void error_handler();
  70:Core/Src/hall_detection.c **** void fill_buffers(
  71:Core/Src/hall_detection.c **** 		hall_detection_general_struct *gen,
  72:Core/Src/hall_detection.c **** 		hall_pin_info* H1_gpio,
  73:Core/Src/hall_detection.c **** 		hall_pin_info* H2_gpio,
  74:Core/Src/hall_detection.c **** 		hall_pin_info* H3_gpio,
  75:Core/Src/hall_detection.c **** 		volatile float* ADCcurr1,
  76:Core/Src/hall_detection.c **** 		volatile float* ADCcurr2
  77:Core/Src/hall_detection.c **** 		);
  78:Core/Src/hall_detection.c **** detection_YES_NO detect_N_zerocrossings	(hall_detection_general_struct *gen,uint32_t N);
  79:Core/Src/hall_detection.c **** void detect_N_current_zerocrossings	(hall_detection_general_struct *gen,uint32_t ticks,current_or_h
  80:Core/Src/hall_detection.c **** void detect_N_hall_zerocrossings	(uint32_t ticks,current_or_hall_measurements_struct* hallx,uint32_
  81:Core/Src/hall_detection.c **** void calculateElectricPeriod_inTicks(hall_detection_general_struct *gen, uint32_t samples);
  82:Core/Src/hall_detection.c **** detection_YES_NO is_deviation_from_period_acceptable(hall_detection_general_struct *gen, float tole
  83:Core/Src/hall_detection.c **** detection_YES_NO are_all_periods_stable(hall_detection_general_struct *gen, uint32_t samples);
  84:Core/Src/hall_detection.c **** int32_t absolute(int32_t x);
  85:Core/Src/hall_detection.c **** void assign_closest_phase_to_hall(hall_detection_general_struct *gen);
  86:Core/Src/hall_detection.c **** void assign_polarity(hall_detection_general_struct *gen);
  87:Core/Src/hall_detection.c **** void swap_hall_gpios_with_detected_results(hall_detection_general_struct *gen,hall_pin_info* pin_in
ARM GAS  /tmp/ccsur3Tq.s 			page 3


  88:Core/Src/hall_detection.c **** 
  89:Core/Src/hall_detection.c **** 
  90:Core/Src/hall_detection.c **** 
  91:Core/Src/hall_detection.c **** 
  92:Core/Src/hall_detection.c **** 
  93:Core/Src/hall_detection.c **** 
  94:Core/Src/hall_detection.c **** 
  95:Core/Src/hall_detection.c **** 
  96:Core/Src/hall_detection.c **** /**
  97:Core/Src/hall_detection.c **** * \brief public function , this should me called by anyone otside this .c .h to start the hall dete
  98:Core/Src/hall_detection.c **** */
  99:Core/Src/hall_detection.c **** void Hall_start_detection(){
  29              		.loc 1 99 28 view -0
  30              		.cfi_startproc
  31              		@ args = 0, pretend = 0, frame = 0
  32              		@ frame_needed = 0, uses_anonymous_args = 0
  33              		@ link register save eliminated.
 100:Core/Src/hall_detection.c **** 	detection_state=detection_ENABLED;
  34              		.loc 1 100 2 view .LVU1
  35              		.loc 1 100 17 is_stmt 0 view .LVU2
  36 0000 014B     		ldr	r3, .L2
  37 0002 0122     		movs	r2, #1
  38 0004 1A70     		strb	r2, [r3]
 101:Core/Src/hall_detection.c **** }
  39              		.loc 1 101 1 view .LVU3
  40 0006 7047     		bx	lr
  41              	.L3:
  42              		.align	2
  43              	.L2:
  44 0008 00000000 		.word	.LANCHOR0
  45              		.cfi_endproc
  46              	.LFE235:
  48              		.section	.text.Hall_is_detection_finished,"ax",%progbits
  49              		.align	1
  50              		.global	Hall_is_detection_finished
  51              		.syntax unified
  52              		.thumb
  53              		.thumb_func
  54              		.fpu fpv4-sp-d16
  56              	Hall_is_detection_finished:
  57              	.LFB236:
 102:Core/Src/hall_detection.c **** 
 103:Core/Src/hall_detection.c **** /**
 104:Core/Src/hall_detection.c **** * \brief public function , this should me called by anyone otside this .c .h to figure out if the d
 105:Core/Src/hall_detection.c **** */
 106:Core/Src/hall_detection.c **** uint32_t Hall_is_detection_finished(){
  58              		.loc 1 106 38 is_stmt 1 view -0
  59              		.cfi_startproc
  60              		@ args = 0, pretend = 0, frame = 0
  61              		@ frame_needed = 0, uses_anonymous_args = 0
  62              		@ link register save eliminated.
 107:Core/Src/hall_detection.c **** 	if(detection_state==detection_DISABLED){
  63              		.loc 1 107 2 view .LVU5
  64              		.loc 1 107 20 is_stmt 0 view .LVU6
  65 0000 034B     		ldr	r3, .L7
  66 0002 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
  67              		.loc 1 107 4 view .LVU7
ARM GAS  /tmp/ccsur3Tq.s 			page 4


  68 0004 0BB9     		cbnz	r3, .L6
 108:Core/Src/hall_detection.c **** 		return YES;
  69              		.loc 1 108 10 view .LVU8
  70 0006 0120     		movs	r0, #1
  71 0008 7047     		bx	lr
  72              	.L6:
 109:Core/Src/hall_detection.c **** 	}else{
 110:Core/Src/hall_detection.c **** 		return NO;
  73              		.loc 1 110 10 view .LVU9
  74 000a 0020     		movs	r0, #0
 111:Core/Src/hall_detection.c **** 	}
 112:Core/Src/hall_detection.c **** }
  75              		.loc 1 112 1 view .LVU10
  76 000c 7047     		bx	lr
  77              	.L8:
  78 000e 00BF     		.align	2
  79              	.L7:
  80 0010 00000000 		.word	.LANCHOR0
  81              		.cfi_endproc
  82              	.LFE236:
  84              		.section	.text.present_and_finish,"ax",%progbits
  85              		.align	1
  86              		.global	present_and_finish
  87              		.syntax unified
  88              		.thumb
  89              		.thumb_func
  90              		.fpu fpv4-sp-d16
  92              	present_and_finish:
  93              	.LVL0:
  94              	.LFB242:
 113:Core/Src/hall_detection.c **** 
 114:Core/Src/hall_detection.c **** //https://dot-to-ascii.ggerganov.com/
 115:Core/Src/hall_detection.c **** /*
 116:Core/Src/hall_detection.c ****  *
 117:Core/Src/hall_detection.c **** +-------------------------+
 118:Core/Src/hall_detection.c **** |          start          |
 119:Core/Src/hall_detection.c **** +-------------------------+
 120:Core/Src/hall_detection.c ****   |
 121:Core/Src/hall_detection.c ****   |
 122:Core/Src/hall_detection.c ****   v
 123:Core/Src/hall_detection.c **** +-------------------------+
 124:Core/Src/hall_detection.c **** |                         | <--+
 125:Core/Src/hall_detection.c **** | WAIT_CURRENT_STATIONARY |    | still not stationary
 126:Core/Src/hall_detection.c **** |                         | ---+
 127:Core/Src/hall_detection.c **** +-------------------------+
 128:Core/Src/hall_detection.c ****   |
 129:Core/Src/hall_detection.c ****   |	the openloop stabilished
 130:Core/Src/hall_detection.c ****   v
 131:Core/Src/hall_detection.c **** +-------------------------+
 132:Core/Src/hall_detection.c **** |       ADQUISITION       | <--+
 133:Core/Src/hall_detection.c **** +-------------------------+    |
 134:Core/Src/hall_detection.c ****   |                            |
 135:Core/Src/hall_detection.c ****   | zerocrossings detected     |
 136:Core/Src/hall_detection.c ****   v                            |
 137:Core/Src/hall_detection.c **** +-------------------------+    | still not 3 matching X!X!X! type results
 138:Core/Src/hall_detection.c **** |     INTERPRETATION      |    |
 139:Core/Src/hall_detection.c **** +-------------------------+    |
ARM GAS  /tmp/ccsur3Tq.s 			page 5


 140:Core/Src/hall_detection.c ****   |                            |
 141:Core/Src/hall_detection.c ****   | X!X!X! type result         |
 142:Core/Src/hall_detection.c ****   v                            |
 143:Core/Src/hall_detection.c **** +-------------------------+    |
 144:Core/Src/hall_detection.c **** |       VALIDATION        | ---+
 145:Core/Src/hall_detection.c **** +-------------------------+
 146:Core/Src/hall_detection.c ****   |
 147:Core/Src/hall_detection.c ****   |	3 matching results, we are confident now
 148:Core/Src/hall_detection.c ****   v
 149:Core/Src/hall_detection.c **** +-------------------------+
 150:Core/Src/hall_detection.c **** |   PRESENTATION_FINISH   |
 151:Core/Src/hall_detection.c **** +-------------------------+
 152:Core/Src/hall_detection.c ****   |
 153:Core/Src/hall_detection.c ****   |
 154:Core/Src/hall_detection.c ****   v
 155:Core/Src/hall_detection.c **** +-------------------------+
 156:Core/Src/hall_detection.c **** |           end           |
 157:Core/Src/hall_detection.c **** +-------------------------+
 158:Core/Src/hall_detection.c **** 
 159:Core/Src/hall_detection.c **** */
 160:Core/Src/hall_detection.c **** /**
 161:Core/Src/hall_detection.c **** * \brief public function, to be included inside a 20Khz interruption routine, it manages the state 
 162:Core/Src/hall_detection.c **** * \param hall_pin_info * H1_gpio, pointer to gpio info about the hall A
 163:Core/Src/hall_detection.c **** * \param hall_pin_info * H2_gpio, pointer to gpio info about the hall B
 164:Core/Src/hall_detection.c **** * \param hall_pin_info * H3_gpio, pointer to gpio info about the hall C
 165:Core/Src/hall_detection.c **** * \param volatile float* ADCcurr1, pointer to current value in amps for phase A
 166:Core/Src/hall_detection.c **** * \param volatile float* ADCcurr2, pointer to current value in amps for phase C? or B?
 167:Core/Src/hall_detection.c **** */
 168:Core/Src/hall_detection.c **** void Hall_Identification_Test_measurement(
 169:Core/Src/hall_detection.c **** 		hall_pin_info* H1_gpio,
 170:Core/Src/hall_detection.c **** 		hall_pin_info* H2_gpio,
 171:Core/Src/hall_detection.c **** 		hall_pin_info* H3_gpio,
 172:Core/Src/hall_detection.c **** 		volatile float* ADCcurr1,
 173:Core/Src/hall_detection.c **** 		volatile float* ADCcurr2
 174:Core/Src/hall_detection.c **** 		){
 175:Core/Src/hall_detection.c **** 	switch (detection_state) {
 176:Core/Src/hall_detection.c **** 		case detection_ENABLED:
 177:Core/Src/hall_detection.c **** 			ticks=0;
 178:Core/Src/hall_detection.c **** 			general.lowpassfilter_ticks=15;//minimum value
 179:Core/Src/hall_detection.c **** 			resetVariables_adquisition(&general);
 180:Core/Src/hall_detection.c **** 			detection_state=detection_WAIT_CURRENT_STATIONARY;
 181:Core/Src/hall_detection.c **** 			break;
 182:Core/Src/hall_detection.c **** 		case detection_WAIT_CURRENT_STATIONARY:
 183:Core/Src/hall_detection.c **** 			wait_for_the_current_stationary(&detection_state,&general,H1_gpio,H2_gpio,H3_gpio,ADCcurr1,ADCcu
 184:Core/Src/hall_detection.c **** 			ticks++;
 185:Core/Src/hall_detection.c **** 			break;
 186:Core/Src/hall_detection.c **** 		case detection_ADQUISITION:
 187:Core/Src/hall_detection.c **** 			adquisition(&detection_state,&general,H1_gpio,H2_gpio,H3_gpio,ADCcurr1,ADCcurr2);
 188:Core/Src/hall_detection.c **** 			ticks++;
 189:Core/Src/hall_detection.c **** 			break;
 190:Core/Src/hall_detection.c **** 		case detection_INTERPRETATION:
 191:Core/Src/hall_detection.c **** 			interpretation(&detection_state, &general);
 192:Core/Src/hall_detection.c **** 			ticks++;
 193:Core/Src/hall_detection.c **** 			break;
 194:Core/Src/hall_detection.c **** 		case detection_VALIDATION:
 195:Core/Src/hall_detection.c **** 			validation(&detection_state,&general);
 196:Core/Src/hall_detection.c **** 			ticks++;
ARM GAS  /tmp/ccsur3Tq.s 			page 6


 197:Core/Src/hall_detection.c **** 			break;
 198:Core/Src/hall_detection.c **** 		case detection_PRESENTATION_FINISH:
 199:Core/Src/hall_detection.c **** 			present_and_finish(&detection_state,&general);
 200:Core/Src/hall_detection.c **** 			swap_hall_gpios_with_detected_results(&general,H1_gpio, H2_gpio, H3_gpio);
 201:Core/Src/hall_detection.c **** 			ticks++;
 202:Core/Src/hall_detection.c **** 			break;
 203:Core/Src/hall_detection.c **** 		case detection_ERROR_OR_TIMEOUT:
 204:Core/Src/hall_detection.c **** 			error_handler();
 205:Core/Src/hall_detection.c **** 			detection_state=detection_DISABLED;
 206:Core/Src/hall_detection.c **** 		case detection_DISABLED://do nothing
 207:Core/Src/hall_detection.c **** 		default:
 208:Core/Src/hall_detection.c **** 			break;
 209:Core/Src/hall_detection.c **** 	}
 210:Core/Src/hall_detection.c **** }
 211:Core/Src/hall_detection.c **** 
 212:Core/Src/hall_detection.c **** /**
 213:Core/Src/hall_detection.c **** * \brief the motor running in open loop control needs a bit of time to lock in place so current sig
 214:Core/Src/hall_detection.c **** * \param detection_state_enum* state,			pointer to the variable controling the state machine
 215:Core/Src/hall_detection.c **** * \param hall_detection_general_struct *gen, 	pointer to the huge structure containing everything t
 216:Core/Src/hall_detection.c **** * \param hall_pin_info * H1_gpio, pointer to gpio info about the hall A
 217:Core/Src/hall_detection.c **** * \param hall_pin_info * H2_gpio, pointer to gpio info about the hall B
 218:Core/Src/hall_detection.c **** * \param hall_pin_info * H3_gpio, pointer to gpio info about the hall C
 219:Core/Src/hall_detection.c **** * \param volatile float* ADCcurr1, pointer to current value in amps for phase A
 220:Core/Src/hall_detection.c **** * \param volatile float* ADCcurr2, pointer to current value in amps for phase C? or B?
 221:Core/Src/hall_detection.c **** */
 222:Core/Src/hall_detection.c **** void wait_for_the_current_stationary(detection_state_enum* state,hall_detection_general_struct *gen
 223:Core/Src/hall_detection.c **** 		hall_pin_info* H1_gpio,
 224:Core/Src/hall_detection.c **** 		hall_pin_info* H2_gpio,
 225:Core/Src/hall_detection.c **** 		hall_pin_info* H3_gpio,
 226:Core/Src/hall_detection.c **** 		volatile float* ADCcurr1,
 227:Core/Src/hall_detection.c **** 		volatile float* ADCcurr2
 228:Core/Src/hall_detection.c **** 		){
 229:Core/Src/hall_detection.c **** 	//timeout or currentisstationary
 230:Core/Src/hall_detection.c **** 	fill_buffers(gen, H1_gpio, H2_gpio, H3_gpio, ADCcurr1, ADCcurr2);
 231:Core/Src/hall_detection.c **** 	//timeout
 232:Core/Src/hall_detection.c **** 	if( ticks>MAXTICKs){
 233:Core/Src/hall_detection.c **** 		*state=detection_ERROR_OR_TIMEOUT;
 234:Core/Src/hall_detection.c **** 		return;
 235:Core/Src/hall_detection.c **** 	}
 236:Core/Src/hall_detection.c **** 
 237:Core/Src/hall_detection.c ****     //endofadquisition
 238:Core/Src/hall_detection.c **** 	if(ticks>general.start_adquisition_ticks+2){//run alone signals_adquisition() to pre-fill the buff
 239:Core/Src/hall_detection.c **** 		if(detect_N_zerocrossings(gen,WAITING_STATIONARY_MAXZEROCROSSINGS)==YES){
 240:Core/Src/hall_detection.c **** 			if(are_all_periods_stable(gen,WAITING_STATIONARY_MAXZEROCROSSINGS)==YES){
 241:Core/Src/hall_detection.c **** 				gen->lowpassfilter_ticks=gen->results[gen->numberOfresults].electricPeriod_ticks*0.1;
 242:Core/Src/hall_detection.c **** 				resetVariables_adquisition(gen);
 243:Core/Src/hall_detection.c **** 				resetVariables_results(gen);
 244:Core/Src/hall_detection.c **** 				general.start_adquisition_ticks=ticks;
 245:Core/Src/hall_detection.c **** 				*state=detection_ADQUISITION;
 246:Core/Src/hall_detection.c **** 				return;
 247:Core/Src/hall_detection.c **** 			}else{
 248:Core/Src/hall_detection.c **** 				resetVariables_adquisition(gen);
 249:Core/Src/hall_detection.c **** 				general.start_adquisition_ticks=ticks;
 250:Core/Src/hall_detection.c **** 			}
 251:Core/Src/hall_detection.c **** 		}
 252:Core/Src/hall_detection.c **** 	}
 253:Core/Src/hall_detection.c **** }
ARM GAS  /tmp/ccsur3Tq.s 			page 7


 254:Core/Src/hall_detection.c **** 
 255:Core/Src/hall_detection.c **** /**
 256:Core/Src/hall_detection.c **** * \brief similar to wait_for_the_current_stationary(), but this time we mean it, we are adquiring t
 257:Core/Src/hall_detection.c **** * \param detection_state_enum* state,			pointer to the variable controling the state machine
 258:Core/Src/hall_detection.c **** * \param hall_detection_general_struct *gen, 	pointer to the huge structure containing everything t
 259:Core/Src/hall_detection.c **** * \param hall_pin_info * H1_gpio, pointer to gpio info about the hall A
 260:Core/Src/hall_detection.c **** * \param hall_pin_info * H2_gpio, pointer to gpio info about the hall B
 261:Core/Src/hall_detection.c **** * \param hall_pin_info * H3_gpio, pointer to gpio info about the hall C
 262:Core/Src/hall_detection.c **** * \param volatile float* ADCcurr1, pointer to current value in amps for phase A
 263:Core/Src/hall_detection.c **** * \param volatile float* ADCcurr2, pointer to current value in amps for phase C? or B?
 264:Core/Src/hall_detection.c **** */
 265:Core/Src/hall_detection.c **** void adquisition(
 266:Core/Src/hall_detection.c **** 		detection_state_enum* state,
 267:Core/Src/hall_detection.c **** 		hall_detection_general_struct *gen,
 268:Core/Src/hall_detection.c **** 		hall_pin_info* H1_gpio,
 269:Core/Src/hall_detection.c **** 		hall_pin_info* H2_gpio,
 270:Core/Src/hall_detection.c **** 		hall_pin_info* H3_gpio,
 271:Core/Src/hall_detection.c **** 		volatile float* ADCcurr1,
 272:Core/Src/hall_detection.c **** 		volatile float* ADCcurr2
 273:Core/Src/hall_detection.c **** 		){
 274:Core/Src/hall_detection.c **** 
 275:Core/Src/hall_detection.c **** 	fill_buffers(gen, H1_gpio, H2_gpio, H3_gpio, ADCcurr1, ADCcurr2);
 276:Core/Src/hall_detection.c **** 
 277:Core/Src/hall_detection.c **** 	//timeout
 278:Core/Src/hall_detection.c **** 	if( ticks>MAXTICKs){
 279:Core/Src/hall_detection.c **** 		*state=detection_ERROR_OR_TIMEOUT;
 280:Core/Src/hall_detection.c **** 		return;
 281:Core/Src/hall_detection.c **** 	}
 282:Core/Src/hall_detection.c **** 
 283:Core/Src/hall_detection.c **** 	if(ticks>general.start_adquisition_ticks+2){//run alone signals_adquisition() to pre-fill the buff
 284:Core/Src/hall_detection.c **** 		if(detect_N_zerocrossings(gen,MAXZEROCROSSINGS)==YES){
 285:Core/Src/hall_detection.c **** 			calculateElectricPeriod_inTicks(gen,MAXZEROCROSSINGS);
 286:Core/Src/hall_detection.c **** 			*state=detection_INTERPRETATION;
 287:Core/Src/hall_detection.c **** 		}
 288:Core/Src/hall_detection.c **** 	}
 289:Core/Src/hall_detection.c **** }
 290:Core/Src/hall_detection.c **** 
 291:Core/Src/hall_detection.c **** /**
 292:Core/Src/hall_detection.c **** * \brief once we adquired the data we are trying to make sense out of it.
 293:Core/Src/hall_detection.c **** * \param detection_state_enum* state,			pointer to the variable controling the state machine
 294:Core/Src/hall_detection.c **** * \param hall_detection_general_struct *gen, 	pointer to the huge structure containing everything t
 295:Core/Src/hall_detection.c **** */
 296:Core/Src/hall_detection.c **** void interpretation(detection_state_enum* state,hall_detection_general_struct *gen){
 297:Core/Src/hall_detection.c **** 	//timeout
 298:Core/Src/hall_detection.c **** 	if( ticks>MAXTICKs){
 299:Core/Src/hall_detection.c **** 		*state=detection_ERROR_OR_TIMEOUT;
 300:Core/Src/hall_detection.c **** 		return;
 301:Core/Src/hall_detection.c **** 	}
 302:Core/Src/hall_detection.c **** 	assign_closest_phase_to_hall(gen);
 303:Core/Src/hall_detection.c **** 	assign_polarity(gen);
 304:Core/Src/hall_detection.c **** 	gen->numberOfresults++;
 305:Core/Src/hall_detection.c **** 	gen->start_adquisition_ticks=ticks;
 306:Core/Src/hall_detection.c **** 	*state=detection_VALIDATION;
 307:Core/Src/hall_detection.c **** }
 308:Core/Src/hall_detection.c **** 
 309:Core/Src/hall_detection.c **** /**
 310:Core/Src/hall_detection.c **** * \brief once we interpreted enough data, we validate results
ARM GAS  /tmp/ccsur3Tq.s 			page 8


 311:Core/Src/hall_detection.c **** * this function has a cyclomatic complexity of 19, that should be improved
 312:Core/Src/hall_detection.c **** * \param detection_state_enum* state,			pointer to the variable controling the state machine
 313:Core/Src/hall_detection.c **** * \param hall_detection_general_struct *gen, 	pointer to the huge structure containing everything t
 314:Core/Src/hall_detection.c **** */
 315:Core/Src/hall_detection.c **** void validation(detection_state_enum* state,hall_detection_general_struct *gen){
 316:Core/Src/hall_detection.c **** 	//timeout or 	//reached results buffer full capacity
 317:Core/Src/hall_detection.c **** 	if( ticks>MAXTICKs || gen->numberOfresults>TOTAL_NUMBEROFRESULTS){
 318:Core/Src/hall_detection.c **** 		*state=detection_ERROR_OR_TIMEOUT;
 319:Core/Src/hall_detection.c **** 		return;
 320:Core/Src/hall_detection.c **** 	}
 321:Core/Src/hall_detection.c **** 
 322:Core/Src/hall_detection.c **** 	uint32_t all_phases_not_repeated=0;
 323:Core/Src/hall_detection.c **** 	for (uint32_t i = 0;  i < NUMBEROFPHASES; ++ i) {
 324:Core/Src/hall_detection.c **** 		if(gen->results[gen->numberOfresults-1].hall_order[i]==hall_A){
 325:Core/Src/hall_detection.c **** 			all_phases_not_repeated|=(1<<hall_A);
 326:Core/Src/hall_detection.c **** 		}else if(gen->results[gen->numberOfresults-1].hall_order[i]==hall_B){
 327:Core/Src/hall_detection.c **** 			all_phases_not_repeated|=(1<<hall_B);
 328:Core/Src/hall_detection.c **** 		}else if(gen->results[gen->numberOfresults-1].hall_order[i]==hall_C){
 329:Core/Src/hall_detection.c **** 			all_phases_not_repeated|=(1<<hall_C);
 330:Core/Src/hall_detection.c **** 		}
 331:Core/Src/hall_detection.c **** 	}
 332:Core/Src/hall_detection.c **** 
 333:Core/Src/hall_detection.c **** 	if(all_phases_not_repeated==((1<<hall_A)+(1<<hall_B)+(1<<hall_C))){
 334:Core/Src/hall_detection.c **** 		gen->results[gen->numberOfresults-1].is_valid=YES;
 335:Core/Src/hall_detection.c **** 	}else{
 336:Core/Src/hall_detection.c **** 		gen->results[gen->numberOfresults-1].is_valid=NO;
 337:Core/Src/hall_detection.c **** 	}
 338:Core/Src/hall_detection.c **** 
 339:Core/Src/hall_detection.c **** 	uint32_t numberofvalid=0;
 340:Core/Src/hall_detection.c **** 	for (uint32_t i = 0;  i < TOTAL_NUMBEROFRESULTS; ++ i) {
 341:Core/Src/hall_detection.c **** 		if(gen->results[i].is_valid==YES){
 342:Core/Src/hall_detection.c **** 			numberofvalid++;
 343:Core/Src/hall_detection.c **** 		}
 344:Core/Src/hall_detection.c **** 	}
 345:Core/Src/hall_detection.c **** 
 346:Core/Src/hall_detection.c **** 	if(numberofvalid>=NUMBER_OF_VALID_MATCHING_RESULTS){			//only if enough adquisitions were made
 347:Core/Src/hall_detection.c **** 		for (uint32_t i = 0; i < gen->numberOfresults; ++i) {			//loop trough results
 348:Core/Src/hall_detection.c **** 			if(gen->results[i].is_valid==YES){	//skip the not valid results.
 349:Core/Src/hall_detection.c **** 				uint32_t number_of_results_matching=0;
 350:Core/Src/hall_detection.c **** 				for (uint32_t j = 0; j < gen->numberOfresults; ++j) {	//compare that one result with the rest
 351:Core/Src/hall_detection.c **** 					if(
 352:Core/Src/hall_detection.c **** 							gen->results[i].hall_order[0]==gen->results[j].hall_order[0] &&
 353:Core/Src/hall_detection.c **** 							gen->results[i].hall_order[1]==gen->results[j].hall_order[1] &&
 354:Core/Src/hall_detection.c **** 							gen->results[i].hall_order[2]==gen->results[j].hall_order[2] &&
 355:Core/Src/hall_detection.c **** 							gen->results[i].hall_polarity[0]==gen->results[j].hall_polarity[0] &&
 356:Core/Src/hall_detection.c **** 							gen->results[i].hall_polarity[1]==gen->results[j].hall_polarity[1] &&
 357:Core/Src/hall_detection.c **** 							gen->results[i].hall_polarity[2]==gen->results[j].hall_polarity[2]
 358:Core/Src/hall_detection.c **** 							){//do they match?
 359:Core/Src/hall_detection.c **** 							number_of_results_matching++;
 360:Core/Src/hall_detection.c **** 						if(number_of_results_matching>=NUMBER_OF_VALID_MATCHING_RESULTS){
 361:Core/Src/hall_detection.c **** 							gen->indexOfcorrectResult=i;
 362:Core/Src/hall_detection.c **** 							*state=detection_PRESENTATION_FINISH;
 363:Core/Src/hall_detection.c **** 							return;
 364:Core/Src/hall_detection.c **** 						}
 365:Core/Src/hall_detection.c **** 					}
 366:Core/Src/hall_detection.c **** 				}
 367:Core/Src/hall_detection.c **** 			}
ARM GAS  /tmp/ccsur3Tq.s 			page 9


 368:Core/Src/hall_detection.c **** 
 369:Core/Src/hall_detection.c **** 		}
 370:Core/Src/hall_detection.c **** 	}
 371:Core/Src/hall_detection.c **** 
 372:Core/Src/hall_detection.c **** 	resetVariables_adquisition(gen);
 373:Core/Src/hall_detection.c **** 	resetVariables_diferences(gen);
 374:Core/Src/hall_detection.c **** 	gen->start_adquisition_ticks=ticks;
 375:Core/Src/hall_detection.c **** 	*state=detection_ADQUISITION;
 376:Core/Src/hall_detection.c **** 	return;
 377:Core/Src/hall_detection.c **** }
 378:Core/Src/hall_detection.c **** 
 379:Core/Src/hall_detection.c **** /**
 380:Core/Src/hall_detection.c **** * \brief if the resutls are validated, lets present the data, load the ASCII message for uart and/o
 381:Core/Src/hall_detection.c **** * \param detection_state_enum* state,			pointer to the variable controling the state machine
 382:Core/Src/hall_detection.c **** * \param hall_detection_general_struct *gen, 	pointer to the huge structure containing everything t
 383:Core/Src/hall_detection.c **** */
 384:Core/Src/hall_detection.c **** void present_and_finish(detection_state_enum* state,hall_detection_general_struct *gen){
  95              		.loc 1 384 88 is_stmt 1 view -0
  96              		.cfi_startproc
  97              		@ args = 0, pretend = 0, frame = 0
  98              		@ frame_needed = 0, uses_anonymous_args = 0
  99              		.loc 1 384 88 is_stmt 0 view .LVU12
 100 0000 38B5     		push	{r3, r4, r5, lr}
 101              	.LCFI0:
 102              		.cfi_def_cfa_offset 16
 103              		.cfi_offset 3, -16
 104              		.cfi_offset 4, -12
 105              		.cfi_offset 5, -8
 106              		.cfi_offset 14, -4
 107 0002 0446     		mov	r4, r0
 385:Core/Src/hall_detection.c **** 	for (uint32_t i = 0; i < messageLength; ++i) {
 108              		.loc 1 385 2 is_stmt 1 view .LVU13
 109              	.LBB2:
 110              		.loc 1 385 7 view .LVU14
 111              	.LVL1:
 112              		.loc 1 385 16 is_stmt 0 view .LVU15
 113 0004 0023     		movs	r3, #0
 114              		.loc 1 385 2 view .LVU16
 115 0006 04E0     		b	.L10
 116              	.LVL2:
 117              	.L11:
 386:Core/Src/hall_detection.c **** 		gen->message[i]=' ';
 118              		.loc 1 386 3 is_stmt 1 discriminator 3 view .LVU17
 119              		.loc 1 386 18 is_stmt 0 discriminator 3 view .LVU18
 120 0008 CA18     		adds	r2, r1, r3
 121 000a 2020     		movs	r0, #32
 122 000c 82F8C001 		strb	r0, [r2, #448]
 385:Core/Src/hall_detection.c **** 	for (uint32_t i = 0; i < messageLength; ++i) {
 123              		.loc 1 385 42 discriminator 3 view .LVU19
 124 0010 0133     		adds	r3, r3, #1
 125              	.LVL3:
 126              	.L10:
 385:Core/Src/hall_detection.c **** 	for (uint32_t i = 0; i < messageLength; ++i) {
 127              		.loc 1 385 2 discriminator 1 view .LVU20
 128 0012 072B     		cmp	r3, #7
 129 0014 F8D9     		bls	.L11
 130              	.LBE2:
ARM GAS  /tmp/ccsur3Tq.s 			page 10


 131              	.LBB3:
 387:Core/Src/hall_detection.c **** 	}
 388:Core/Src/hall_detection.c **** 
 389:Core/Src/hall_detection.c **** 	for (uint32_t i = 0; i < NUMBEROFPHASES; ++i) {
 132              		.loc 1 389 16 view .LVU21
 133 0016 0023     		movs	r3, #0
 134              	.LVL4:
 135              		.loc 1 389 16 view .LVU22
 136 0018 19E0     		b	.L12
 137              	.LVL5:
 138              	.L13:
 390:Core/Src/hall_detection.c **** 		if(gen->results[gen->indexOfcorrectResult].hall_order[i]==hall_A){
 391:Core/Src/hall_detection.c **** 			gen->message[(i*2)+1]='A';
 392:Core/Src/hall_detection.c **** 		}else if(gen->results[gen->indexOfcorrectResult].hall_order[i]==hall_B){
 139              		.loc 1 392 9 is_stmt 1 view .LVU23
 140              		.loc 1 392 62 is_stmt 0 view .LVU24
 141 001a 01EB0210 		add	r0, r1, r2, lsl #4
 142 001e 1844     		add	r0, r0, r3
 143 0020 90F86801 		ldrb	r0, [r0, #360]	@ zero_extendqisi2
 144              		.loc 1 392 11 view .LVU25
 145 0024 0128     		cmp	r0, #1
 146 0026 08D0     		beq	.L20
 393:Core/Src/hall_detection.c **** 			gen->message[(i*2)+1]='B';
 394:Core/Src/hall_detection.c **** 		}else if(gen->results[gen->indexOfcorrectResult].hall_order[i]==hall_C){
 147              		.loc 1 394 9 is_stmt 1 view .LVU26
 148              		.loc 1 394 11 is_stmt 0 view .LVU27
 149 0028 0228     		cmp	r0, #2
 150 002a 21D1     		bne	.L14
 395:Core/Src/hall_detection.c **** 			gen->message[(i*2)+1]='C';
 151              		.loc 1 395 4 is_stmt 1 view .LVU28
 152              		.loc 1 395 19 is_stmt 0 view .LVU29
 153 002c 5800     		lsls	r0, r3, #1
 154              		.loc 1 395 22 view .LVU30
 155 002e 0130     		adds	r0, r0, #1
 156              		.loc 1 395 25 view .LVU31
 157 0030 0844     		add	r0, r0, r1
 158 0032 4325     		movs	r5, #67
 159 0034 80F8C051 		strb	r5, [r0, #448]
 160 0038 1AE0     		b	.L14
 161              	.L20:
 393:Core/Src/hall_detection.c **** 			gen->message[(i*2)+1]='B';
 162              		.loc 1 393 4 is_stmt 1 view .LVU32
 393:Core/Src/hall_detection.c **** 			gen->message[(i*2)+1]='B';
 163              		.loc 1 393 19 is_stmt 0 view .LVU33
 164 003a 5800     		lsls	r0, r3, #1
 393:Core/Src/hall_detection.c **** 			gen->message[(i*2)+1]='B';
 165              		.loc 1 393 22 view .LVU34
 166 003c 0130     		adds	r0, r0, #1
 393:Core/Src/hall_detection.c **** 			gen->message[(i*2)+1]='B';
 167              		.loc 1 393 25 view .LVU35
 168 003e 0844     		add	r0, r0, r1
 169 0040 4225     		movs	r5, #66
 170 0042 80F8C051 		strb	r5, [r0, #448]
 171 0046 13E0     		b	.L14
 172              	.L16:
 396:Core/Src/hall_detection.c **** 		}
 397:Core/Src/hall_detection.c **** 
ARM GAS  /tmp/ccsur3Tq.s 			page 11


 398:Core/Src/hall_detection.c **** 		if(gen->results[gen->indexOfcorrectResult].hall_polarity[i]==hall_direct){
 399:Core/Src/hall_detection.c **** 			gen->message[i*2]=' ';
 400:Core/Src/hall_detection.c **** 		}else if(gen->results[gen->indexOfcorrectResult].hall_polarity[i]==hall_inverse){
 173              		.loc 1 400 9 is_stmt 1 view .LVU36
 174              		.loc 1 400 11 is_stmt 0 view .LVU37
 175 0048 012A     		cmp	r2, #1
 176 004a 1ED0     		beq	.L21
 177              	.L17:
 389:Core/Src/hall_detection.c **** 		if(gen->results[gen->indexOfcorrectResult].hall_order[i]==hall_A){
 178              		.loc 1 389 43 discriminator 2 view .LVU38
 179 004c 0133     		adds	r3, r3, #1
 180              	.LVL6:
 181              	.L12:
 389:Core/Src/hall_detection.c **** 		if(gen->results[gen->indexOfcorrectResult].hall_order[i]==hall_A){
 182              		.loc 1 389 2 discriminator 1 view .LVU39
 183 004e 022B     		cmp	r3, #2
 184 0050 21D8     		bhi	.L22
 390:Core/Src/hall_detection.c **** 			gen->message[(i*2)+1]='A';
 185              		.loc 1 390 3 is_stmt 1 view .LVU40
 390:Core/Src/hall_detection.c **** 			gen->message[(i*2)+1]='A';
 186              		.loc 1 390 22 is_stmt 0 view .LVU41
 187 0052 D1F85C21 		ldr	r2, [r1, #348]
 390:Core/Src/hall_detection.c **** 			gen->message[(i*2)+1]='A';
 188              		.loc 1 390 56 view .LVU42
 189 0056 01EB0210 		add	r0, r1, r2, lsl #4
 190 005a 1844     		add	r0, r0, r3
 191 005c 90F86801 		ldrb	r0, [r0, #360]	@ zero_extendqisi2
 390:Core/Src/hall_detection.c **** 			gen->message[(i*2)+1]='A';
 192              		.loc 1 390 5 view .LVU43
 193 0060 0028     		cmp	r0, #0
 194 0062 DAD1     		bne	.L13
 391:Core/Src/hall_detection.c **** 		}else if(gen->results[gen->indexOfcorrectResult].hall_order[i]==hall_B){
 195              		.loc 1 391 4 is_stmt 1 view .LVU44
 391:Core/Src/hall_detection.c **** 		}else if(gen->results[gen->indexOfcorrectResult].hall_order[i]==hall_B){
 196              		.loc 1 391 19 is_stmt 0 view .LVU45
 197 0064 5800     		lsls	r0, r3, #1
 391:Core/Src/hall_detection.c **** 		}else if(gen->results[gen->indexOfcorrectResult].hall_order[i]==hall_B){
 198              		.loc 1 391 22 view .LVU46
 199 0066 0130     		adds	r0, r0, #1
 391:Core/Src/hall_detection.c **** 		}else if(gen->results[gen->indexOfcorrectResult].hall_order[i]==hall_B){
 200              		.loc 1 391 25 view .LVU47
 201 0068 0844     		add	r0, r0, r1
 202 006a 4125     		movs	r5, #65
 203 006c 80F8C051 		strb	r5, [r0, #448]
 204              	.L14:
 398:Core/Src/hall_detection.c **** 			gen->message[i*2]=' ';
 205              		.loc 1 398 3 is_stmt 1 view .LVU48
 398:Core/Src/hall_detection.c **** 			gen->message[i*2]=' ';
 206              		.loc 1 398 59 is_stmt 0 view .LVU49
 207 0070 01EB0212 		add	r2, r1, r2, lsl #4
 208 0074 1A44     		add	r2, r2, r3
 209 0076 92F86B21 		ldrb	r2, [r2, #363]	@ zero_extendqisi2
 398:Core/Src/hall_detection.c **** 			gen->message[i*2]=' ';
 210              		.loc 1 398 5 view .LVU50
 211 007a 002A     		cmp	r2, #0
 212 007c E4D1     		bne	.L16
 399:Core/Src/hall_detection.c **** 		}else if(gen->results[gen->indexOfcorrectResult].hall_polarity[i]==hall_inverse){
ARM GAS  /tmp/ccsur3Tq.s 			page 12


 213              		.loc 1 399 4 is_stmt 1 view .LVU51
 399:Core/Src/hall_detection.c **** 		}else if(gen->results[gen->indexOfcorrectResult].hall_polarity[i]==hall_inverse){
 214              		.loc 1 399 21 is_stmt 0 view .LVU52
 215 007e 01EB4302 		add	r2, r1, r3, lsl #1
 216 0082 2020     		movs	r0, #32
 217 0084 82F8C001 		strb	r0, [r2, #448]
 218 0088 E0E7     		b	.L17
 219              	.L21:
 401:Core/Src/hall_detection.c **** 			gen->message[i*2]='!';
 220              		.loc 1 401 4 is_stmt 1 view .LVU53
 221              		.loc 1 401 21 is_stmt 0 view .LVU54
 222 008a 01EB4302 		add	r2, r1, r3, lsl #1
 223 008e 2120     		movs	r0, #33
 224 0090 82F8C001 		strb	r0, [r2, #448]
 225 0094 DAE7     		b	.L17
 226              	.L22:
 227              		.loc 1 401 21 view .LVU55
 228              	.LBE3:
 402:Core/Src/hall_detection.c **** 		}
 403:Core/Src/hall_detection.c **** 	}
 404:Core/Src/hall_detection.c **** 
 405:Core/Src/hall_detection.c **** 	gen->message[messageLength-2]='\n';//two last characters
 229              		.loc 1 405 2 is_stmt 1 view .LVU56
 230              		.loc 1 405 31 is_stmt 0 view .LVU57
 231 0096 0A23     		movs	r3, #10
 232              	.LVL7:
 233              		.loc 1 405 31 view .LVU58
 234 0098 81F8C631 		strb	r3, [r1, #454]
 406:Core/Src/hall_detection.c **** 	gen->message[messageLength-1]='\r';
 235              		.loc 1 406 2 is_stmt 1 view .LVU59
 236              		.loc 1 406 31 is_stmt 0 view .LVU60
 237 009c 0D23     		movs	r3, #13
 238 009e 81F8C731 		strb	r3, [r1, #455]
 407:Core/Src/hall_detection.c **** 
 408:Core/Src/hall_detection.c **** 
 409:Core/Src/hall_detection.c **** #ifdef TESTuart
 410:Core/Src/hall_detection.c **** 	HAL_UART_Transmit(&huart2, (const uint8_t *)&general.message, messageLength,100);
 239              		.loc 1 410 2 is_stmt 1 view .LVU61
 240 00a2 6423     		movs	r3, #100
 241 00a4 0822     		movs	r2, #8
 242 00a6 0349     		ldr	r1, .L23
 243              	.LVL8:
 244              		.loc 1 410 2 is_stmt 0 view .LVU62
 245 00a8 0348     		ldr	r0, .L23+4
 246 00aa FFF7FEFF 		bl	HAL_UART_Transmit
 247              	.LVL9:
 411:Core/Src/hall_detection.c **** #endif
 412:Core/Src/hall_detection.c **** 
 413:Core/Src/hall_detection.c **** 	*state=detection_DISABLED;
 248              		.loc 1 413 2 is_stmt 1 view .LVU63
 249              		.loc 1 413 8 is_stmt 0 view .LVU64
 250 00ae 0023     		movs	r3, #0
 251 00b0 2370     		strb	r3, [r4]
 414:Core/Src/hall_detection.c **** }
 252              		.loc 1 414 1 view .LVU65
 253 00b2 38BD     		pop	{r3, r4, r5, pc}
 254              	.LVL10:
ARM GAS  /tmp/ccsur3Tq.s 			page 13


 255              	.L24:
 256              		.loc 1 414 1 view .LVU66
 257              		.align	2
 258              	.L23:
 259 00b4 C0010000 		.word	.LANCHOR1+448
 260 00b8 00000000 		.word	huart2
 261              		.cfi_endproc
 262              	.LFE242:
 264              		.section	.text.fill_buffers,"ax",%progbits
 265              		.align	1
 266              		.global	fill_buffers
 267              		.syntax unified
 268              		.thumb
 269              		.thumb_func
 270              		.fpu fpv4-sp-d16
 272              	fill_buffers:
 273              	.LVL11:
 274              	.LFB243:
 415:Core/Src/hall_detection.c **** 
 416:Core/Src/hall_detection.c **** /**
 417:Core/Src/hall_detection.c **** * \brief these buffers need to be filled, not much to this function, manages the "circularity" of t
 418:Core/Src/hall_detection.c **** * \param hall_detection_general_struct *gen, 	pointer to the huge structure containing everything t
 419:Core/Src/hall_detection.c **** * \param hall_pin_info * H1_gpio, pointer to gpio info about the hall A
 420:Core/Src/hall_detection.c **** * \param hall_pin_info * H2_gpio, pointer to gpio info about the hall B
 421:Core/Src/hall_detection.c **** * \param hall_pin_info * H3_gpio, pointer to gpio info about the hall C
 422:Core/Src/hall_detection.c **** * \param volatile float* ADCcurr1, pointer to current value in amps for phase A
 423:Core/Src/hall_detection.c **** * \param volatile float* ADCcurr2, pointer to current value in amps for phase C? or B?
 424:Core/Src/hall_detection.c **** */
 425:Core/Src/hall_detection.c **** void fill_buffers(
 426:Core/Src/hall_detection.c **** 		hall_detection_general_struct *gen,
 427:Core/Src/hall_detection.c **** 		hall_pin_info* H1_gpio,
 428:Core/Src/hall_detection.c **** 		hall_pin_info* H2_gpio,
 429:Core/Src/hall_detection.c **** 		hall_pin_info* H3_gpio,
 430:Core/Src/hall_detection.c **** 		volatile float* ADCcurr1,
 431:Core/Src/hall_detection.c **** 		volatile float* ADCcurr2
 432:Core/Src/hall_detection.c **** 		){
 275              		.loc 1 432 4 is_stmt 1 view -0
 276              		.cfi_startproc
 277              		@ args = 8, pretend = 0, frame = 0
 278              		@ frame_needed = 0, uses_anonymous_args = 0
 279              		@ link register save eliminated.
 280              		.loc 1 432 4 is_stmt 0 view .LVU68
 281 0000 70B4     		push	{r4, r5, r6}
 282              	.LCFI1:
 283              		.cfi_def_cfa_offset 12
 284              		.cfi_offset 4, -12
 285              		.cfi_offset 5, -8
 286              		.cfi_offset 6, -4
 287 0002 039D     		ldr	r5, [sp, #12]
 288 0004 049C     		ldr	r4, [sp, #16]
 433:Core/Src/hall_detection.c **** 
 434:Core/Src/hall_detection.c **** #ifdef REAL_PHASES_A_B_calculated_C
 435:Core/Src/hall_detection.c **** 	gen->currA.two_samples_buffer[1]=gen->currA.two_samples_buffer[0];
 436:Core/Src/hall_detection.c **** 	gen->currA.two_samples_buffer[0]= *ADCcurr1; //i suspect ADC measurements are one sample late, bec
 437:Core/Src/hall_detection.c **** 
 438:Core/Src/hall_detection.c **** 	gen->currB.two_samples_buffer[1]=gen->currB.two_samples_buffer[0];
 439:Core/Src/hall_detection.c **** 	gen->currB.two_samples_buffer[0]= *ADCcurr2;
ARM GAS  /tmp/ccsur3Tq.s 			page 14


 440:Core/Src/hall_detection.c **** 	//c=-a-b, NO REAL MEASUREMENT OF CURRENT C, assuming ABC currents ortogonality:
 441:Core/Src/hall_detection.c **** 	gen->currC.two_samples_buffer[1]=gen->currC.two_samples_buffer[0];
 442:Core/Src/hall_detection.c **** 	gen->currC.two_samples_buffer[0]= currentAplusBplusC-*ADCcurr1-*ADCcurr2;
 443:Core/Src/hall_detection.c **** #endif
 444:Core/Src/hall_detection.c **** 
 445:Core/Src/hall_detection.c **** #ifdef REAL_PHASES_A_C_calculated_B
 446:Core/Src/hall_detection.c **** 	gen->currA.two_samples_buffer[1]=gen->currA.two_samples_buffer[0];
 289              		.loc 1 446 2 is_stmt 1 view .LVU69
 290              		.loc 1 446 64 is_stmt 0 view .LVU70
 291 0006 4668     		ldr	r6, [r0, #4]	@ float
 292              		.loc 1 446 34 view .LVU71
 293 0008 8660     		str	r6, [r0, #8]	@ float
 447:Core/Src/hall_detection.c **** 	gen->currA.two_samples_buffer[0]= *ADCcurr1;
 294              		.loc 1 447 2 is_stmt 1 view .LVU72
 295              		.loc 1 447 36 is_stmt 0 view .LVU73
 296 000a 2E68     		ldr	r6, [r5]	@ float
 297              		.loc 1 447 34 view .LVU74
 298 000c 4660     		str	r6, [r0, #4]	@ float
 448:Core/Src/hall_detection.c **** 	//b=-a-c, NO REAL MEASUREMENT OF CURRENT B, assuming ABC currents ortogonality:
 449:Core/Src/hall_detection.c **** 	gen->currB.two_samples_buffer[1]=gen->currB.two_samples_buffer[0];
 299              		.loc 1 449 2 is_stmt 1 view .LVU75
 300              		.loc 1 449 64 is_stmt 0 view .LVU76
 301 000e 066B     		ldr	r6, [r0, #48]	@ float
 302              		.loc 1 449 34 view .LVU77
 303 0010 4663     		str	r6, [r0, #52]	@ float
 450:Core/Src/hall_detection.c **** 	gen->currB.two_samples_buffer[0]= -*ADCcurr1-*ADCcurr2;
 304              		.loc 1 450 2 is_stmt 1 view .LVU78
 305              		.loc 1 450 37 is_stmt 0 view .LVU79
 306 0012 D5ED007A 		vldr.32	s15, [r5]
 307              		.loc 1 450 36 view .LVU80
 308 0016 F1EE677A 		vneg.f32	s15, s15
 309              		.loc 1 450 47 view .LVU81
 310 001a 94ED007A 		vldr.32	s14, [r4]
 311              		.loc 1 450 46 view .LVU82
 312 001e 77EEC77A 		vsub.f32	s15, s15, s14
 313              		.loc 1 450 34 view .LVU83
 314 0022 C0ED0C7A 		vstr.32	s15, [r0, #48]
 451:Core/Src/hall_detection.c **** 
 452:Core/Src/hall_detection.c **** 	gen->currC.two_samples_buffer[1]=gen->currC.two_samples_buffer[0];
 315              		.loc 1 452 2 is_stmt 1 view .LVU84
 316              		.loc 1 452 64 is_stmt 0 view .LVU85
 317 0026 C56D     		ldr	r5, [r0, #92]	@ float
 318              		.loc 1 452 34 view .LVU86
 319 0028 0566     		str	r5, [r0, #96]	@ float
 453:Core/Src/hall_detection.c **** 	gen->currC.two_samples_buffer[0]= *ADCcurr2;
 320              		.loc 1 453 2 is_stmt 1 view .LVU87
 321              		.loc 1 453 36 is_stmt 0 view .LVU88
 322 002a 2468     		ldr	r4, [r4]	@ float
 323              		.loc 1 453 34 view .LVU89
 324 002c C465     		str	r4, [r0, #92]	@ float
 454:Core/Src/hall_detection.c **** #endif
 455:Core/Src/hall_detection.c **** 
 456:Core/Src/hall_detection.c **** #ifdef REAL_PHASES_B_C_calculated_A
 457:Core/Src/hall_detection.c **** 	//a=-b-bc, NO REAL MEASUREMENT OF CURRENT A, assuming ABC currents ortogonality:
 458:Core/Src/hall_detection.c **** 	gen->currA.two_samples_buffer[1]=gen->currA.two_samples_buffer[0];
 459:Core/Src/hall_detection.c **** 	gen->currA.two_samples_buffer[0]= currentAplusBplusC-*ADCcurr1-*ADCcurr2;
 460:Core/Src/hall_detection.c **** 
ARM GAS  /tmp/ccsur3Tq.s 			page 15


 461:Core/Src/hall_detection.c **** 	gen->currB.two_samples_buffer[1]=gen->currB.two_samples_buffer[0];
 462:Core/Src/hall_detection.c **** 	gen->currB.two_samples_buffer[0]= *ADCcurr1;
 463:Core/Src/hall_detection.c **** 
 464:Core/Src/hall_detection.c **** 	gen->currC.two_samples_buffer[1]=gen->currC.two_samples_buffer[0];
 465:Core/Src/hall_detection.c **** 	gen->currC.two_samples_buffer[0]= *ADCcurr2;
 466:Core/Src/hall_detection.c **** #endif
 467:Core/Src/hall_detection.c **** 
 468:Core/Src/hall_detection.c **** 	gen->hallA.two_samples_buffer[1]=gen->hallA.two_samples_buffer[0];
 325              		.loc 1 468 2 is_stmt 1 view .LVU90
 326              		.loc 1 468 64 is_stmt 0 view .LVU91
 327 002e D0F88840 		ldr	r4, [r0, #136]	@ float
 328              		.loc 1 468 34 view .LVU92
 329 0032 C0F88C40 		str	r4, [r0, #140]	@ float
 469:Core/Src/hall_detection.c **** 	gen->hallA.two_samples_buffer[0]=(float) H1_gpio->state;
 330              		.loc 1 469 2 is_stmt 1 view .LVU93
 331              		.loc 1 469 50 is_stmt 0 view .LVU94
 332 0036 C979     		ldrb	r1, [r1, #7]	@ zero_extendqisi2
 333              	.LVL12:
 334              		.loc 1 469 50 view .LVU95
 335 0038 07EE901A 		vmov	s15, r1	@ int
 336              		.loc 1 469 35 view .LVU96
 337 003c F8EE677A 		vcvt.f32.u32	s15, s15
 338              		.loc 1 469 34 view .LVU97
 339 0040 C0ED227A 		vstr.32	s15, [r0, #136]
 470:Core/Src/hall_detection.c **** 
 471:Core/Src/hall_detection.c **** 	gen->hallB.two_samples_buffer[1]=gen->hallB.two_samples_buffer[0];
 340              		.loc 1 471 2 is_stmt 1 view .LVU98
 341              		.loc 1 471 64 is_stmt 0 view .LVU99
 342 0044 D0F8B410 		ldr	r1, [r0, #180]	@ float
 343              		.loc 1 471 34 view .LVU100
 344 0048 C0F8B810 		str	r1, [r0, #184]	@ float
 472:Core/Src/hall_detection.c **** 	gen->hallB.two_samples_buffer[0]=(float) H2_gpio->state;
 345              		.loc 1 472 2 is_stmt 1 view .LVU101
 346              		.loc 1 472 50 is_stmt 0 view .LVU102
 347 004c D279     		ldrb	r2, [r2, #7]	@ zero_extendqisi2
 348              	.LVL13:
 349              		.loc 1 472 50 view .LVU103
 350 004e 07EE902A 		vmov	s15, r2	@ int
 351              		.loc 1 472 35 view .LVU104
 352 0052 F8EE677A 		vcvt.f32.u32	s15, s15
 353              		.loc 1 472 34 view .LVU105
 354 0056 C0ED2D7A 		vstr.32	s15, [r0, #180]
 473:Core/Src/hall_detection.c **** 
 474:Core/Src/hall_detection.c **** 	gen->hallC.two_samples_buffer[1]=gen->hallC.two_samples_buffer[0];
 355              		.loc 1 474 2 is_stmt 1 view .LVU106
 356              		.loc 1 474 64 is_stmt 0 view .LVU107
 357 005a D0F8E020 		ldr	r2, [r0, #224]	@ float
 358              		.loc 1 474 34 view .LVU108
 359 005e C0F8E420 		str	r2, [r0, #228]	@ float
 475:Core/Src/hall_detection.c **** 	gen->hallC.two_samples_buffer[0]=(float) H3_gpio->state;
 360              		.loc 1 475 2 is_stmt 1 view .LVU109
 361              		.loc 1 475 50 is_stmt 0 view .LVU110
 362 0062 DB79     		ldrb	r3, [r3, #7]	@ zero_extendqisi2
 363              	.LVL14:
 364              		.loc 1 475 50 view .LVU111
 365 0064 07EE903A 		vmov	s15, r3	@ int
 366              		.loc 1 475 35 view .LVU112
ARM GAS  /tmp/ccsur3Tq.s 			page 16


 367 0068 F8EE677A 		vcvt.f32.u32	s15, s15
 368              		.loc 1 475 34 view .LVU113
 369 006c C0ED387A 		vstr.32	s15, [r0, #224]
 476:Core/Src/hall_detection.c **** }
 370              		.loc 1 476 1 view .LVU114
 371 0070 70BC     		pop	{r4, r5, r6}
 372              	.LCFI2:
 373              		.cfi_restore 6
 374              		.cfi_restore 5
 375              		.cfi_restore 4
 376              		.cfi_def_cfa_offset 0
 377              	.LVL15:
 378              		.loc 1 476 1 view .LVU115
 379 0072 7047     		bx	lr
 380              		.cfi_endproc
 381              	.LFE243:
 383              		.section	.text.detect_N_current_zerocrossings,"ax",%progbits
 384              		.align	1
 385              		.global	detect_N_current_zerocrossings
 386              		.syntax unified
 387              		.thumb
 388              		.thumb_func
 389              		.fpu fpv4-sp-d16
 391              	detect_N_current_zerocrossings:
 392              	.LVL16:
 393              	.LFB245:
 477:Core/Src/hall_detection.c **** 
 478:Core/Src/hall_detection.c **** /**
 479:Core/Src/hall_detection.c **** * \brief reading the buffers we just filled detects if a zero crossing happened in between them, it
 480:Core/Src/hall_detection.c **** * \param hall_detection_general_struct *gen, 	pointer to the huge structure containing everything t
 481:Core/Src/hall_detection.c **** * \return YES//done detecting or NO//still ongoing
 482:Core/Src/hall_detection.c **** */
 483:Core/Src/hall_detection.c **** detection_YES_NO detect_N_zerocrossings(hall_detection_general_struct *gen,uint32_t N){
 484:Core/Src/hall_detection.c **** 	if((ticks-general.start_adquisition_ticks)>2){ //skip the first two samples to fill the buffers
 485:Core/Src/hall_detection.c **** 		detect_N_current_zerocrossings	(gen,(ticks-general.start_adquisition_ticks),&gen->currA,MAXZEROCR
 486:Core/Src/hall_detection.c **** 		detect_N_current_zerocrossings	(gen,(ticks-general.start_adquisition_ticks),&gen->currB,MAXZEROCR
 487:Core/Src/hall_detection.c **** 		detect_N_current_zerocrossings	(gen,(ticks-general.start_adquisition_ticks),&gen->currC,MAXZEROCR
 488:Core/Src/hall_detection.c **** 		detect_N_hall_zerocrossings		((ticks-general.start_adquisition_ticks),&gen->hallA,MAXZEROCROSSING
 489:Core/Src/hall_detection.c **** 		detect_N_hall_zerocrossings		((ticks-general.start_adquisition_ticks),&gen->hallB,MAXZEROCROSSING
 490:Core/Src/hall_detection.c **** 		detect_N_hall_zerocrossings		((ticks-general.start_adquisition_ticks),&gen->hallC,MAXZEROCROSSING
 491:Core/Src/hall_detection.c **** 	}
 492:Core/Src/hall_detection.c **** 	if(//if all buffers are full
 493:Core/Src/hall_detection.c **** 			(gen->currA.numberof_zerocrossings>=N) &&
 494:Core/Src/hall_detection.c **** 			(gen->currB.numberof_zerocrossings>=N) &&
 495:Core/Src/hall_detection.c **** 			(gen->currC.numberof_zerocrossings>=N) &&
 496:Core/Src/hall_detection.c **** 			(gen->hallA.numberof_zerocrossings>=N) &&
 497:Core/Src/hall_detection.c **** 			(gen->hallB.numberof_zerocrossings>=N) &&
 498:Core/Src/hall_detection.c **** 			(gen->hallC.numberof_zerocrossings>=N)
 499:Core/Src/hall_detection.c **** 			){
 500:Core/Src/hall_detection.c **** 		return YES;//done detecting
 501:Core/Src/hall_detection.c **** 	}else{
 502:Core/Src/hall_detection.c **** 		return NO;//still ongoing
 503:Core/Src/hall_detection.c **** 	}
 504:Core/Src/hall_detection.c **** }
 505:Core/Src/hall_detection.c **** 
 506:Core/Src/hall_detection.c **** /**
 507:Core/Src/hall_detection.c **** * \brief reading the current buffers detects 0 crossings and takes notes of the tick number.
ARM GAS  /tmp/ccsur3Tq.s 			page 17


 508:Core/Src/hall_detection.c **** * \param hall_detection_general_struct *gen, 	pointer to the huge structure containing everything t
 509:Core/Src/hall_detection.c **** */
 510:Core/Src/hall_detection.c **** void detect_N_current_zerocrossings(hall_detection_general_struct *gen,uint32_t ticks,current_or_ha
 394              		.loc 1 510 141 is_stmt 1 view -0
 395              		.cfi_startproc
 396              		@ args = 0, pretend = 0, frame = 0
 397              		@ frame_needed = 0, uses_anonymous_args = 0
 398              		@ link register save eliminated.
 511:Core/Src/hall_detection.c **** 	if(	   (((currx->two_samples_buffer[0]-currentADCoffset)*
 399              		.loc 1 511 2 view .LVU117
 400              		.loc 1 511 37 is_stmt 0 view .LVU118
 401 0000 D2ED007A 		vldr.32	s15, [r2]
 512:Core/Src/hall_detection.c **** 			 (currx->two_samples_buffer[1]-currentADCoffset))<=0)
 402              		.loc 1 512 31 view .LVU119
 403 0004 92ED017A 		vldr.32	s14, [r2, #4]
 511:Core/Src/hall_detection.c **** 	if(	   (((currx->two_samples_buffer[0]-currentADCoffset)*
 404              		.loc 1 511 58 view .LVU120
 405 0008 67EE877A 		vmul.f32	s15, s15, s14
 511:Core/Src/hall_detection.c **** 	if(	   (((currx->two_samples_buffer[0]-currentADCoffset)*
 406              		.loc 1 511 4 view .LVU121
 407 000c F5EEC07A 		vcmpe.f32	s15, #0
 408 0010 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 409 0014 00D9     		bls	.L46
 410 0016 7047     		bx	lr
 411              	.L46:
 510:Core/Src/hall_detection.c **** 	if(	   (((currx->two_samples_buffer[0]-currentADCoffset)*
 412              		.loc 1 510 141 view .LVU122
 413 0018 10B4     		push	{r4}
 414              	.LCFI3:
 415              		.cfi_def_cfa_offset 4
 416              		.cfi_offset 4, -4
 513:Core/Src/hall_detection.c **** 			 && currx->numberof_zerocrossings<N
 417              		.loc 1 513 13 view .LVU123
 418 001a 946A     		ldr	r4, [r2, #40]
 419              		.loc 1 513 5 view .LVU124
 420 001c 9C42     		cmp	r4, r3
 421 001e 12D2     		bcs	.L27
 514:Core/Src/hall_detection.c **** 			){
 515:Core/Src/hall_detection.c **** 
 516:Core/Src/hall_detection.c **** 		if(currx->numberof_zerocrossings==0){			//only if this is the first zerocrossing detected
 422              		.loc 1 516 3 is_stmt 1 view .LVU125
 423              		.loc 1 516 5 is_stmt 0 view .LVU126
 424 0020 CCB9     		cbnz	r4, .L30
 517:Core/Src/hall_detection.c **** 					currx->zerocrossings_tick[currx->numberof_zerocrossings]=ticks;
 425              		.loc 1 517 6 is_stmt 1 view .LVU127
 426              		.loc 1 517 62 is_stmt 0 view .LVU128
 427 0022 A31C     		adds	r3, r4, #2
 428              	.LVL17:
 429              		.loc 1 517 62 view .LVU129
 430 0024 42F82310 		str	r1, [r2, r3, lsl #2]
 518:Core/Src/hall_detection.c **** 					if(currx->two_samples_buffer[0]>currx->two_samples_buffer[1]){
 431              		.loc 1 518 6 is_stmt 1 view .LVU130
 432              		.loc 1 518 34 is_stmt 0 view .LVU131
 433 0028 92ED007A 		vldr.32	s14, [r2]
 434              		.loc 1 518 63 view .LVU132
 435 002c D2ED017A 		vldr.32	s15, [r2, #4]
 436              		.loc 1 518 8 view .LVU133
ARM GAS  /tmp/ccsur3Tq.s 			page 18


 437 0030 B4EEE77A 		vcmpe.f32	s14, s15
 438 0034 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 439 0038 08DD     		ble	.L40
 519:Core/Src/hall_detection.c **** 						currx->zerocrossings_polarity[currx->numberof_zerocrossings]=rising_polarity;
 440              		.loc 1 519 7 is_stmt 1 view .LVU134
 441              		.loc 1 519 67 is_stmt 0 view .LVU135
 442 003a 1319     		adds	r3, r2, r4
 443 003c 0021     		movs	r1, #0
 444              	.LVL18:
 445              		.loc 1 519 67 view .LVU136
 446 003e 83F82010 		strb	r1, [r3, #32]
 447              	.LVL19:
 448              	.L33:
 520:Core/Src/hall_detection.c **** 					}else{
 521:Core/Src/hall_detection.c **** 						currx->zerocrossings_polarity[currx->numberof_zerocrossings]=falling_polarity;
 522:Core/Src/hall_detection.c **** 					}
 523:Core/Src/hall_detection.c **** 					currx->numberof_zerocrossings++;
 449              		.loc 1 523 6 is_stmt 1 view .LVU137
 450              		.loc 1 523 35 is_stmt 0 view .LVU138
 451 0042 0134     		adds	r4, r4, #1
 452 0044 9462     		str	r4, [r2, #40]
 453              	.LVL20:
 454              	.L27:
 524:Core/Src/hall_detection.c **** 		}else{
 525:Core/Src/hall_detection.c **** 			if((int32_t)(ticks-(currx->zerocrossings_tick[currx->numberof_zerocrossings-1]))>gen->lowpassfil
 526:Core/Src/hall_detection.c **** 					currx->zerocrossings_tick[currx->numberof_zerocrossings]=ticks;
 527:Core/Src/hall_detection.c **** 					if(currx->two_samples_buffer[0]>currx->two_samples_buffer[1]){
 528:Core/Src/hall_detection.c **** 						currx->zerocrossings_polarity[currx->numberof_zerocrossings]=rising_polarity;
 529:Core/Src/hall_detection.c **** 					}else{
 530:Core/Src/hall_detection.c **** 						currx->zerocrossings_polarity[currx->numberof_zerocrossings]=falling_polarity;
 531:Core/Src/hall_detection.c **** 					}
 532:Core/Src/hall_detection.c **** 					currx->numberof_zerocrossings++;
 533:Core/Src/hall_detection.c **** 			}
 534:Core/Src/hall_detection.c **** 		}
 535:Core/Src/hall_detection.c **** 	}
 536:Core/Src/hall_detection.c **** }
 455              		.loc 1 536 1 view .LVU139
 456 0046 5DF8044B 		ldr	r4, [sp], #4
 457              	.LCFI4:
 458              		.cfi_remember_state
 459              		.cfi_restore 4
 460              		.cfi_def_cfa_offset 0
 461 004a 7047     		bx	lr
 462              	.LVL21:
 463              	.L40:
 464              	.LCFI5:
 465              		.cfi_restore_state
 521:Core/Src/hall_detection.c **** 					}
 466              		.loc 1 521 7 is_stmt 1 view .LVU140
 521:Core/Src/hall_detection.c **** 					}
 467              		.loc 1 521 67 is_stmt 0 view .LVU141
 468 004c 1319     		adds	r3, r2, r4
 469 004e 0121     		movs	r1, #1
 470              	.LVL22:
 521:Core/Src/hall_detection.c **** 					}
 471              		.loc 1 521 67 view .LVU142
 472 0050 83F82010 		strb	r1, [r3, #32]
ARM GAS  /tmp/ccsur3Tq.s 			page 19


 473              	.LVL23:
 521:Core/Src/hall_detection.c **** 					}
 474              		.loc 1 521 67 view .LVU143
 475 0054 F5E7     		b	.L33
 476              	.LVL24:
 477              	.L30:
 525:Core/Src/hall_detection.c **** 					currx->zerocrossings_tick[currx->numberof_zerocrossings]=ticks;
 478              		.loc 1 525 4 is_stmt 1 view .LVU144
 525:Core/Src/hall_detection.c **** 					currx->zerocrossings_tick[currx->numberof_zerocrossings]=ticks;
 479              		.loc 1 525 49 is_stmt 0 view .LVU145
 480 0056 631C     		adds	r3, r4, #1
 481              	.LVL25:
 525:Core/Src/hall_detection.c **** 					currx->zerocrossings_tick[currx->numberof_zerocrossings]=ticks;
 482              		.loc 1 525 49 view .LVU146
 483 0058 52F82330 		ldr	r3, [r2, r3, lsl #2]
 525:Core/Src/hall_detection.c **** 					currx->zerocrossings_tick[currx->numberof_zerocrossings]=ticks;
 484              		.loc 1 525 22 view .LVU147
 485 005c CB1A     		subs	r3, r1, r3
 525:Core/Src/hall_detection.c **** 					currx->zerocrossings_tick[currx->numberof_zerocrossings]=ticks;
 486              		.loc 1 525 88 view .LVU148
 487 005e D0F85401 		ldr	r0, [r0, #340]
 488              	.LVL26:
 525:Core/Src/hall_detection.c **** 					currx->zerocrossings_tick[currx->numberof_zerocrossings]=ticks;
 489              		.loc 1 525 6 view .LVU149
 490 0062 8342     		cmp	r3, r0
 491 0064 EFD9     		bls	.L27
 526:Core/Src/hall_detection.c **** 					if(currx->two_samples_buffer[0]>currx->two_samples_buffer[1]){
 492              		.loc 1 526 6 is_stmt 1 view .LVU150
 526:Core/Src/hall_detection.c **** 					if(currx->two_samples_buffer[0]>currx->two_samples_buffer[1]){
 493              		.loc 1 526 62 is_stmt 0 view .LVU151
 494 0066 A31C     		adds	r3, r4, #2
 495 0068 42F82310 		str	r1, [r2, r3, lsl #2]
 527:Core/Src/hall_detection.c **** 						currx->zerocrossings_polarity[currx->numberof_zerocrossings]=rising_polarity;
 496              		.loc 1 527 6 is_stmt 1 view .LVU152
 527:Core/Src/hall_detection.c **** 						currx->zerocrossings_polarity[currx->numberof_zerocrossings]=rising_polarity;
 497              		.loc 1 527 34 is_stmt 0 view .LVU153
 498 006c 92ED007A 		vldr.32	s14, [r2]
 527:Core/Src/hall_detection.c **** 						currx->zerocrossings_polarity[currx->numberof_zerocrossings]=rising_polarity;
 499              		.loc 1 527 63 view .LVU154
 500 0070 D2ED017A 		vldr.32	s15, [r2, #4]
 527:Core/Src/hall_detection.c **** 						currx->zerocrossings_polarity[currx->numberof_zerocrossings]=rising_polarity;
 501              		.loc 1 527 8 view .LVU155
 502 0074 B4EEE77A 		vcmpe.f32	s14, s15
 503 0078 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 504 007c 06DD     		ble	.L41
 528:Core/Src/hall_detection.c **** 					}else{
 505              		.loc 1 528 7 is_stmt 1 view .LVU156
 528:Core/Src/hall_detection.c **** 					}else{
 506              		.loc 1 528 67 is_stmt 0 view .LVU157
 507 007e 1319     		adds	r3, r2, r4
 508 0080 0021     		movs	r1, #0
 509              	.LVL27:
 528:Core/Src/hall_detection.c **** 					}else{
 510              		.loc 1 528 67 view .LVU158
 511 0082 83F82010 		strb	r1, [r3, #32]
 512              	.LVL28:
 513              	.L36:
ARM GAS  /tmp/ccsur3Tq.s 			page 20


 532:Core/Src/hall_detection.c **** 			}
 514              		.loc 1 532 6 is_stmt 1 view .LVU159
 532:Core/Src/hall_detection.c **** 			}
 515              		.loc 1 532 35 is_stmt 0 view .LVU160
 516 0086 0134     		adds	r4, r4, #1
 517 0088 9462     		str	r4, [r2, #40]
 518              		.loc 1 536 1 view .LVU161
 519 008a DCE7     		b	.L27
 520              	.LVL29:
 521              	.L41:
 530:Core/Src/hall_detection.c **** 					}
 522              		.loc 1 530 7 is_stmt 1 view .LVU162
 530:Core/Src/hall_detection.c **** 					}
 523              		.loc 1 530 67 is_stmt 0 view .LVU163
 524 008c 1319     		adds	r3, r2, r4
 525 008e 0121     		movs	r1, #1
 526              	.LVL30:
 530:Core/Src/hall_detection.c **** 					}
 527              		.loc 1 530 67 view .LVU164
 528 0090 83F82010 		strb	r1, [r3, #32]
 529              	.LVL31:
 530:Core/Src/hall_detection.c **** 					}
 530              		.loc 1 530 67 view .LVU165
 531 0094 F7E7     		b	.L36
 532              		.cfi_endproc
 533              	.LFE245:
 535              		.section	.text.detect_N_hall_zerocrossings,"ax",%progbits
 536              		.align	1
 537              		.global	detect_N_hall_zerocrossings
 538              		.syntax unified
 539              		.thumb
 540              		.thumb_func
 541              		.fpu fpv4-sp-d16
 543              	detect_N_hall_zerocrossings:
 544              	.LVL32:
 545              	.LFB246:
 537:Core/Src/hall_detection.c **** 
 538:Core/Src/hall_detection.c **** /**
 539:Core/Src/hall_detection.c **** * \brief similar to detect_N_current_zerocrossings() reading the hall buffers detects logic changes
 540:Core/Src/hall_detection.c **** * \param hall_detection_general_struct *gen, 	pointer to the huge structure containing everything t
 541:Core/Src/hall_detection.c **** */
 542:Core/Src/hall_detection.c **** void detect_N_hall_zerocrossings(uint32_t ticks,current_or_hall_measurements_struct* hallx,uint32_t
 546              		.loc 1 542 103 is_stmt 1 view -0
 547              		.cfi_startproc
 548              		@ args = 0, pretend = 0, frame = 0
 549              		@ frame_needed = 0, uses_anonymous_args = 0
 550              		@ link register save eliminated.
 543:Core/Src/hall_detection.c **** 	if(
 551              		.loc 1 543 2 view .LVU167
 544:Core/Src/hall_detection.c **** 		hallx->two_samples_buffer[0]!=hallx->two_samples_buffer[1]
 552              		.loc 1 544 28 is_stmt 0 view .LVU168
 553 0000 91ED007A 		vldr.32	s14, [r1]
 554              		.loc 1 544 58 view .LVU169
 555 0004 D1ED017A 		vldr.32	s15, [r1, #4]
 543:Core/Src/hall_detection.c **** 	if(
 556              		.loc 1 543 4 view .LVU170
 557 0008 B4EE677A 		vcmp.f32	s14, s15
ARM GAS  /tmp/ccsur3Tq.s 			page 21


 558 000c F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 559 0010 12D0     		beq	.L47
 545:Core/Src/hall_detection.c **** 		&& hallx->numberof_zerocrossings<N)
 560              		.loc 1 545 11 view .LVU171
 561 0012 8B6A     		ldr	r3, [r1, #40]
 562              		.loc 1 545 3 view .LVU172
 563 0014 9342     		cmp	r3, r2
 564 0016 0FD2     		bcs	.L47
 546:Core/Src/hall_detection.c **** 	{
 547:Core/Src/hall_detection.c **** 			hallx->zerocrossings_tick[hallx->numberof_zerocrossings]=ticks;
 565              		.loc 1 547 4 is_stmt 1 view .LVU173
 566              		.loc 1 547 60 is_stmt 0 view .LVU174
 567 0018 9A1C     		adds	r2, r3, #2
 568              	.LVL33:
 569              		.loc 1 547 60 view .LVU175
 570 001a 41F82200 		str	r0, [r1, r2, lsl #2]
 548:Core/Src/hall_detection.c **** 			if(hallx->two_samples_buffer[0]!=0){
 571              		.loc 1 548 4 is_stmt 1 view .LVU176
 572              		.loc 1 548 32 is_stmt 0 view .LVU177
 573 001e D1ED007A 		vldr.32	s15, [r1]
 574              		.loc 1 548 6 view .LVU178
 575 0022 F5EE407A 		vcmp.f32	s15, #0
 576 0026 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 577 002a 06D0     		beq	.L49
 549:Core/Src/hall_detection.c **** 				hallx->zerocrossings_polarity[hallx->numberof_zerocrossings]=rising_polarity;
 578              		.loc 1 549 5 is_stmt 1 view .LVU179
 579              		.loc 1 549 65 is_stmt 0 view .LVU180
 580 002c CA18     		adds	r2, r1, r3
 581 002e 0020     		movs	r0, #0
 582              	.LVL34:
 583              		.loc 1 549 65 view .LVU181
 584 0030 82F82000 		strb	r0, [r2, #32]
 585              	.LVL35:
 586              	.L50:
 550:Core/Src/hall_detection.c **** 			}else{
 551:Core/Src/hall_detection.c **** 				hallx->zerocrossings_polarity[hallx->numberof_zerocrossings]=falling_polarity;
 552:Core/Src/hall_detection.c **** 			}
 553:Core/Src/hall_detection.c **** 			hallx->numberof_zerocrossings++;
 587              		.loc 1 553 4 is_stmt 1 view .LVU182
 588              		.loc 1 553 33 is_stmt 0 view .LVU183
 589 0034 0133     		adds	r3, r3, #1
 590 0036 8B62     		str	r3, [r1, #40]
 591              	.L47:
 554:Core/Src/hall_detection.c **** 	}
 555:Core/Src/hall_detection.c **** }
 592              		.loc 1 555 1 view .LVU184
 593 0038 7047     		bx	lr
 594              	.LVL36:
 595              	.L49:
 551:Core/Src/hall_detection.c **** 			}
 596              		.loc 1 551 5 is_stmt 1 view .LVU185
 551:Core/Src/hall_detection.c **** 			}
 597              		.loc 1 551 65 is_stmt 0 view .LVU186
 598 003a CA18     		adds	r2, r1, r3
 599 003c 0120     		movs	r0, #1
 600              	.LVL37:
 551:Core/Src/hall_detection.c **** 			}
ARM GAS  /tmp/ccsur3Tq.s 			page 22


 601              		.loc 1 551 65 view .LVU187
 602 003e 82F82000 		strb	r0, [r2, #32]
 603              	.LVL38:
 551:Core/Src/hall_detection.c **** 			}
 604              		.loc 1 551 65 view .LVU188
 605 0042 F7E7     		b	.L50
 606              		.cfi_endproc
 607              	.LFE246:
 609              		.section	.text.detect_N_zerocrossings,"ax",%progbits
 610              		.align	1
 611              		.global	detect_N_zerocrossings
 612              		.syntax unified
 613              		.thumb
 614              		.thumb_func
 615              		.fpu fpv4-sp-d16
 617              	detect_N_zerocrossings:
 618              	.LVL39:
 619              	.LFB244:
 483:Core/Src/hall_detection.c **** 	if((ticks-general.start_adquisition_ticks)>2){ //skip the first two samples to fill the buffers
 620              		.loc 1 483 87 is_stmt 1 view -0
 621              		.cfi_startproc
 622              		@ args = 0, pretend = 0, frame = 0
 623              		@ frame_needed = 0, uses_anonymous_args = 0
 483:Core/Src/hall_detection.c **** 	if((ticks-general.start_adquisition_ticks)>2){ //skip the first two samples to fill the buffers
 624              		.loc 1 483 87 is_stmt 0 view .LVU190
 625 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 626              	.LCFI6:
 627              		.cfi_def_cfa_offset 24
 628              		.cfi_offset 3, -24
 629              		.cfi_offset 4, -20
 630              		.cfi_offset 5, -16
 631              		.cfi_offset 6, -12
 632              		.cfi_offset 7, -8
 633              		.cfi_offset 14, -4
 634 0002 0446     		mov	r4, r0
 635 0004 0D46     		mov	r5, r1
 484:Core/Src/hall_detection.c **** 		detect_N_current_zerocrossings	(gen,(ticks-general.start_adquisition_ticks),&gen->currA,MAXZEROCR
 636              		.loc 1 484 2 is_stmt 1 view .LVU191
 484:Core/Src/hall_detection.c **** 		detect_N_current_zerocrossings	(gen,(ticks-general.start_adquisition_ticks),&gen->currA,MAXZEROCR
 637              		.loc 1 484 19 is_stmt 0 view .LVU192
 638 0006 2E4B     		ldr	r3, .L62
 639 0008 1B68     		ldr	r3, [r3]
 484:Core/Src/hall_detection.c **** 		detect_N_current_zerocrossings	(gen,(ticks-general.start_adquisition_ticks),&gen->currA,MAXZEROCR
 640              		.loc 1 484 11 view .LVU193
 641 000a 2E4A     		ldr	r2, .L62+4
 642 000c 1168     		ldr	r1, [r2]
 643              	.LVL40:
 484:Core/Src/hall_detection.c **** 		detect_N_current_zerocrossings	(gen,(ticks-general.start_adquisition_ticks),&gen->currA,MAXZEROCR
 644              		.loc 1 484 11 view .LVU194
 645 000e C91A     		subs	r1, r1, r3
 484:Core/Src/hall_detection.c **** 		detect_N_current_zerocrossings	(gen,(ticks-general.start_adquisition_ticks),&gen->currA,MAXZEROCR
 646              		.loc 1 484 4 view .LVU195
 647 0010 0229     		cmp	r1, #2
 648 0012 17D8     		bhi	.L61
 649              	.LVL41:
 650              	.L52:
 492:Core/Src/hall_detection.c **** 			(gen->currA.numberof_zerocrossings>=N) &&
ARM GAS  /tmp/ccsur3Tq.s 			page 23


 651              		.loc 1 492 2 is_stmt 1 view .LVU196
 493:Core/Src/hall_detection.c **** 			(gen->currB.numberof_zerocrossings>=N) &&
 652              		.loc 1 493 15 is_stmt 0 view .LVU197
 653 0014 E36A     		ldr	r3, [r4, #44]
 492:Core/Src/hall_detection.c **** 			(gen->currA.numberof_zerocrossings>=N) &&
 654              		.loc 1 492 4 view .LVU198
 655 0016 AB42     		cmp	r3, r5
 656 0018 45D3     		bcc	.L54
 494:Core/Src/hall_detection.c **** 			(gen->currC.numberof_zerocrossings>=N) &&
 657              		.loc 1 494 15 view .LVU199
 658 001a A36D     		ldr	r3, [r4, #88]
 493:Core/Src/hall_detection.c **** 			(gen->currB.numberof_zerocrossings>=N) &&
 659              		.loc 1 493 43 view .LVU200
 660 001c AB42     		cmp	r3, r5
 661 001e 44D3     		bcc	.L55
 495:Core/Src/hall_detection.c **** 			(gen->hallA.numberof_zerocrossings>=N) &&
 662              		.loc 1 495 15 view .LVU201
 663 0020 D4F88430 		ldr	r3, [r4, #132]
 494:Core/Src/hall_detection.c **** 			(gen->currC.numberof_zerocrossings>=N) &&
 664              		.loc 1 494 43 view .LVU202
 665 0024 AB42     		cmp	r3, r5
 666 0026 42D3     		bcc	.L56
 496:Core/Src/hall_detection.c **** 			(gen->hallB.numberof_zerocrossings>=N) &&
 667              		.loc 1 496 15 view .LVU203
 668 0028 D4F8B030 		ldr	r3, [r4, #176]
 495:Core/Src/hall_detection.c **** 			(gen->hallA.numberof_zerocrossings>=N) &&
 669              		.loc 1 495 43 view .LVU204
 670 002c AB42     		cmp	r3, r5
 671 002e 40D3     		bcc	.L57
 497:Core/Src/hall_detection.c **** 			(gen->hallC.numberof_zerocrossings>=N)
 672              		.loc 1 497 15 view .LVU205
 673 0030 D4F8DC30 		ldr	r3, [r4, #220]
 496:Core/Src/hall_detection.c **** 			(gen->hallB.numberof_zerocrossings>=N) &&
 674              		.loc 1 496 43 view .LVU206
 675 0034 AB42     		cmp	r3, r5
 676 0036 3ED3     		bcc	.L58
 498:Core/Src/hall_detection.c **** 			){
 677              		.loc 1 498 15 view .LVU207
 678 0038 D4F80831 		ldr	r3, [r4, #264]
 497:Core/Src/hall_detection.c **** 			(gen->hallC.numberof_zerocrossings>=N)
 679              		.loc 1 497 43 view .LVU208
 680 003c AB42     		cmp	r3, r5
 681 003e 3CD2     		bcs	.L59
 502:Core/Src/hall_detection.c **** 	}
 682              		.loc 1 502 10 view .LVU209
 683 0040 0020     		movs	r0, #0
 684 0042 31E0     		b	.L53
 685              	.LVL42:
 686              	.L61:
 485:Core/Src/hall_detection.c **** 		detect_N_current_zerocrossings	(gen,(ticks-general.start_adquisition_ticks),&gen->currB,MAXZEROCR
 687              		.loc 1 485 3 is_stmt 1 view .LVU210
 688 0044 0623     		movs	r3, #6
 689 0046 021D     		adds	r2, r0, #4
 690 0048 FFF7FEFF 		bl	detect_N_current_zerocrossings
 691              	.LVL43:
 486:Core/Src/hall_detection.c **** 		detect_N_current_zerocrossings	(gen,(ticks-general.start_adquisition_ticks),&gen->currC,MAXZEROCR
 692              		.loc 1 486 3 view .LVU211
ARM GAS  /tmp/ccsur3Tq.s 			page 24


 486:Core/Src/hall_detection.c **** 		detect_N_current_zerocrossings	(gen,(ticks-general.start_adquisition_ticks),&gen->currC,MAXZEROCR
 693              		.loc 1 486 53 is_stmt 0 view .LVU212
 694 004c 1C4F     		ldr	r7, .L62
 695 004e 3968     		ldr	r1, [r7]
 486:Core/Src/hall_detection.c **** 		detect_N_current_zerocrossings	(gen,(ticks-general.start_adquisition_ticks),&gen->currC,MAXZEROCR
 696              		.loc 1 486 3 view .LVU213
 697 0050 1C4E     		ldr	r6, .L62+4
 698 0052 3068     		ldr	r0, [r6]
 699 0054 0623     		movs	r3, #6
 700 0056 04F13002 		add	r2, r4, #48
 701 005a 411A     		subs	r1, r0, r1
 702 005c 2046     		mov	r0, r4
 703 005e FFF7FEFF 		bl	detect_N_current_zerocrossings
 704              	.LVL44:
 487:Core/Src/hall_detection.c **** 		detect_N_hall_zerocrossings		((ticks-general.start_adquisition_ticks),&gen->hallA,MAXZEROCROSSING
 705              		.loc 1 487 3 is_stmt 1 view .LVU214
 487:Core/Src/hall_detection.c **** 		detect_N_hall_zerocrossings		((ticks-general.start_adquisition_ticks),&gen->hallA,MAXZEROCROSSING
 706              		.loc 1 487 53 is_stmt 0 view .LVU215
 707 0062 3968     		ldr	r1, [r7]
 487:Core/Src/hall_detection.c **** 		detect_N_hall_zerocrossings		((ticks-general.start_adquisition_ticks),&gen->hallA,MAXZEROCROSSING
 708              		.loc 1 487 3 view .LVU216
 709 0064 3068     		ldr	r0, [r6]
 710 0066 0623     		movs	r3, #6
 711 0068 04F15C02 		add	r2, r4, #92
 712 006c 411A     		subs	r1, r0, r1
 713 006e 2046     		mov	r0, r4
 714 0070 FFF7FEFF 		bl	detect_N_current_zerocrossings
 715              	.LVL45:
 488:Core/Src/hall_detection.c **** 		detect_N_hall_zerocrossings		((ticks-general.start_adquisition_ticks),&gen->hallB,MAXZEROCROSSING
 716              		.loc 1 488 3 is_stmt 1 view .LVU217
 488:Core/Src/hall_detection.c **** 		detect_N_hall_zerocrossings		((ticks-general.start_adquisition_ticks),&gen->hallB,MAXZEROCROSSING
 717              		.loc 1 488 47 is_stmt 0 view .LVU218
 718 0074 3B68     		ldr	r3, [r7]
 488:Core/Src/hall_detection.c **** 		detect_N_hall_zerocrossings		((ticks-general.start_adquisition_ticks),&gen->hallB,MAXZEROCROSSING
 719              		.loc 1 488 3 view .LVU219
 720 0076 3068     		ldr	r0, [r6]
 721 0078 0622     		movs	r2, #6
 722 007a 04F18801 		add	r1, r4, #136
 723 007e C01A     		subs	r0, r0, r3
 724 0080 FFF7FEFF 		bl	detect_N_hall_zerocrossings
 725              	.LVL46:
 489:Core/Src/hall_detection.c **** 		detect_N_hall_zerocrossings		((ticks-general.start_adquisition_ticks),&gen->hallC,MAXZEROCROSSING
 726              		.loc 1 489 3 is_stmt 1 view .LVU220
 489:Core/Src/hall_detection.c **** 		detect_N_hall_zerocrossings		((ticks-general.start_adquisition_ticks),&gen->hallC,MAXZEROCROSSING
 727              		.loc 1 489 47 is_stmt 0 view .LVU221
 728 0084 3B68     		ldr	r3, [r7]
 489:Core/Src/hall_detection.c **** 		detect_N_hall_zerocrossings		((ticks-general.start_adquisition_ticks),&gen->hallC,MAXZEROCROSSING
 729              		.loc 1 489 3 view .LVU222
 730 0086 3068     		ldr	r0, [r6]
 731 0088 0622     		movs	r2, #6
 732 008a 04F1B401 		add	r1, r4, #180
 733 008e C01A     		subs	r0, r0, r3
 734 0090 FFF7FEFF 		bl	detect_N_hall_zerocrossings
 735              	.LVL47:
 490:Core/Src/hall_detection.c **** 	}
 736              		.loc 1 490 3 is_stmt 1 view .LVU223
 490:Core/Src/hall_detection.c **** 	}
ARM GAS  /tmp/ccsur3Tq.s 			page 25


 737              		.loc 1 490 47 is_stmt 0 view .LVU224
 738 0094 3B68     		ldr	r3, [r7]
 490:Core/Src/hall_detection.c **** 	}
 739              		.loc 1 490 3 view .LVU225
 740 0096 3068     		ldr	r0, [r6]
 741 0098 0622     		movs	r2, #6
 742 009a 04F1E001 		add	r1, r4, #224
 743 009e C01A     		subs	r0, r0, r3
 744 00a0 FFF7FEFF 		bl	detect_N_hall_zerocrossings
 745              	.LVL48:
 746 00a4 B6E7     		b	.L52
 747              	.L54:
 502:Core/Src/hall_detection.c **** 	}
 748              		.loc 1 502 10 view .LVU226
 749 00a6 0020     		movs	r0, #0
 750              	.L53:
 504:Core/Src/hall_detection.c **** 
 751              		.loc 1 504 1 view .LVU227
 752 00a8 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 753              	.LVL49:
 754              	.L55:
 502:Core/Src/hall_detection.c **** 	}
 755              		.loc 1 502 10 view .LVU228
 756 00aa 0020     		movs	r0, #0
 757 00ac FCE7     		b	.L53
 758              	.L56:
 759 00ae 0020     		movs	r0, #0
 760 00b0 FAE7     		b	.L53
 761              	.L57:
 762 00b2 0020     		movs	r0, #0
 763 00b4 F8E7     		b	.L53
 764              	.L58:
 765 00b6 0020     		movs	r0, #0
 766 00b8 F6E7     		b	.L53
 767              	.L59:
 500:Core/Src/hall_detection.c **** 	}else{
 768              		.loc 1 500 10 view .LVU229
 769 00ba 0120     		movs	r0, #1
 770 00bc F4E7     		b	.L53
 771              	.L63:
 772 00be 00BF     		.align	2
 773              	.L62:
 774 00c0 00000000 		.word	.LANCHOR1
 775 00c4 00000000 		.word	ticks
 776              		.cfi_endproc
 777              	.LFE244:
 779              		.section	.text.calculateElectricPeriod_inTicks,"ax",%progbits
 780              		.align	1
 781              		.global	calculateElectricPeriod_inTicks
 782              		.syntax unified
 783              		.thumb
 784              		.thumb_func
 785              		.fpu fpv4-sp-d16
 787              	calculateElectricPeriod_inTicks:
 788              	.LVL50:
 789              	.LFB247:
 556:Core/Src/hall_detection.c **** 
ARM GAS  /tmp/ccsur3Tq.s 			page 26


 557:Core/Src/hall_detection.c **** /**
 558:Core/Src/hall_detection.c **** * \brief reading differences between noted ticks zerocrossigns averages our motor electric period
 559:Core/Src/hall_detection.c **** * \param hall_detection_general_struct *gen, 	pointer to the huge structure containing everything t
 560:Core/Src/hall_detection.c **** * \param samples number of zerocrossings to be used in the diff calculation
 561:Core/Src/hall_detection.c **** */
 562:Core/Src/hall_detection.c **** void calculateElectricPeriod_inTicks(hall_detection_general_struct *gen, uint32_t samples){
 790              		.loc 1 562 91 is_stmt 1 view -0
 791              		.cfi_startproc
 792              		@ args = 0, pretend = 0, frame = 0
 793              		@ frame_needed = 0, uses_anonymous_args = 0
 794              		@ link register save eliminated.
 795              		.loc 1 562 91 is_stmt 0 view .LVU231
 796 0000 30B4     		push	{r4, r5}
 797              	.LCFI7:
 798              		.cfi_def_cfa_offset 8
 799              		.cfi_offset 4, -8
 800              		.cfi_offset 5, -4
 563:Core/Src/hall_detection.c **** 	uint32_t averagedsemiPeriod=0;
 801              		.loc 1 563 2 is_stmt 1 view .LVU232
 802              	.LVL51:
 564:Core/Src/hall_detection.c **** 	for (uint32_t i = 0; i < samples-1; ++i) {
 803              		.loc 1 564 2 view .LVU233
 804              	.LBB4:
 805              		.loc 1 564 7 view .LVU234
 806              		.loc 1 564 16 is_stmt 0 view .LVU235
 807 0002 0023     		movs	r3, #0
 808              	.LBE4:
 563:Core/Src/hall_detection.c **** 	uint32_t averagedsemiPeriod=0;
 809              		.loc 1 563 11 view .LVU236
 810 0004 1A46     		mov	r2, r3
 811              	.LVL52:
 812              	.L65:
 813              	.LBB5:
 814              		.loc 1 564 34 discriminator 1 view .LVU237
 815 0006 4C1E     		subs	r4, r1, #1
 816              		.loc 1 564 2 discriminator 1 view .LVU238
 817 0008 9C42     		cmp	r4, r3
 818 000a 35D9     		bls	.L68
 565:Core/Src/hall_detection.c **** 		averagedsemiPeriod+=(gen->currA.zerocrossings_tick[i+1]-gen->currA.zerocrossings_tick[i]);
 819              		.loc 1 565 3 is_stmt 1 discriminator 3 view .LVU239
 820              		.loc 1 565 53 is_stmt 0 discriminator 3 view .LVU240
 821 000c DC1C     		adds	r4, r3, #3
 822 000e 00EB8404 		add	r4, r0, r4, lsl #2
 823 0012 6468     		ldr	r4, [r4, #4]
 824              		.loc 1 565 88 discriminator 3 view .LVU241
 825 0014 9D1C     		adds	r5, r3, #2
 826 0016 00EB8505 		add	r5, r0, r5, lsl #2
 827 001a 6D68     		ldr	r5, [r5, #4]
 828              		.loc 1 565 58 discriminator 3 view .LVU242
 829 001c 641B     		subs	r4, r4, r5
 830              		.loc 1 565 21 discriminator 3 view .LVU243
 831 001e 2244     		add	r2, r2, r4
 832              	.LVL53:
 566:Core/Src/hall_detection.c **** 		averagedsemiPeriod+=(gen->currB.zerocrossings_tick[i+1]-gen->currB.zerocrossings_tick[i]);
 833              		.loc 1 566 3 is_stmt 1 discriminator 3 view .LVU244
 834              		.loc 1 566 53 is_stmt 0 discriminator 3 view .LVU245
 835 0020 03F10F04 		add	r4, r3, #15
ARM GAS  /tmp/ccsur3Tq.s 			page 27


 836 0024 50F82440 		ldr	r4, [r0, r4, lsl #2]
 837              		.loc 1 566 88 discriminator 3 view .LVU246
 838 0028 03F10E05 		add	r5, r3, #14
 839 002c 50F82550 		ldr	r5, [r0, r5, lsl #2]
 840              		.loc 1 566 58 discriminator 3 view .LVU247
 841 0030 641B     		subs	r4, r4, r5
 842              		.loc 1 566 21 discriminator 3 view .LVU248
 843 0032 2244     		add	r2, r2, r4
 844              	.LVL54:
 567:Core/Src/hall_detection.c **** 		averagedsemiPeriod+=(gen->hallA.zerocrossings_tick[i+1]-gen->hallA.zerocrossings_tick[i]);
 845              		.loc 1 567 3 is_stmt 1 discriminator 3 view .LVU249
 846              		.loc 1 567 53 is_stmt 0 discriminator 3 view .LVU250
 847 0034 03F12504 		add	r4, r3, #37
 848 0038 50F82440 		ldr	r4, [r0, r4, lsl #2]
 849              		.loc 1 567 88 discriminator 3 view .LVU251
 850 003c 03F12405 		add	r5, r3, #36
 851 0040 50F82550 		ldr	r5, [r0, r5, lsl #2]
 852              		.loc 1 567 58 discriminator 3 view .LVU252
 853 0044 641B     		subs	r4, r4, r5
 854              		.loc 1 567 21 discriminator 3 view .LVU253
 855 0046 1444     		add	r4, r4, r2
 856              	.LVL55:
 568:Core/Src/hall_detection.c **** 		averagedsemiPeriod+=(gen->hallB.zerocrossings_tick[i+1]-gen->hallB.zerocrossings_tick[i]);
 857              		.loc 1 568 3 is_stmt 1 discriminator 3 view .LVU254
 858              		.loc 1 568 53 is_stmt 0 discriminator 3 view .LVU255
 859 0048 03F12F02 		add	r2, r3, #47
 860 004c 00EB8202 		add	r2, r0, r2, lsl #2
 861 0050 5268     		ldr	r2, [r2, #4]
 862              		.loc 1 568 88 discriminator 3 view .LVU256
 863 0052 03F12E05 		add	r5, r3, #46
 864 0056 00EB8505 		add	r5, r0, r5, lsl #2
 865 005a 6D68     		ldr	r5, [r5, #4]
 866              		.loc 1 568 58 discriminator 3 view .LVU257
 867 005c 521B     		subs	r2, r2, r5
 868              		.loc 1 568 21 discriminator 3 view .LVU258
 869 005e 1444     		add	r4, r4, r2
 870              	.LVL56:
 569:Core/Src/hall_detection.c **** 		averagedsemiPeriod+=(gen->hallC.zerocrossings_tick[i+1]-gen->hallC.zerocrossings_tick[i]);
 871              		.loc 1 569 3 is_stmt 1 discriminator 3 view .LVU259
 872              		.loc 1 569 53 is_stmt 0 discriminator 3 view .LVU260
 873 0060 03F13B02 		add	r2, r3, #59
 874 0064 50F82220 		ldr	r2, [r0, r2, lsl #2]
 875              		.loc 1 569 88 discriminator 3 view .LVU261
 876 0068 03F13A05 		add	r5, r3, #58
 877 006c 50F82550 		ldr	r5, [r0, r5, lsl #2]
 878              		.loc 1 569 58 discriminator 3 view .LVU262
 879 0070 521B     		subs	r2, r2, r5
 880              		.loc 1 569 21 discriminator 3 view .LVU263
 881 0072 2244     		add	r2, r2, r4
 882              	.LVL57:
 564:Core/Src/hall_detection.c **** 		averagedsemiPeriod+=(gen->currA.zerocrossings_tick[i+1]-gen->currA.zerocrossings_tick[i]);
 883              		.loc 1 564 38 discriminator 3 view .LVU264
 884 0074 0133     		adds	r3, r3, #1
 885              	.LVL58:
 564:Core/Src/hall_detection.c **** 		averagedsemiPeriod+=(gen->currA.zerocrossings_tick[i+1]-gen->currA.zerocrossings_tick[i]);
 886              		.loc 1 564 38 discriminator 3 view .LVU265
 887 0076 C6E7     		b	.L65
ARM GAS  /tmp/ccsur3Tq.s 			page 28


 888              	.L68:
 564:Core/Src/hall_detection.c **** 		averagedsemiPeriod+=(gen->currA.zerocrossings_tick[i+1]-gen->currA.zerocrossings_tick[i]);
 889              		.loc 1 564 38 discriminator 3 view .LVU266
 890              	.LBE5:
 570:Core/Src/hall_detection.c **** 	}
 571:Core/Src/hall_detection.c **** 
 572:Core/Src/hall_detection.c **** 	averagedsemiPeriod/=(samples-1);
 891              		.loc 1 572 2 is_stmt 1 view .LVU267
 892              		.loc 1 572 20 is_stmt 0 view .LVU268
 893 0078 B2FBF4F3 		udiv	r3, r2, r4
 894              	.LVL59:
 573:Core/Src/hall_detection.c **** 	averagedsemiPeriod/=5;
 895              		.loc 1 573 2 is_stmt 1 view .LVU269
 896              		.loc 1 573 20 is_stmt 0 view .LVU270
 897 007c 064A     		ldr	r2, .L69
 898 007e A2FB0323 		umull	r2, r3, r2, r3
 899              	.LVL60:
 900              		.loc 1 573 20 view .LVU271
 901 0082 9B08     		lsrs	r3, r3, #2
 902              	.LVL61:
 574:Core/Src/hall_detection.c **** 	gen->results[gen->numberOfresults].electricPeriod_ticks=averagedsemiPeriod*2; //FOR torrot emulate
 903              		.loc 1 574 2 is_stmt 1 view .LVU272
 904              		.loc 1 574 18 is_stmt 0 view .LVU273
 905 0084 D0F85821 		ldr	r2, [r0, #344]
 906              		.loc 1 574 76 view .LVU274
 907 0088 5B00     		lsls	r3, r3, #1
 908              	.LVL62:
 909              		.loc 1 574 57 view .LVU275
 910 008a 1632     		adds	r2, r2, #22
 911 008c 00EB0210 		add	r0, r0, r2, lsl #4
 912              	.LVL63:
 913              		.loc 1 574 57 view .LVU276
 914 0090 4360     		str	r3, [r0, #4]
 575:Core/Src/hall_detection.c **** }
 915              		.loc 1 575 1 view .LVU277
 916 0092 30BC     		pop	{r4, r5}
 917              	.LCFI8:
 918              		.cfi_restore 5
 919              		.cfi_restore 4
 920              		.cfi_def_cfa_offset 0
 921 0094 7047     		bx	lr
 922              	.L70:
 923 0096 00BF     		.align	2
 924              	.L69:
 925 0098 CDCCCCCC 		.word	-858993459
 926              		.cfi_endproc
 927              	.LFE247:
 929              		.section	.text.adquisition,"ax",%progbits
 930              		.align	1
 931              		.global	adquisition
 932              		.syntax unified
 933              		.thumb
 934              		.thumb_func
 935              		.fpu fpv4-sp-d16
 937              	adquisition:
 938              	.LVL64:
 939              	.LFB239:
ARM GAS  /tmp/ccsur3Tq.s 			page 29


 273:Core/Src/hall_detection.c **** 
 940              		.loc 1 273 4 is_stmt 1 view -0
 941              		.cfi_startproc
 942              		@ args = 12, pretend = 0, frame = 0
 943              		@ frame_needed = 0, uses_anonymous_args = 0
 273:Core/Src/hall_detection.c **** 
 944              		.loc 1 273 4 is_stmt 0 view .LVU279
 945 0000 30B5     		push	{r4, r5, lr}
 946              	.LCFI9:
 947              		.cfi_def_cfa_offset 12
 948              		.cfi_offset 4, -12
 949              		.cfi_offset 5, -8
 950              		.cfi_offset 14, -4
 951 0002 83B0     		sub	sp, sp, #12
 952              	.LCFI10:
 953              		.cfi_def_cfa_offset 24
 954 0004 0546     		mov	r5, r0
 955 0006 0C46     		mov	r4, r1
 956 0008 1146     		mov	r1, r2
 957              	.LVL65:
 273:Core/Src/hall_detection.c **** 
 958              		.loc 1 273 4 view .LVU280
 959 000a 1A46     		mov	r2, r3
 960              	.LVL66:
 275:Core/Src/hall_detection.c **** 
 961              		.loc 1 275 2 is_stmt 1 view .LVU281
 962 000c 089B     		ldr	r3, [sp, #32]
 963              	.LVL67:
 275:Core/Src/hall_detection.c **** 
 964              		.loc 1 275 2 is_stmt 0 view .LVU282
 965 000e 0193     		str	r3, [sp, #4]
 966 0010 079B     		ldr	r3, [sp, #28]
 967 0012 0093     		str	r3, [sp]
 968 0014 069B     		ldr	r3, [sp, #24]
 969 0016 2046     		mov	r0, r4
 970              	.LVL68:
 275:Core/Src/hall_detection.c **** 
 971              		.loc 1 275 2 view .LVU283
 972 0018 FFF7FEFF 		bl	fill_buffers
 973              	.LVL69:
 278:Core/Src/hall_detection.c **** 		*state=detection_ERROR_OR_TIMEOUT;
 974              		.loc 1 278 2 is_stmt 1 view .LVU284
 278:Core/Src/hall_detection.c **** 		*state=detection_ERROR_OR_TIMEOUT;
 975              		.loc 1 278 11 is_stmt 0 view .LVU285
 976 001c 0D4B     		ldr	r3, .L77
 977 001e 1B68     		ldr	r3, [r3]
 278:Core/Src/hall_detection.c **** 		*state=detection_ERROR_OR_TIMEOUT;
 978              		.loc 1 278 4 view .LVU286
 979 0020 0D4A     		ldr	r2, .L77+4
 980 0022 9342     		cmp	r3, r2
 981 0024 06D8     		bhi	.L75
 283:Core/Src/hall_detection.c **** 		if(detect_N_zerocrossings(gen,MAXZEROCROSSINGS)==YES){
 982              		.loc 1 283 2 is_stmt 1 view .LVU287
 283:Core/Src/hall_detection.c **** 		if(detect_N_zerocrossings(gen,MAXZEROCROSSINGS)==YES){
 983              		.loc 1 283 18 is_stmt 0 view .LVU288
 984 0026 0D4A     		ldr	r2, .L77+8
 985 0028 1268     		ldr	r2, [r2]
ARM GAS  /tmp/ccsur3Tq.s 			page 30


 283:Core/Src/hall_detection.c **** 		if(detect_N_zerocrossings(gen,MAXZEROCROSSINGS)==YES){
 986              		.loc 1 283 42 view .LVU289
 987 002a 0232     		adds	r2, r2, #2
 283:Core/Src/hall_detection.c **** 		if(detect_N_zerocrossings(gen,MAXZEROCROSSINGS)==YES){
 988              		.loc 1 283 4 view .LVU290
 989 002c 9342     		cmp	r3, r2
 990 002e 04D8     		bhi	.L76
 991              	.L71:
 289:Core/Src/hall_detection.c **** 
 992              		.loc 1 289 1 view .LVU291
 993 0030 03B0     		add	sp, sp, #12
 994              	.LCFI11:
 995              		.cfi_remember_state
 996              		.cfi_def_cfa_offset 12
 997              		@ sp needed
 998 0032 30BD     		pop	{r4, r5, pc}
 999              	.LVL70:
 1000              	.L75:
 1001              	.LCFI12:
 1002              		.cfi_restore_state
 279:Core/Src/hall_detection.c **** 		return;
 1003              		.loc 1 279 3 is_stmt 1 view .LVU292
 279:Core/Src/hall_detection.c **** 		return;
 1004              		.loc 1 279 9 is_stmt 0 view .LVU293
 1005 0034 0723     		movs	r3, #7
 1006 0036 2B70     		strb	r3, [r5]
 280:Core/Src/hall_detection.c **** 	}
 1007              		.loc 1 280 3 is_stmt 1 view .LVU294
 1008 0038 FAE7     		b	.L71
 1009              	.L76:
 284:Core/Src/hall_detection.c **** 			calculateElectricPeriod_inTicks(gen,MAXZEROCROSSINGS);
 1010              		.loc 1 284 3 view .LVU295
 284:Core/Src/hall_detection.c **** 			calculateElectricPeriod_inTicks(gen,MAXZEROCROSSINGS);
 1011              		.loc 1 284 6 is_stmt 0 view .LVU296
 1012 003a 0621     		movs	r1, #6
 1013 003c 2046     		mov	r0, r4
 1014 003e FFF7FEFF 		bl	detect_N_zerocrossings
 1015              	.LVL71:
 284:Core/Src/hall_detection.c **** 			calculateElectricPeriod_inTicks(gen,MAXZEROCROSSINGS);
 1016              		.loc 1 284 5 view .LVU297
 1017 0042 0128     		cmp	r0, #1
 1018 0044 F4D1     		bne	.L71
 285:Core/Src/hall_detection.c **** 			*state=detection_INTERPRETATION;
 1019              		.loc 1 285 4 is_stmt 1 view .LVU298
 1020 0046 0621     		movs	r1, #6
 1021 0048 2046     		mov	r0, r4
 1022 004a FFF7FEFF 		bl	calculateElectricPeriod_inTicks
 1023              	.LVL72:
 286:Core/Src/hall_detection.c **** 		}
 1024              		.loc 1 286 4 view .LVU299
 286:Core/Src/hall_detection.c **** 		}
 1025              		.loc 1 286 10 is_stmt 0 view .LVU300
 1026 004e 0423     		movs	r3, #4
 1027 0050 2B70     		strb	r3, [r5]
 1028 0052 EDE7     		b	.L71
 1029              	.L78:
 1030              		.align	2
ARM GAS  /tmp/ccsur3Tq.s 			page 31


 1031              	.L77:
 1032 0054 00000000 		.word	ticks
 1033 0058 38900D00 		.word	888888
 1034 005c 00000000 		.word	.LANCHOR1
 1035              		.cfi_endproc
 1036              	.LFE239:
 1038              		.global	__aeabi_ui2d
 1039              		.global	__aeabi_dmul
 1040              		.global	__aeabi_d2f
 1041              		.section	.text.is_deviation_from_period_acceptable,"ax",%progbits
 1042              		.align	1
 1043              		.global	is_deviation_from_period_acceptable
 1044              		.syntax unified
 1045              		.thumb
 1046              		.thumb_func
 1047              		.fpu fpv4-sp-d16
 1049              	is_deviation_from_period_acceptable:
 1050              	.LVL73:
 1051              	.LFB248:
 576:Core/Src/hall_detection.c **** 
 577:Core/Src/hall_detection.c **** /**
 578:Core/Src/hall_detection.c **** * \brief just checks if all zerocrossings fall between acceptable deviation from average period.
 579:Core/Src/hall_detection.c **** * \param hall_detection_general_struct *gen, 	pointer to the huge structure containing everything t
 580:Core/Src/hall_detection.c **** * \param float tolerance_factor, 0.1 would mean +-10%tolerance of deviation from average
 581:Core/Src/hall_detection.c **** * \param samples number of zerocrossings to be used in the diff calculation
 582:Core/Src/hall_detection.c **** * \return YES if all deviations are accceptable, or NO if they are not
 583:Core/Src/hall_detection.c **** */
 584:Core/Src/hall_detection.c **** detection_YES_NO is_deviation_from_period_acceptable(hall_detection_general_struct *gen, float tole
 1052              		.loc 1 584 130 is_stmt 1 view -0
 1053              		.cfi_startproc
 1054              		@ args = 0, pretend = 0, frame = 0
 1055              		@ frame_needed = 0, uses_anonymous_args = 0
 1056              		.loc 1 584 130 is_stmt 0 view .LVU302
 1057 0000 70B5     		push	{r4, r5, r6, lr}
 1058              	.LCFI13:
 1059              		.cfi_def_cfa_offset 16
 1060              		.cfi_offset 4, -16
 1061              		.cfi_offset 5, -12
 1062              		.cfi_offset 6, -8
 1063              		.cfi_offset 14, -4
 1064 0002 2DED028B 		vpush.64	{d8}
 1065              	.LCFI14:
 1066              		.cfi_def_cfa_offset 24
 1067              		.cfi_offset 80, -24
 1068              		.cfi_offset 81, -20
 1069 0006 0446     		mov	r4, r0
 1070 0008 B0EE408A 		vmov.f32	s16, s0
 1071 000c 0D46     		mov	r5, r1
 585:Core/Src/hall_detection.c **** 	float _semiperiod=gen->results[gen->numberOfresults].electricPeriod_ticks/2.0;
 1072              		.loc 1 585 2 is_stmt 1 view .LVU303
 1073              		.loc 1 585 36 is_stmt 0 view .LVU304
 1074 000e D0F85831 		ldr	r3, [r0, #344]
 1075              		.loc 1 585 54 view .LVU305
 1076 0012 1633     		adds	r3, r3, #22
 1077 0014 00EB0313 		add	r3, r0, r3, lsl #4
 1078              		.loc 1 585 75 view .LVU306
 1079 0018 5868     		ldr	r0, [r3, #4]
ARM GAS  /tmp/ccsur3Tq.s 			page 32


 1080              	.LVL74:
 1081              		.loc 1 585 75 view .LVU307
 1082 001a FFF7FEFF 		bl	__aeabi_ui2d
 1083              	.LVL75:
 1084              		.loc 1 585 75 view .LVU308
 1085 001e 0022     		movs	r2, #0
 1086 0020 174B     		ldr	r3, .L87
 1087 0022 FFF7FEFF 		bl	__aeabi_dmul
 1088              	.LVL76:
 1089              		.loc 1 585 8 view .LVU309
 1090 0026 FFF7FEFF 		bl	__aeabi_d2f
 1091              	.LVL77:
 1092 002a 07EE900A 		vmov	s15, r0
 1093              	.LVL78:
 586:Core/Src/hall_detection.c **** 	uint32_t _deviation_top=	_semiperiod +_semiperiod*tolerance_factor;
 1094              		.loc 1 586 2 is_stmt 1 view .LVU310
 1095              		.loc 1 586 51 is_stmt 0 view .LVU311
 1096 002e 27EE880A 		vmul.f32	s0, s15, s16
 1097              		.loc 1 586 39 view .LVU312
 1098 0032 30EE277A 		vadd.f32	s14, s0, s15
 1099              		.loc 1 586 11 view .LVU313
 1100 0036 BCEEC77A 		vcvt.u32.f32	s14, s14
 1101 003a 17EE106A 		vmov	r6, s14	@ int
 1102              	.LVL79:
 587:Core/Src/hall_detection.c **** 	uint32_t _deviation_bottom=	_semiperiod	-_semiperiod*tolerance_factor;
 1103              		.loc 1 587 2 is_stmt 1 view .LVU314
 1104              		.loc 1 587 42 is_stmt 0 view .LVU315
 1105 003e 77EEC07A 		vsub.f32	s15, s15, s0
 1106              		.loc 1 587 11 view .LVU316
 1107 0042 FCEEE77A 		vcvt.u32.f32	s15, s15
 1108 0046 17EE900A 		vmov	r0, s15	@ int
 1109              	.LVL80:
 588:Core/Src/hall_detection.c **** 
 589:Core/Src/hall_detection.c **** 	for (uint32_t i = samples/2; i < samples-1; ++i) {
 1110              		.loc 1 589 2 is_stmt 1 view .LVU317
 1111              	.LBB6:
 1112              		.loc 1 589 7 view .LVU318
 1113              		.loc 1 589 16 is_stmt 0 view .LVU319
 1114 004a 6B08     		lsrs	r3, r5, #1
 1115              	.LVL81:
 1116              	.L80:
 1117              		.loc 1 589 42 discriminator 1 view .LVU320
 1118 004c 6A1E     		subs	r2, r5, #1
 1119              		.loc 1 589 2 discriminator 1 view .LVU321
 1120 004e 9A42     		cmp	r2, r3
 1121 0050 10D9     		bls	.L86
 1122              	.LBB7:
 590:Core/Src/hall_detection.c **** 		uint32_t _sampled_period=(gen->currA.zerocrossings_tick[i+1]-gen->currA.zerocrossings_tick[i]);
 1123              		.loc 1 590 3 is_stmt 1 view .LVU322
 1124              		.loc 1 590 60 is_stmt 0 view .LVU323
 1125 0052 591C     		adds	r1, r3, #1
 1126              		.loc 1 590 58 view .LVU324
 1127 0054 DA1C     		adds	r2, r3, #3
 1128 0056 04EB8202 		add	r2, r4, r2, lsl #2
 1129 005a 5268     		ldr	r2, [r2, #4]
 1130              		.loc 1 590 93 view .LVU325
 1131 005c 0233     		adds	r3, r3, #2
ARM GAS  /tmp/ccsur3Tq.s 			page 33


 1132              	.LVL82:
 1133              		.loc 1 590 93 view .LVU326
 1134 005e 04EB8303 		add	r3, r4, r3, lsl #2
 1135              	.LVL83:
 1136              		.loc 1 590 93 view .LVU327
 1137 0062 5B68     		ldr	r3, [r3, #4]
 1138              		.loc 1 590 12 view .LVU328
 1139 0064 D21A     		subs	r2, r2, r3
 1140              	.LVL84:
 591:Core/Src/hall_detection.c **** 		if((_sampled_period<(_deviation_bottom))||(_sampled_period>(_deviation_top))){
 1141              		.loc 1 591 3 is_stmt 1 view .LVU329
 1142              		.loc 1 591 5 is_stmt 0 view .LVU330
 1143 0066 9042     		cmp	r0, r2
 1144 0068 08D8     		bhi	.L83
 1145              	.LBE7:
 589:Core/Src/hall_detection.c **** 		uint32_t _sampled_period=(gen->currA.zerocrossings_tick[i+1]-gen->currA.zerocrossings_tick[i]);
 1146              		.loc 1 589 46 discriminator 1 view .LVU331
 1147 006a 0B46     		mov	r3, r1
 1148              	.LBB8:
 1149              		.loc 1 591 43 discriminator 1 view .LVU332
 1150 006c 9642     		cmp	r6, r2
 1151 006e EDD2     		bcs	.L80
 592:Core/Src/hall_detection.c **** 			return NO;//early return, bad news
 1152              		.loc 1 592 11 view .LVU333
 1153 0070 0020     		movs	r0, #0
 1154              	.LVL85:
 1155              		.loc 1 592 11 view .LVU334
 1156 0072 00E0     		b	.L81
 1157              	.LVL86:
 1158              	.L86:
 1159              		.loc 1 592 11 view .LVU335
 1160              	.LBE8:
 1161              	.LBE6:
 593:Core/Src/hall_detection.c **** 		}
 594:Core/Src/hall_detection.c **** 	}
 595:Core/Src/hall_detection.c **** 	return YES;//acceptable
 1162              		.loc 1 595 9 view .LVU336
 1163 0074 0120     		movs	r0, #1
 1164              	.LVL87:
 1165              	.L81:
 596:Core/Src/hall_detection.c **** }
 1166              		.loc 1 596 1 view .LVU337
 1167 0076 BDEC028B 		vldm	sp!, {d8}
 1168              	.LCFI15:
 1169              		.cfi_remember_state
 1170              		.cfi_restore 80
 1171              		.cfi_restore 81
 1172              		.cfi_def_cfa_offset 16
 1173              	.LVL88:
 1174              		.loc 1 596 1 view .LVU338
 1175 007a 70BD     		pop	{r4, r5, r6, pc}
 1176              	.LVL89:
 1177              	.L83:
 1178              	.LCFI16:
 1179              		.cfi_restore_state
 1180              	.LBB10:
 1181              	.LBB9:
ARM GAS  /tmp/ccsur3Tq.s 			page 34


 592:Core/Src/hall_detection.c **** 			return NO;//early return, bad news
 1182              		.loc 1 592 11 view .LVU339
 1183 007c 0020     		movs	r0, #0
 1184              	.LVL90:
 592:Core/Src/hall_detection.c **** 			return NO;//early return, bad news
 1185              		.loc 1 592 11 view .LVU340
 1186 007e FAE7     		b	.L81
 1187              	.L88:
 1188              		.align	2
 1189              	.L87:
 1190 0080 0000E03F 		.word	1071644672
 1191              	.LBE9:
 1192              	.LBE10:
 1193              		.cfi_endproc
 1194              	.LFE248:
 1196              		.section	.text.are_all_periods_stable,"ax",%progbits
 1197              		.align	1
 1198              		.global	are_all_periods_stable
 1199              		.syntax unified
 1200              		.thumb
 1201              		.thumb_func
 1202              		.fpu fpv4-sp-d16
 1204              	are_all_periods_stable:
 1205              	.LVL91:
 1206              	.LFB249:
 597:Core/Src/hall_detection.c **** 
 598:Core/Src/hall_detection.c **** 
 599:Core/Src/hall_detection.c **** /**
 600:Core/Src/hall_detection.c **** * \brief a wrapper to tidy up and make sure we calculate the electric period before calculating dev
 601:Core/Src/hall_detection.c **** * \param hall_detection_general_struct *gen, 	pointer to the huge structure containing everything t
 602:Core/Src/hall_detection.c **** * \param samples number of zerocrossings to be used in the diff calculation
 603:Core/Src/hall_detection.c **** * \return YES if we are in the stable zone of steady periods. NO otherwise
 604:Core/Src/hall_detection.c **** */
 605:Core/Src/hall_detection.c **** detection_YES_NO are_all_periods_stable(hall_detection_general_struct *gen, uint32_t samples){
 1207              		.loc 1 605 94 is_stmt 1 view -0
 1208              		.cfi_startproc
 1209              		@ args = 0, pretend = 0, frame = 0
 1210              		@ frame_needed = 0, uses_anonymous_args = 0
 1211              		.loc 1 605 94 is_stmt 0 view .LVU342
 1212 0000 38B5     		push	{r3, r4, r5, lr}
 1213              	.LCFI17:
 1214              		.cfi_def_cfa_offset 16
 1215              		.cfi_offset 3, -16
 1216              		.cfi_offset 4, -12
 1217              		.cfi_offset 5, -8
 1218              		.cfi_offset 14, -4
 1219 0002 0446     		mov	r4, r0
 1220 0004 0D46     		mov	r5, r1
 606:Core/Src/hall_detection.c **** 			calculateElectricPeriod_inTicks(gen,samples);
 1221              		.loc 1 606 4 is_stmt 1 view .LVU343
 1222 0006 FFF7FEFF 		bl	calculateElectricPeriod_inTicks
 1223              	.LVL92:
 607:Core/Src/hall_detection.c **** 	return 	is_deviation_from_period_acceptable(gen,TOLERANCE_FACTOR_FOR_STATIONARY_CURRENTS,samples);
 1224              		.loc 1 607 2 view .LVU344
 1225              		.loc 1 607 10 is_stmt 0 view .LVU345
 1226 000a 2946     		mov	r1, r5
 1227 000c B5EE000A 		vmov.f32	s0, #2.5e-1
ARM GAS  /tmp/ccsur3Tq.s 			page 35


 1228 0010 2046     		mov	r0, r4
 1229 0012 FFF7FEFF 		bl	is_deviation_from_period_acceptable
 1230              	.LVL93:
 608:Core/Src/hall_detection.c **** }
 1231              		.loc 1 608 1 view .LVU346
 1232 0016 38BD     		pop	{r3, r4, r5, pc}
 1233              		.loc 1 608 1 view .LVU347
 1234              		.cfi_endproc
 1235              	.LFE249:
 1237              		.section	.text.swap_hall_gpios_with_detected_results,"ax",%progbits
 1238              		.align	1
 1239              		.global	swap_hall_gpios_with_detected_results
 1240              		.syntax unified
 1241              		.thumb
 1242              		.thumb_func
 1243              		.fpu fpv4-sp-d16
 1245              	swap_hall_gpios_with_detected_results:
 1246              	.LVL94:
 1247              	.LFB250:
 609:Core/Src/hall_detection.c **** 
 610:Core/Src/hall_detection.c **** 
 611:Core/Src/hall_detection.c **** /**
 612:Core/Src/hall_detection.c **** * \brief
 613:Core/Src/hall_detection.c **** * \param
 614:Core/Src/hall_detection.c **** */
 615:Core/Src/hall_detection.c **** void swap_hall_gpios_with_detected_results(
 616:Core/Src/hall_detection.c **** 		hall_detection_general_struct *gen,
 617:Core/Src/hall_detection.c **** 		hall_pin_info* pin_infoH1,
 618:Core/Src/hall_detection.c **** 		hall_pin_info* pin_infoH2,
 619:Core/Src/hall_detection.c **** 		hall_pin_info* pin_infoH3
 620:Core/Src/hall_detection.c **** 		){
 1248              		.loc 1 620 4 is_stmt 1 view -0
 1249              		.cfi_startproc
 1250              		@ args = 0, pretend = 0, frame = 24
 1251              		@ frame_needed = 0, uses_anonymous_args = 0
 1252              		@ link register save eliminated.
 1253              		.loc 1 620 4 is_stmt 0 view .LVU349
 1254 0000 70B4     		push	{r4, r5, r6}
 1255              	.LCFI18:
 1256              		.cfi_def_cfa_offset 12
 1257              		.cfi_offset 4, -12
 1258              		.cfi_offset 5, -8
 1259              		.cfi_offset 6, -4
 1260 0002 87B0     		sub	sp, sp, #28
 1261              	.LCFI19:
 1262              		.cfi_def_cfa_offset 40
 1263 0004 0446     		mov	r4, r0
 1264 0006 0D46     		mov	r5, r1
 621:Core/Src/hall_detection.c **** 	hall_pin_info old_pin_infoH1=*pin_infoH1;
 1265              		.loc 1 621 2 is_stmt 1 view .LVU350
 1266              		.loc 1 621 16 is_stmt 0 view .LVU351
 1267 0008 D1E90001 		ldrd	r0, r1, [r1]
 1268              	.LVL95:
 1269              		.loc 1 621 16 view .LVU352
 1270 000c 06AE     		add	r6, sp, #24
 1271 000e 06E90300 		stmdb	r6, {r0, r1}
 622:Core/Src/hall_detection.c **** 	hall_pin_info old_pin_infoH2=*pin_infoH2;
ARM GAS  /tmp/ccsur3Tq.s 			page 36


 1272              		.loc 1 622 2 is_stmt 1 view .LVU353
 1273              		.loc 1 622 16 is_stmt 0 view .LVU354
 1274 0012 02AE     		add	r6, sp, #8
 1275 0014 92E80300 		ldm	r2, {r0, r1}
 1276 0018 86E80300 		stm	r6, {r0, r1}
 623:Core/Src/hall_detection.c **** 	hall_pin_info old_pin_infoH3=*pin_infoH3;
 1277              		.loc 1 623 2 is_stmt 1 view .LVU355
 1278              		.loc 1 623 16 is_stmt 0 view .LVU356
 1279 001c 6E46     		mov	r6, sp
 1280 001e 93E80300 		ldm	r3, {r0, r1}
 1281 0022 86E80300 		stm	r6, {r0, r1}
 624:Core/Src/hall_detection.c **** 
 625:Core/Src/hall_detection.c **** 	switch (gen->results[gen->indexOfcorrectResult].hall_order[phase_A]) {
 1282              		.loc 1 625 2 is_stmt 1 view .LVU357
 1283              		.loc 1 625 26 is_stmt 0 view .LVU358
 1284 0026 D4F85C11 		ldr	r1, [r4, #348]
 1285              		.loc 1 625 60 view .LVU359
 1286 002a 04EB0111 		add	r1, r4, r1, lsl #4
 1287 002e 91F86811 		ldrb	r1, [r1, #360]	@ zero_extendqisi2
 1288              		.loc 1 625 2 view .LVU360
 1289 0032 0129     		cmp	r1, #1
 1290 0034 2DD0     		beq	.L92
 1291 0036 48B2     		sxtb	r0, r1
 1292 0038 F0B1     		cbz	r0, .L93
 1293 003a 0229     		cmp	r1, #2
 1294 003c 36D0     		beq	.L94
 1295              	.L95:
 626:Core/Src/hall_detection.c **** 		case hall_A:
 627:Core/Src/hall_detection.c **** 			*pin_infoH1=old_pin_infoH1;															//swap gpio pointers
 628:Core/Src/hall_detection.c **** 			pin_infoH1->polarity= gen->results[gen->indexOfcorrectResult].hall_polarity[hall_A];//dont forge
 629:Core/Src/hall_detection.c **** 			break;
 630:Core/Src/hall_detection.c **** 		case hall_B:
 631:Core/Src/hall_detection.c **** 			*pin_infoH2=old_pin_infoH1;
 632:Core/Src/hall_detection.c **** 			pin_infoH2->polarity=gen->results[gen->indexOfcorrectResult].hall_polarity[hall_B];
 633:Core/Src/hall_detection.c **** 			break;
 634:Core/Src/hall_detection.c **** 		case hall_C:
 635:Core/Src/hall_detection.c **** 			*pin_infoH3=old_pin_infoH1;
 636:Core/Src/hall_detection.c **** 			pin_infoH3->polarity=gen->results[gen->indexOfcorrectResult].hall_polarity[hall_C];
 637:Core/Src/hall_detection.c **** 			break;
 638:Core/Src/hall_detection.c **** 		default:
 639:Core/Src/hall_detection.c **** 			break;
 640:Core/Src/hall_detection.c **** 	}
 641:Core/Src/hall_detection.c **** 
 642:Core/Src/hall_detection.c **** 	switch (gen->results[gen->indexOfcorrectResult].hall_order[phase_B]) {
 1296              		.loc 1 642 2 is_stmt 1 view .LVU361
 1297              		.loc 1 642 26 is_stmt 0 view .LVU362
 1298 003e D4F85C11 		ldr	r1, [r4, #348]
 1299              		.loc 1 642 60 view .LVU363
 1300 0042 04EB0111 		add	r1, r4, r1, lsl #4
 1301 0046 91F86911 		ldrb	r1, [r1, #361]	@ zero_extendqisi2
 1302              		.loc 1 642 2 view .LVU364
 1303 004a 0129     		cmp	r1, #1
 1304 004c 47D0     		beq	.L96
 1305 004e 48B2     		sxtb	r0, r1
 1306 0050 0028     		cmp	r0, #0
 1307 0052 38D0     		beq	.L97
 1308 0054 0229     		cmp	r1, #2
ARM GAS  /tmp/ccsur3Tq.s 			page 37


 1309 0056 4ED0     		beq	.L98
 1310              	.L99:
 643:Core/Src/hall_detection.c **** 		case hall_A:
 644:Core/Src/hall_detection.c **** 			*pin_infoH1=old_pin_infoH2;
 645:Core/Src/hall_detection.c **** 			pin_infoH1->polarity=gen->results[gen->indexOfcorrectResult].hall_polarity[hall_A];
 646:Core/Src/hall_detection.c **** 			break;
 647:Core/Src/hall_detection.c **** 		case hall_B:
 648:Core/Src/hall_detection.c **** 			*pin_infoH2=old_pin_infoH2;
 649:Core/Src/hall_detection.c **** 			pin_infoH2->polarity=gen->results[gen->indexOfcorrectResult].hall_polarity[hall_B];
 650:Core/Src/hall_detection.c **** 			break;
 651:Core/Src/hall_detection.c **** 		case hall_C:
 652:Core/Src/hall_detection.c **** 			*pin_infoH3=old_pin_infoH2;
 653:Core/Src/hall_detection.c **** 			pin_infoH3->polarity=gen->results[gen->indexOfcorrectResult].hall_polarity[hall_C];
 654:Core/Src/hall_detection.c **** 			break;
 655:Core/Src/hall_detection.c **** 		default:
 656:Core/Src/hall_detection.c **** 			break;
 657:Core/Src/hall_detection.c **** 	}
 658:Core/Src/hall_detection.c **** 
 659:Core/Src/hall_detection.c **** 	switch (gen->results[gen->indexOfcorrectResult].hall_order[phase_C]) {
 1311              		.loc 1 659 2 is_stmt 1 view .LVU365
 1312              		.loc 1 659 26 is_stmt 0 view .LVU366
 1313 0058 D4F85C11 		ldr	r1, [r4, #348]
 1314              		.loc 1 659 60 view .LVU367
 1315 005c 04EB0111 		add	r1, r4, r1, lsl #4
 1316 0060 91F86A11 		ldrb	r1, [r1, #362]	@ zero_extendqisi2
 1317              		.loc 1 659 2 view .LVU368
 1318 0064 0129     		cmp	r1, #1
 1319 0066 5FD0     		beq	.L100
 1320 0068 4AB2     		sxtb	r2, r1
 1321              	.LVL96:
 1322              		.loc 1 659 2 view .LVU369
 1323 006a 002A     		cmp	r2, #0
 1324 006c 4FD0     		beq	.L101
 1325 006e 0229     		cmp	r1, #2
 1326 0070 67D0     		beq	.L102
 1327              	.LVL97:
 1328              	.L91:
 660:Core/Src/hall_detection.c **** 		case hall_A:
 661:Core/Src/hall_detection.c **** 			*pin_infoH1=old_pin_infoH3;
 662:Core/Src/hall_detection.c **** 			pin_infoH1->polarity=gen->results[gen->indexOfcorrectResult].hall_polarity[hall_A];
 663:Core/Src/hall_detection.c **** 			break;
 664:Core/Src/hall_detection.c **** 		case hall_B:
 665:Core/Src/hall_detection.c **** 			*pin_infoH2=old_pin_infoH3;
 666:Core/Src/hall_detection.c **** 			pin_infoH2->polarity=gen->results[gen->indexOfcorrectResult].hall_polarity[hall_B];
 667:Core/Src/hall_detection.c **** 			break;
 668:Core/Src/hall_detection.c **** 		case hall_C:
 669:Core/Src/hall_detection.c **** 			*pin_infoH3=old_pin_infoH3;
 670:Core/Src/hall_detection.c **** 			pin_infoH3->polarity=gen->results[gen->indexOfcorrectResult].hall_polarity[hall_C];
 671:Core/Src/hall_detection.c **** 			break;
 672:Core/Src/hall_detection.c **** 		default:
 673:Core/Src/hall_detection.c **** 			break;
 674:Core/Src/hall_detection.c **** 	}
 675:Core/Src/hall_detection.c **** 
 676:Core/Src/hall_detection.c **** }
 1329              		.loc 1 676 1 view .LVU370
 1330 0072 07B0     		add	sp, sp, #28
 1331              	.LCFI20:
ARM GAS  /tmp/ccsur3Tq.s 			page 38


 1332              		.cfi_remember_state
 1333              		.cfi_def_cfa_offset 12
 1334              		@ sp needed
 1335 0074 70BC     		pop	{r4, r5, r6}
 1336              	.LCFI21:
 1337              		.cfi_restore 6
 1338              		.cfi_restore 5
 1339              		.cfi_restore 4
 1340              		.cfi_def_cfa_offset 0
 1341              	.LVL98:
 1342              		.loc 1 676 1 view .LVU371
 1343 0076 7047     		bx	lr
 1344              	.LVL99:
 1345              	.L93:
 1346              	.LCFI22:
 1347              		.cfi_restore_state
 627:Core/Src/hall_detection.c **** 			pin_infoH1->polarity= gen->results[gen->indexOfcorrectResult].hall_polarity[hall_A];//dont forge
 1348              		.loc 1 627 4 is_stmt 1 view .LVU372
 627:Core/Src/hall_detection.c **** 			pin_infoH1->polarity= gen->results[gen->indexOfcorrectResult].hall_polarity[hall_A];//dont forge
 1349              		.loc 1 627 15 is_stmt 0 view .LVU373
 1350 0078 06A9     		add	r1, sp, #24
 1351 007a 11E90300 		ldmdb	r1, {r0, r1}
 1352 007e 85E80300 		stm	r5, {r0, r1}
 628:Core/Src/hall_detection.c **** 			break;
 1353              		.loc 1 628 4 is_stmt 1 view .LVU374
 628:Core/Src/hall_detection.c **** 			break;
 1354              		.loc 1 628 42 is_stmt 0 view .LVU375
 1355 0082 D4F85C11 		ldr	r1, [r4, #348]
 628:Core/Src/hall_detection.c **** 			break;
 1356              		.loc 1 628 79 view .LVU376
 1357 0086 04EB0111 		add	r1, r4, r1, lsl #4
 1358 008a 91F86B11 		ldrb	r1, [r1, #363]	@ zero_extendqisi2
 628:Core/Src/hall_detection.c **** 			break;
 1359              		.loc 1 628 24 view .LVU377
 1360 008e A971     		strb	r1, [r5, #6]
 629:Core/Src/hall_detection.c **** 		case hall_B:
 1361              		.loc 1 629 4 is_stmt 1 view .LVU378
 1362 0090 D5E7     		b	.L95
 1363              	.L92:
 631:Core/Src/hall_detection.c **** 			pin_infoH2->polarity=gen->results[gen->indexOfcorrectResult].hall_polarity[hall_B];
 1364              		.loc 1 631 4 view .LVU379
 631:Core/Src/hall_detection.c **** 			pin_infoH2->polarity=gen->results[gen->indexOfcorrectResult].hall_polarity[hall_B];
 1365              		.loc 1 631 15 is_stmt 0 view .LVU380
 1366 0092 06A9     		add	r1, sp, #24
 1367 0094 11E90300 		ldmdb	r1, {r0, r1}
 1368 0098 82E80300 		stm	r2, {r0, r1}
 632:Core/Src/hall_detection.c **** 			break;
 1369              		.loc 1 632 4 is_stmt 1 view .LVU381
 632:Core/Src/hall_detection.c **** 			break;
 1370              		.loc 1 632 41 is_stmt 0 view .LVU382
 1371 009c D4F85C11 		ldr	r1, [r4, #348]
 632:Core/Src/hall_detection.c **** 			break;
 1372              		.loc 1 632 78 view .LVU383
 1373 00a0 04EB0111 		add	r1, r4, r1, lsl #4
 1374 00a4 91F86C11 		ldrb	r1, [r1, #364]	@ zero_extendqisi2
 632:Core/Src/hall_detection.c **** 			break;
 1375              		.loc 1 632 24 view .LVU384
ARM GAS  /tmp/ccsur3Tq.s 			page 39


 1376 00a8 9171     		strb	r1, [r2, #6]
 633:Core/Src/hall_detection.c **** 		case hall_C:
 1377              		.loc 1 633 4 is_stmt 1 view .LVU385
 1378 00aa C8E7     		b	.L95
 1379              	.L94:
 635:Core/Src/hall_detection.c **** 			pin_infoH3->polarity=gen->results[gen->indexOfcorrectResult].hall_polarity[hall_C];
 1380              		.loc 1 635 4 view .LVU386
 635:Core/Src/hall_detection.c **** 			pin_infoH3->polarity=gen->results[gen->indexOfcorrectResult].hall_polarity[hall_C];
 1381              		.loc 1 635 15 is_stmt 0 view .LVU387
 1382 00ac 06A9     		add	r1, sp, #24
 1383 00ae 11E90300 		ldmdb	r1, {r0, r1}
 1384 00b2 83E80300 		stm	r3, {r0, r1}
 636:Core/Src/hall_detection.c **** 			break;
 1385              		.loc 1 636 4 is_stmt 1 view .LVU388
 636:Core/Src/hall_detection.c **** 			break;
 1386              		.loc 1 636 41 is_stmt 0 view .LVU389
 1387 00b6 D4F85C11 		ldr	r1, [r4, #348]
 636:Core/Src/hall_detection.c **** 			break;
 1388              		.loc 1 636 78 view .LVU390
 1389 00ba 04EB0111 		add	r1, r4, r1, lsl #4
 1390 00be 91F86D11 		ldrb	r1, [r1, #365]	@ zero_extendqisi2
 636:Core/Src/hall_detection.c **** 			break;
 1391              		.loc 1 636 24 view .LVU391
 1392 00c2 9971     		strb	r1, [r3, #6]
 637:Core/Src/hall_detection.c **** 		default:
 1393              		.loc 1 637 4 is_stmt 1 view .LVU392
 1394 00c4 BBE7     		b	.L95
 1395              	.L97:
 644:Core/Src/hall_detection.c **** 			pin_infoH1->polarity=gen->results[gen->indexOfcorrectResult].hall_polarity[hall_A];
 1396              		.loc 1 644 4 view .LVU393
 644:Core/Src/hall_detection.c **** 			pin_infoH1->polarity=gen->results[gen->indexOfcorrectResult].hall_polarity[hall_A];
 1397              		.loc 1 644 15 is_stmt 0 view .LVU394
 1398 00c6 02A9     		add	r1, sp, #8
 1399 00c8 03C9     		ldm	r1, {r0, r1}
 1400 00ca 85E80300 		stm	r5, {r0, r1}
 645:Core/Src/hall_detection.c **** 			break;
 1401              		.loc 1 645 4 is_stmt 1 view .LVU395
 645:Core/Src/hall_detection.c **** 			break;
 1402              		.loc 1 645 41 is_stmt 0 view .LVU396
 1403 00ce D4F85C11 		ldr	r1, [r4, #348]
 645:Core/Src/hall_detection.c **** 			break;
 1404              		.loc 1 645 78 view .LVU397
 1405 00d2 04EB0111 		add	r1, r4, r1, lsl #4
 1406 00d6 91F86B11 		ldrb	r1, [r1, #363]	@ zero_extendqisi2
 645:Core/Src/hall_detection.c **** 			break;
 1407              		.loc 1 645 24 view .LVU398
 1408 00da A971     		strb	r1, [r5, #6]
 646:Core/Src/hall_detection.c **** 		case hall_B:
 1409              		.loc 1 646 4 is_stmt 1 view .LVU399
 1410 00dc BCE7     		b	.L99
 1411              	.L96:
 648:Core/Src/hall_detection.c **** 			pin_infoH2->polarity=gen->results[gen->indexOfcorrectResult].hall_polarity[hall_B];
 1412              		.loc 1 648 4 view .LVU400
 648:Core/Src/hall_detection.c **** 			pin_infoH2->polarity=gen->results[gen->indexOfcorrectResult].hall_polarity[hall_B];
 1413              		.loc 1 648 15 is_stmt 0 view .LVU401
 1414 00de 02A9     		add	r1, sp, #8
 1415 00e0 03C9     		ldm	r1, {r0, r1}
ARM GAS  /tmp/ccsur3Tq.s 			page 40


 1416 00e2 82E80300 		stm	r2, {r0, r1}
 649:Core/Src/hall_detection.c **** 			break;
 1417              		.loc 1 649 4 is_stmt 1 view .LVU402
 649:Core/Src/hall_detection.c **** 			break;
 1418              		.loc 1 649 41 is_stmt 0 view .LVU403
 1419 00e6 D4F85C11 		ldr	r1, [r4, #348]
 649:Core/Src/hall_detection.c **** 			break;
 1420              		.loc 1 649 78 view .LVU404
 1421 00ea 04EB0111 		add	r1, r4, r1, lsl #4
 1422 00ee 91F86C11 		ldrb	r1, [r1, #364]	@ zero_extendqisi2
 649:Core/Src/hall_detection.c **** 			break;
 1423              		.loc 1 649 24 view .LVU405
 1424 00f2 9171     		strb	r1, [r2, #6]
 650:Core/Src/hall_detection.c **** 		case hall_C:
 1425              		.loc 1 650 4 is_stmt 1 view .LVU406
 1426 00f4 B0E7     		b	.L99
 1427              	.L98:
 652:Core/Src/hall_detection.c **** 			pin_infoH3->polarity=gen->results[gen->indexOfcorrectResult].hall_polarity[hall_C];
 1428              		.loc 1 652 4 view .LVU407
 652:Core/Src/hall_detection.c **** 			pin_infoH3->polarity=gen->results[gen->indexOfcorrectResult].hall_polarity[hall_C];
 1429              		.loc 1 652 15 is_stmt 0 view .LVU408
 1430 00f6 02A9     		add	r1, sp, #8
 1431 00f8 03C9     		ldm	r1, {r0, r1}
 1432 00fa 83E80300 		stm	r3, {r0, r1}
 653:Core/Src/hall_detection.c **** 			break;
 1433              		.loc 1 653 4 is_stmt 1 view .LVU409
 653:Core/Src/hall_detection.c **** 			break;
 1434              		.loc 1 653 41 is_stmt 0 view .LVU410
 1435 00fe D4F85C11 		ldr	r1, [r4, #348]
 653:Core/Src/hall_detection.c **** 			break;
 1436              		.loc 1 653 78 view .LVU411
 1437 0102 04EB0111 		add	r1, r4, r1, lsl #4
 1438 0106 91F86D11 		ldrb	r1, [r1, #365]	@ zero_extendqisi2
 653:Core/Src/hall_detection.c **** 			break;
 1439              		.loc 1 653 24 view .LVU412
 1440 010a 9971     		strb	r1, [r3, #6]
 654:Core/Src/hall_detection.c **** 		default:
 1441              		.loc 1 654 4 is_stmt 1 view .LVU413
 1442 010c A4E7     		b	.L99
 1443              	.LVL100:
 1444              	.L101:
 661:Core/Src/hall_detection.c **** 			pin_infoH1->polarity=gen->results[gen->indexOfcorrectResult].hall_polarity[hall_A];
 1445              		.loc 1 661 4 view .LVU414
 661:Core/Src/hall_detection.c **** 			pin_infoH1->polarity=gen->results[gen->indexOfcorrectResult].hall_polarity[hall_A];
 1446              		.loc 1 661 15 is_stmt 0 view .LVU415
 1447 010e 6B46     		mov	r3, sp
 1448              	.LVL101:
 661:Core/Src/hall_detection.c **** 			pin_infoH1->polarity=gen->results[gen->indexOfcorrectResult].hall_polarity[hall_A];
 1449              		.loc 1 661 15 view .LVU416
 1450 0110 93E80300 		ldm	r3, {r0, r1}
 1451 0114 85E80300 		stm	r5, {r0, r1}
 662:Core/Src/hall_detection.c **** 			break;
 1452              		.loc 1 662 4 is_stmt 1 view .LVU417
 662:Core/Src/hall_detection.c **** 			break;
 1453              		.loc 1 662 41 is_stmt 0 view .LVU418
 1454 0118 D4F85C31 		ldr	r3, [r4, #348]
 662:Core/Src/hall_detection.c **** 			break;
ARM GAS  /tmp/ccsur3Tq.s 			page 41


 1455              		.loc 1 662 78 view .LVU419
 1456 011c 04EB0314 		add	r4, r4, r3, lsl #4
 1457              	.LVL102:
 662:Core/Src/hall_detection.c **** 			break;
 1458              		.loc 1 662 78 view .LVU420
 1459 0120 94F86B31 		ldrb	r3, [r4, #363]	@ zero_extendqisi2
 662:Core/Src/hall_detection.c **** 			break;
 1460              		.loc 1 662 24 view .LVU421
 1461 0124 AB71     		strb	r3, [r5, #6]
 663:Core/Src/hall_detection.c **** 		case hall_B:
 1462              		.loc 1 663 4 is_stmt 1 view .LVU422
 1463 0126 A4E7     		b	.L91
 1464              	.LVL103:
 1465              	.L100:
 665:Core/Src/hall_detection.c **** 			pin_infoH2->polarity=gen->results[gen->indexOfcorrectResult].hall_polarity[hall_B];
 1466              		.loc 1 665 4 view .LVU423
 665:Core/Src/hall_detection.c **** 			pin_infoH2->polarity=gen->results[gen->indexOfcorrectResult].hall_polarity[hall_B];
 1467              		.loc 1 665 15 is_stmt 0 view .LVU424
 1468 0128 6B46     		mov	r3, sp
 1469              	.LVL104:
 665:Core/Src/hall_detection.c **** 			pin_infoH2->polarity=gen->results[gen->indexOfcorrectResult].hall_polarity[hall_B];
 1470              		.loc 1 665 15 view .LVU425
 1471 012a 93E80300 		ldm	r3, {r0, r1}
 1472 012e 82E80300 		stm	r2, {r0, r1}
 666:Core/Src/hall_detection.c **** 			break;
 1473              		.loc 1 666 4 is_stmt 1 view .LVU426
 666:Core/Src/hall_detection.c **** 			break;
 1474              		.loc 1 666 41 is_stmt 0 view .LVU427
 1475 0132 D4F85C31 		ldr	r3, [r4, #348]
 666:Core/Src/hall_detection.c **** 			break;
 1476              		.loc 1 666 78 view .LVU428
 1477 0136 04EB0314 		add	r4, r4, r3, lsl #4
 1478              	.LVL105:
 666:Core/Src/hall_detection.c **** 			break;
 1479              		.loc 1 666 78 view .LVU429
 1480 013a 94F86C31 		ldrb	r3, [r4, #364]	@ zero_extendqisi2
 666:Core/Src/hall_detection.c **** 			break;
 1481              		.loc 1 666 24 view .LVU430
 1482 013e 9371     		strb	r3, [r2, #6]
 667:Core/Src/hall_detection.c **** 		case hall_C:
 1483              		.loc 1 667 4 is_stmt 1 view .LVU431
 1484 0140 97E7     		b	.L91
 1485              	.LVL106:
 1486              	.L102:
 669:Core/Src/hall_detection.c **** 			pin_infoH3->polarity=gen->results[gen->indexOfcorrectResult].hall_polarity[hall_C];
 1487              		.loc 1 669 4 view .LVU432
 669:Core/Src/hall_detection.c **** 			pin_infoH3->polarity=gen->results[gen->indexOfcorrectResult].hall_polarity[hall_C];
 1488              		.loc 1 669 15 is_stmt 0 view .LVU433
 1489 0142 6A46     		mov	r2, sp
 1490 0144 92E80300 		ldm	r2, {r0, r1}
 1491 0148 83E80300 		stm	r3, {r0, r1}
 670:Core/Src/hall_detection.c **** 			break;
 1492              		.loc 1 670 4 is_stmt 1 view .LVU434
 670:Core/Src/hall_detection.c **** 			break;
 1493              		.loc 1 670 41 is_stmt 0 view .LVU435
 1494 014c D4F85C21 		ldr	r2, [r4, #348]
 670:Core/Src/hall_detection.c **** 			break;
ARM GAS  /tmp/ccsur3Tq.s 			page 42


 1495              		.loc 1 670 78 view .LVU436
 1496 0150 04EB0214 		add	r4, r4, r2, lsl #4
 1497              	.LVL107:
 670:Core/Src/hall_detection.c **** 			break;
 1498              		.loc 1 670 78 view .LVU437
 1499 0154 94F86D21 		ldrb	r2, [r4, #365]	@ zero_extendqisi2
 670:Core/Src/hall_detection.c **** 			break;
 1500              		.loc 1 670 24 view .LVU438
 1501 0158 9A71     		strb	r2, [r3, #6]
 671:Core/Src/hall_detection.c **** 		default:
 1502              		.loc 1 671 4 is_stmt 1 view .LVU439
 1503              		.loc 1 676 1 is_stmt 0 view .LVU440
 1504 015a 8AE7     		b	.L91
 1505              		.cfi_endproc
 1506              	.LFE250:
 1508              		.section	.text.absolute,"ax",%progbits
 1509              		.align	1
 1510              		.global	absolute
 1511              		.syntax unified
 1512              		.thumb
 1513              		.thumb_func
 1514              		.fpu fpv4-sp-d16
 1516              	absolute:
 1517              	.LVL108:
 1518              	.LFB251:
 677:Core/Src/hall_detection.c **** 
 678:Core/Src/hall_detection.c **** /**
 679:Core/Src/hall_detection.c **** * \brief small and util to calculate signed absolute values
 680:Core/Src/hall_detection.c **** * \param the number to be absoluted
 681:Core/Src/hall_detection.c **** * \return |x|
 682:Core/Src/hall_detection.c **** */
 683:Core/Src/hall_detection.c **** int32_t absolute(int32_t x){
 1519              		.loc 1 683 28 is_stmt 1 view -0
 1520              		.cfi_startproc
 1521              		@ args = 0, pretend = 0, frame = 0
 1522              		@ frame_needed = 0, uses_anonymous_args = 0
 1523              		@ link register save eliminated.
 684:Core/Src/hall_detection.c ****     return (int32_t)x < (int32_t)0 ? -x : x;
 1524              		.loc 1 684 5 view .LVU442
 685:Core/Src/hall_detection.c **** }
 1525              		.loc 1 685 1 is_stmt 0 view .LVU443
 1526 0000 0028     		cmp	r0, #0
 1527 0002 B8BF     		it	lt
 1528 0004 4042     		rsblt	r0, r0, #0
 1529              	.LVL109:
 1530              		.loc 1 685 1 view .LVU444
 1531 0006 7047     		bx	lr
 1532              		.cfi_endproc
 1533              	.LFE251:
 1535              		.section	.text.assign_polarity,"ax",%progbits
 1536              		.align	1
 1537              		.global	assign_polarity
 1538              		.syntax unified
 1539              		.thumb
 1540              		.thumb_func
 1541              		.fpu fpv4-sp-d16
 1543              	assign_polarity:
ARM GAS  /tmp/ccsur3Tq.s 			page 43


 1544              	.LVL110:
 1545              	.LFB253:
 686:Core/Src/hall_detection.c **** 
 687:Core/Src/hall_detection.c **** /**
 688:Core/Src/hall_detection.c **** * \brief magic function, from zerocrossings decides actuall order of hall/current signals, this fun
 689:Core/Src/hall_detection.c **** * right now has a cyclomatic complexity of 21, that should be reduced.
 690:Core/Src/hall_detection.c **** * \param hall_detection_general_struct *gen, 	pointer to the huge structure containing everything t
 691:Core/Src/hall_detection.c **** */
 692:Core/Src/hall_detection.c **** void assign_closest_phase_to_hall(hall_detection_general_struct *gen){
 693:Core/Src/hall_detection.c **** 
 694:Core/Src/hall_detection.c **** 	resetVariables_diferences(gen);
 695:Core/Src/hall_detection.c **** 
 696:Core/Src/hall_detection.c **** 	for (uint32_t i = 0; i < MAXZEROCROSSINGS; ++i) {// all zerocrossings loop
 697:Core/Src/hall_detection.c **** 		gen->differences_phaseA[phase_A]+=absolute((int32_t)gen->currA.zerocrossings_tick[i]-(int32_t)gen
 698:Core/Src/hall_detection.c **** 		gen->differences_phaseA[phase_B]+=absolute((int32_t)gen->currA.zerocrossings_tick[i]-(int32_t)gen
 699:Core/Src/hall_detection.c **** 		gen->differences_phaseA[phase_C]+=absolute((int32_t)gen->currA.zerocrossings_tick[i]-(int32_t)gen
 700:Core/Src/hall_detection.c **** 
 701:Core/Src/hall_detection.c **** 		gen->differences_phaseB[phase_A]+=absolute((int32_t)gen->currB.zerocrossings_tick[i]-(int32_t)gen
 702:Core/Src/hall_detection.c **** 		gen->differences_phaseB[phase_B]+=absolute((int32_t)gen->currB.zerocrossings_tick[i]-(int32_t)gen
 703:Core/Src/hall_detection.c **** 		gen->differences_phaseB[phase_C]+=absolute((int32_t)gen->currB.zerocrossings_tick[i]-(int32_t)gen
 704:Core/Src/hall_detection.c **** 
 705:Core/Src/hall_detection.c **** 		gen->differences_phaseC[phase_A]+=absolute((int32_t)gen->currC.zerocrossings_tick[i]-(int32_t)gen
 706:Core/Src/hall_detection.c **** 		gen->differences_phaseC[phase_B]+=absolute((int32_t)gen->currC.zerocrossings_tick[i]-(int32_t)gen
 707:Core/Src/hall_detection.c **** 		gen->differences_phaseC[phase_C]+=absolute((int32_t)gen->currC.zerocrossings_tick[i]-(int32_t)gen
 708:Core/Src/hall_detection.c **** 	}
 709:Core/Src/hall_detection.c **** 
 710:Core/Src/hall_detection.c **** 	int32_t _bottom_limit	=(int32_t)((gen->results[gen->numberOfresults].electricPeriod_ticks/2)*0.95)
 711:Core/Src/hall_detection.c **** 	int32_t _top_limit		=(int32_t)(gen->results[gen->numberOfresults].electricPeriod_ticks);
 712:Core/Src/hall_detection.c **** 	int32_t minimum[NUMBEROFPHASES]={0xFF,0xFF,0xFF};
 713:Core/Src/hall_detection.c **** 
 714:Core/Src/hall_detection.c **** 	for (uint32_t i = 0; i < NUMBEROFPHASES; ++i) {
 715:Core/Src/hall_detection.c **** 		gen->differences_phaseA[i]/=MAXZEROCROSSINGS;
 716:Core/Src/hall_detection.c **** 		gen->differences_phaseB[i]/=MAXZEROCROSSINGS;
 717:Core/Src/hall_detection.c **** 		gen->differences_phaseC[i]/=MAXZEROCROSSINGS;
 718:Core/Src/hall_detection.c **** 
 719:Core/Src/hall_detection.c **** 		//sometimes the toggled polarity is detected from a non relevant phase, in this case we are wrong
 720:Core/Src/hall_detection.c **** 		if(gen->differences_phaseA[i]>_bottom_limit && gen->differences_phaseA[i]<_top_limit){
 721:Core/Src/hall_detection.c **** 			gen->differences_phaseA[i]%=_bottom_limit;
 722:Core/Src/hall_detection.c **** 			gen->shifted_polarity[hall_A][i]=1;
 723:Core/Src/hall_detection.c **** 		}else{
 724:Core/Src/hall_detection.c **** 			gen->shifted_polarity[hall_A][i]=0;
 725:Core/Src/hall_detection.c **** 		}
 726:Core/Src/hall_detection.c **** 
 727:Core/Src/hall_detection.c **** 		if(gen->differences_phaseB[i]>_bottom_limit && gen->differences_phaseB[i]<_top_limit){
 728:Core/Src/hall_detection.c **** 			gen->differences_phaseB[i]%=_bottom_limit;
 729:Core/Src/hall_detection.c **** 			gen->shifted_polarity[hall_B][i]=1;
 730:Core/Src/hall_detection.c **** 		}else{
 731:Core/Src/hall_detection.c **** 			gen->shifted_polarity[hall_B][i]=0;
 732:Core/Src/hall_detection.c **** 		}
 733:Core/Src/hall_detection.c **** 
 734:Core/Src/hall_detection.c **** 		if(gen->differences_phaseC[i]>_bottom_limit && gen->differences_phaseC[i]<_top_limit){
 735:Core/Src/hall_detection.c **** 			gen->differences_phaseC[i]%=_bottom_limit;
 736:Core/Src/hall_detection.c **** 			gen->shifted_polarity[hall_C][i]=1;
 737:Core/Src/hall_detection.c **** 		}else{
 738:Core/Src/hall_detection.c **** 			gen->shifted_polarity[hall_C][i]=0;
 739:Core/Src/hall_detection.c **** 		}
 740:Core/Src/hall_detection.c **** 
ARM GAS  /tmp/ccsur3Tq.s 			page 44


 741:Core/Src/hall_detection.c **** 		//takes notes of the minimum difference
 742:Core/Src/hall_detection.c **** 		if(gen->differences_phaseA[i]<minimum[phase_A]){
 743:Core/Src/hall_detection.c **** 			minimum[phase_A]=gen->differences_phaseA[i];
 744:Core/Src/hall_detection.c **** 		}
 745:Core/Src/hall_detection.c **** 
 746:Core/Src/hall_detection.c **** 		if(gen->differences_phaseB[i]<minimum[phase_B]){
 747:Core/Src/hall_detection.c **** 			minimum[phase_B]=gen->differences_phaseB[i];
 748:Core/Src/hall_detection.c **** 		}
 749:Core/Src/hall_detection.c **** 
 750:Core/Src/hall_detection.c **** 		if(gen->differences_phaseC[i]<minimum[phase_C]){
 751:Core/Src/hall_detection.c **** 			minimum[phase_C]=gen->differences_phaseC[i];
 752:Core/Src/hall_detection.c **** 		}
 753:Core/Src/hall_detection.c **** 	}
 754:Core/Src/hall_detection.c **** 	//finds out wichone is the minimum diff
 755:Core/Src/hall_detection.c **** 	for (uint32_t i = 0; i < NUMBEROFPHASES; ++i) {
 756:Core/Src/hall_detection.c **** 		if(gen->differences_phaseA[i]==minimum[phase_A]){
 757:Core/Src/hall_detection.c **** 			gen->results[gen->numberOfresults].hall_order[i]=phase_A;
 758:Core/Src/hall_detection.c **** 		}
 759:Core/Src/hall_detection.c **** 
 760:Core/Src/hall_detection.c **** 		if(gen->differences_phaseB[i]==minimum[phase_B]){
 761:Core/Src/hall_detection.c **** 			gen->results[gen->numberOfresults].hall_order[i]=phase_B;
 762:Core/Src/hall_detection.c **** 		}
 763:Core/Src/hall_detection.c **** 
 764:Core/Src/hall_detection.c **** 		if(gen->differences_phaseC[i]==minimum[phase_C]){
 765:Core/Src/hall_detection.c **** 			gen->results[gen->numberOfresults].hall_order[i]=phase_C;
 766:Core/Src/hall_detection.c **** 		}
 767:Core/Src/hall_detection.c **** 	}
 768:Core/Src/hall_detection.c **** }
 769:Core/Src/hall_detection.c **** 
 770:Core/Src/hall_detection.c **** 
 771:Core/Src/hall_detection.c **** 
 772:Core/Src/hall_detection.c **** /**
 773:Core/Src/hall_detection.c **** * \brief the other magic function, asigns polarity from risign or falling edges, it also takes into
 774:Core/Src/hall_detection.c **** * right now has a cyclomatic complexity of 21, that should be reduced.
 775:Core/Src/hall_detection.c **** * \param hall_detection_general_struct *gen, 	pointer to the huge structure containing everything t
 776:Core/Src/hall_detection.c **** */
 777:Core/Src/hall_detection.c **** void assign_polarity(hall_detection_general_struct *gen){
 1546              		.loc 1 777 57 is_stmt 1 view -0
 1547              		.cfi_startproc
 1548              		@ args = 0, pretend = 0, frame = 24
 1549              		@ frame_needed = 0, uses_anonymous_args = 0
 1550              		@ link register save eliminated.
 1551              		.loc 1 777 57 is_stmt 0 view .LVU446
 1552 0000 30B4     		push	{r4, r5}
 1553              	.LCFI23:
 1554              		.cfi_def_cfa_offset 8
 1555              		.cfi_offset 4, -8
 1556              		.cfi_offset 5, -4
 1557 0002 86B0     		sub	sp, sp, #24
 1558              	.LCFI24:
 1559              		.cfi_def_cfa_offset 32
 778:Core/Src/hall_detection.c **** 	current_or_hall_measurements_struct*	currents[NUMBEROFPHASES]={&gen->currA,&gen->currB,&gen->currC
 1560              		.loc 1 778 2 is_stmt 1 view .LVU447
 1561              		.loc 1 778 65 is_stmt 0 view .LVU448
 1562 0004 031D     		adds	r3, r0, #4
 1563              		.loc 1 778 39 view .LVU449
 1564 0006 0393     		str	r3, [sp, #12]
ARM GAS  /tmp/ccsur3Tq.s 			page 45


 1565              		.loc 1 778 77 view .LVU450
 1566 0008 00F13003 		add	r3, r0, #48
 1567              		.loc 1 778 39 view .LVU451
 1568 000c 0493     		str	r3, [sp, #16]
 1569              		.loc 1 778 89 view .LVU452
 1570 000e 00F15C03 		add	r3, r0, #92
 1571              		.loc 1 778 39 view .LVU453
 1572 0012 0593     		str	r3, [sp, #20]
 779:Core/Src/hall_detection.c **** 	current_or_hall_measurements_struct*	halls[NUMBEROFPHASES]	={&gen->hallA,&gen->hallB,&gen->hallC};
 1573              		.loc 1 779 2 is_stmt 1 view .LVU454
 1574              		.loc 1 779 63 is_stmt 0 view .LVU455
 1575 0014 00F18803 		add	r3, r0, #136
 1576              		.loc 1 779 39 view .LVU456
 1577 0018 0093     		str	r3, [sp]
 1578              		.loc 1 779 75 view .LVU457
 1579 001a 00F1B403 		add	r3, r0, #180
 1580              		.loc 1 779 39 view .LVU458
 1581 001e 0193     		str	r3, [sp, #4]
 1582              		.loc 1 779 87 view .LVU459
 1583 0020 00F1E003 		add	r3, r0, #224
 1584              		.loc 1 779 39 view .LVU460
 1585 0024 0293     		str	r3, [sp, #8]
 780:Core/Src/hall_detection.c **** 	detection_results_struct *pointerOfcurrentResult=&gen->results[gen->numberOfresults];
 1586              		.loc 1 780 2 is_stmt 1 view .LVU461
 1587              		.loc 1 780 68 is_stmt 0 view .LVU462
 1588 0026 D0F85841 		ldr	r4, [r0, #344]
 1589              	.LVL111:
 781:Core/Src/hall_detection.c **** 
 782:Core/Src/hall_detection.c **** 	for (uint32_t i = 0; i < NUMBEROFPHASES; ++i) {
 1590              		.loc 1 782 2 is_stmt 1 view .LVU463
 1591              	.LBB11:
 1592              		.loc 1 782 7 view .LVU464
 1593              		.loc 1 782 16 is_stmt 0 view .LVU465
 1594 002a 0023     		movs	r3, #0
 1595              		.loc 1 782 2 view .LVU466
 1596 002c 1BE0     		b	.L107
 1597              	.LVL112:
 1598              	.L115:
 783:Core/Src/hall_detection.c **** 		if(currents[pointerOfcurrentResult->hall_order[i]]->zerocrossings_polarity[1]==halls[i]->zerocros
 784:Core/Src/hall_detection.c **** 			if(gen->shifted_polarity[pointerOfcurrentResult->hall_order[i]][i]==0){
 1599              		.loc 1 784 4 is_stmt 1 view .LVU467
 1600              		.loc 1 784 67 is_stmt 0 view .LVU468
 1601 002e 02EB4201 		add	r1, r2, r2, lsl #1
 1602 0032 1944     		add	r1, r1, r3
 1603 0034 4C31     		adds	r1, r1, #76
 1604 0036 50F82110 		ldr	r1, [r0, r1, lsl #2]
 1605              		.loc 1 784 6 view .LVU469
 1606 003a 31B9     		cbnz	r1, .L109
 785:Core/Src/hall_detection.c **** 				pointerOfcurrentResult->hall_polarity[pointerOfcurrentResult->hall_order[i]]=hall_direct;
 1607              		.loc 1 785 5 is_stmt 1 view .LVU470
 1608              		.loc 1 785 81 is_stmt 0 view .LVU471
 1609 003c 00EB0411 		add	r1, r0, r4, lsl #4
 1610 0040 0A44     		add	r2, r2, r1
 1611 0042 0021     		movs	r1, #0
 1612 0044 82F86B11 		strb	r1, [r2, #363]
 1613 0048 0CE0     		b	.L110
 1614              	.L109:
ARM GAS  /tmp/ccsur3Tq.s 			page 46


 786:Core/Src/hall_detection.c **** 			}else{
 787:Core/Src/hall_detection.c **** 				pointerOfcurrentResult->hall_polarity[pointerOfcurrentResult->hall_order[i]]=hall_inverse;
 1615              		.loc 1 787 5 is_stmt 1 view .LVU472
 1616              		.loc 1 787 81 is_stmt 0 view .LVU473
 1617 004a 00EB0411 		add	r1, r0, r4, lsl #4
 1618 004e 0A44     		add	r2, r2, r1
 1619 0050 0121     		movs	r1, #1
 1620 0052 82F86B11 		strb	r1, [r2, #363]
 1621 0056 05E0     		b	.L110
 1622              	.L111:
 788:Core/Src/hall_detection.c **** 			}
 789:Core/Src/hall_detection.c **** 		}else{
 790:Core/Src/hall_detection.c **** 			if(gen->shifted_polarity[pointerOfcurrentResult->hall_order[i]][i]==0){
 791:Core/Src/hall_detection.c **** 				pointerOfcurrentResult->hall_polarity[pointerOfcurrentResult->hall_order[i]]=hall_inverse;
 792:Core/Src/hall_detection.c **** 			}else{
 793:Core/Src/hall_detection.c **** 				pointerOfcurrentResult->hall_polarity[pointerOfcurrentResult->hall_order[i]]=hall_direct;
 1623              		.loc 1 793 5 is_stmt 1 view .LVU474
 1624              		.loc 1 793 81 is_stmt 0 view .LVU475
 1625 0058 00EB0411 		add	r1, r0, r4, lsl #4
 1626 005c 0A44     		add	r2, r2, r1
 1627 005e 0021     		movs	r1, #0
 1628 0060 82F86B11 		strb	r1, [r2, #363]
 1629              	.L110:
 782:Core/Src/hall_detection.c **** 		if(currents[pointerOfcurrentResult->hall_order[i]]->zerocrossings_polarity[1]==halls[i]->zerocros
 1630              		.loc 1 782 43 discriminator 2 view .LVU476
 1631 0064 0133     		adds	r3, r3, #1
 1632              	.LVL113:
 1633              	.L107:
 782:Core/Src/hall_detection.c **** 		if(currents[pointerOfcurrentResult->hall_order[i]]->zerocrossings_polarity[1]==halls[i]->zerocros
 1634              		.loc 1 782 2 discriminator 1 view .LVU477
 1635 0066 022B     		cmp	r3, #2
 1636 0068 23D8     		bhi	.L114
 783:Core/Src/hall_detection.c **** 			if(gen->shifted_polarity[pointerOfcurrentResult->hall_order[i]][i]==0){
 1637              		.loc 1 783 3 is_stmt 1 view .LVU478
 783:Core/Src/hall_detection.c **** 			if(gen->shifted_polarity[pointerOfcurrentResult->hall_order[i]][i]==0){
 1638              		.loc 1 783 49 is_stmt 0 view .LVU479
 1639 006a 00EB0412 		add	r2, r0, r4, lsl #4
 1640 006e 1A44     		add	r2, r2, r3
 1641 0070 92F86821 		ldrb	r2, [r2, #360]	@ zero_extendqisi2
 783:Core/Src/hall_detection.c **** 			if(gen->shifted_polarity[pointerOfcurrentResult->hall_order[i]][i]==0){
 1642              		.loc 1 783 14 view .LVU480
 1643 0074 06A9     		add	r1, sp, #24
 1644 0076 01EB8201 		add	r1, r1, r2, lsl #2
 1645 007a 51F80C1C 		ldr	r1, [r1, #-12]
 783:Core/Src/hall_detection.c **** 			if(gen->shifted_polarity[pointerOfcurrentResult->hall_order[i]][i]==0){
 1646              		.loc 1 783 77 view .LVU481
 1647 007e 91F82150 		ldrb	r5, [r1, #33]	@ zero_extendqisi2
 783:Core/Src/hall_detection.c **** 			if(gen->shifted_polarity[pointerOfcurrentResult->hall_order[i]][i]==0){
 1648              		.loc 1 783 87 view .LVU482
 1649 0082 06A9     		add	r1, sp, #24
 1650 0084 01EB8301 		add	r1, r1, r3, lsl #2
 1651 0088 51F8181C 		ldr	r1, [r1, #-24]
 783:Core/Src/hall_detection.c **** 			if(gen->shifted_polarity[pointerOfcurrentResult->hall_order[i]][i]==0){
 1652              		.loc 1 783 114 view .LVU483
 1653 008c 91F82110 		ldrb	r1, [r1, #33]	@ zero_extendqisi2
 783:Core/Src/hall_detection.c **** 			if(gen->shifted_polarity[pointerOfcurrentResult->hall_order[i]][i]==0){
 1654              		.loc 1 783 5 view .LVU484
ARM GAS  /tmp/ccsur3Tq.s 			page 47


 1655 0090 8D42     		cmp	r5, r1
 1656 0092 CCD0     		beq	.L115
 790:Core/Src/hall_detection.c **** 				pointerOfcurrentResult->hall_polarity[pointerOfcurrentResult->hall_order[i]]=hall_inverse;
 1657              		.loc 1 790 4 is_stmt 1 view .LVU485
 790:Core/Src/hall_detection.c **** 				pointerOfcurrentResult->hall_polarity[pointerOfcurrentResult->hall_order[i]]=hall_inverse;
 1658              		.loc 1 790 67 is_stmt 0 view .LVU486
 1659 0094 02EB4201 		add	r1, r2, r2, lsl #1
 1660 0098 1944     		add	r1, r1, r3
 1661 009a 4C31     		adds	r1, r1, #76
 1662 009c 50F82110 		ldr	r1, [r0, r1, lsl #2]
 790:Core/Src/hall_detection.c **** 				pointerOfcurrentResult->hall_polarity[pointerOfcurrentResult->hall_order[i]]=hall_inverse;
 1663              		.loc 1 790 6 view .LVU487
 1664 00a0 0029     		cmp	r1, #0
 1665 00a2 D9D1     		bne	.L111
 791:Core/Src/hall_detection.c **** 			}else{
 1666              		.loc 1 791 5 is_stmt 1 view .LVU488
 791:Core/Src/hall_detection.c **** 			}else{
 1667              		.loc 1 791 81 is_stmt 0 view .LVU489
 1668 00a4 00EB0411 		add	r1, r0, r4, lsl #4
 1669 00a8 0A44     		add	r2, r2, r1
 1670 00aa 0121     		movs	r1, #1
 1671 00ac 82F86B11 		strb	r1, [r2, #363]
 1672 00b0 D8E7     		b	.L110
 1673              	.L114:
 791:Core/Src/hall_detection.c **** 			}else{
 1674              		.loc 1 791 81 view .LVU490
 1675              	.LBE11:
 794:Core/Src/hall_detection.c **** 			}
 795:Core/Src/hall_detection.c **** 		}
 796:Core/Src/hall_detection.c **** 	}
 797:Core/Src/hall_detection.c **** 
 798:Core/Src/hall_detection.c **** }
 1676              		.loc 1 798 1 view .LVU491
 1677 00b2 06B0     		add	sp, sp, #24
 1678              	.LCFI25:
 1679              		.cfi_def_cfa_offset 8
 1680              		@ sp needed
 1681 00b4 30BC     		pop	{r4, r5}
 1682              	.LCFI26:
 1683              		.cfi_restore 5
 1684              		.cfi_restore 4
 1685              		.cfi_def_cfa_offset 0
 1686              	.LVL114:
 1687              		.loc 1 798 1 view .LVU492
 1688 00b6 7047     		bx	lr
 1689              		.cfi_endproc
 1690              	.LFE253:
 1692              		.section	.text.resetVariables_adquisition,"ax",%progbits
 1693              		.align	1
 1694              		.global	resetVariables_adquisition
 1695              		.syntax unified
 1696              		.thumb
 1697              		.thumb_func
 1698              		.fpu fpv4-sp-d16
 1700              	resetVariables_adquisition:
 1701              	.LVL115:
 1702              	.LFB254:
ARM GAS  /tmp/ccsur3Tq.s 			page 48


 799:Core/Src/hall_detection.c **** 
 800:Core/Src/hall_detection.c **** /**
 801:Core/Src/hall_detection.c **** * \brief just resets to 0 the adquisition related part from the huge structure used by the detectio
 802:Core/Src/hall_detection.c **** * \param hall_detection_general_struct *gen, pointer to the huge structure.
 803:Core/Src/hall_detection.c **** */
 804:Core/Src/hall_detection.c **** void resetVariables_adquisition(hall_detection_general_struct *gen){
 1703              		.loc 1 804 68 is_stmt 1 view -0
 1704              		.cfi_startproc
 1705              		@ args = 0, pretend = 0, frame = 0
 1706              		@ frame_needed = 0, uses_anonymous_args = 0
 1707              		@ link register save eliminated.
 1708              		.loc 1 804 68 is_stmt 0 view .LVU494
 1709 0000 F0B4     		push	{r4, r5, r6, r7}
 1710              	.LCFI27:
 1711              		.cfi_def_cfa_offset 16
 1712              		.cfi_offset 4, -16
 1713              		.cfi_offset 5, -12
 1714              		.cfi_offset 6, -8
 1715              		.cfi_offset 7, -4
 1716 0002 0546     		mov	r5, r0
 805:Core/Src/hall_detection.c **** 	//wow this was taking too long it was throwing execution errors
 806:Core/Src/hall_detection.c **** 	//*gen=empty_general;		//i dont want to use memset, so we sacrifice flash memory space filled with
 807:Core/Src/hall_detection.c **** 	gen->currA=empty_general.currA;
 1717              		.loc 1 807 2 is_stmt 1 view .LVU495
 1718              		.loc 1 807 12 is_stmt 0 view .LVU496
 1719 0004 2D4C     		ldr	r4, .L118
 1720 0006 061D     		adds	r6, r0, #4
 1721 0008 271D     		adds	r7, r4, #4
 1722 000a 0FCF     		ldmia	r7!, {r0, r1, r2, r3}
 1723              	.LVL116:
 1724              		.loc 1 807 12 view .LVU497
 1725 000c 0FC6     		stmia	r6!, {r0, r1, r2, r3}
 1726 000e 0FCF     		ldmia	r7!, {r0, r1, r2, r3}
 1727 0010 0FC6     		stmia	r6!, {r0, r1, r2, r3}
 1728 0012 97E80700 		ldm	r7, {r0, r1, r2}
 1729 0016 86E80700 		stm	r6, {r0, r1, r2}
 808:Core/Src/hall_detection.c **** 	gen->currB=empty_general.currB;
 1730              		.loc 1 808 2 is_stmt 1 view .LVU498
 1731              		.loc 1 808 12 is_stmt 0 view .LVU499
 1732 001a 05F13006 		add	r6, r5, #48
 1733 001e 04F13007 		add	r7, r4, #48
 1734 0022 0FCF     		ldmia	r7!, {r0, r1, r2, r3}
 1735 0024 0FC6     		stmia	r6!, {r0, r1, r2, r3}
 1736 0026 0FCF     		ldmia	r7!, {r0, r1, r2, r3}
 1737 0028 0FC6     		stmia	r6!, {r0, r1, r2, r3}
 1738 002a 97E80700 		ldm	r7, {r0, r1, r2}
 1739 002e 86E80700 		stm	r6, {r0, r1, r2}
 809:Core/Src/hall_detection.c **** 	gen->currC=empty_general.currC;
 1740              		.loc 1 809 2 is_stmt 1 view .LVU500
 1741              		.loc 1 809 12 is_stmt 0 view .LVU501
 1742 0032 05F15C06 		add	r6, r5, #92
 1743 0036 04F15C07 		add	r7, r4, #92
 1744 003a 0FCF     		ldmia	r7!, {r0, r1, r2, r3}
 1745 003c 0FC6     		stmia	r6!, {r0, r1, r2, r3}
 1746 003e 0FCF     		ldmia	r7!, {r0, r1, r2, r3}
 1747 0040 0FC6     		stmia	r6!, {r0, r1, r2, r3}
 1748 0042 97E80700 		ldm	r7, {r0, r1, r2}
ARM GAS  /tmp/ccsur3Tq.s 			page 49


 1749 0046 86E80700 		stm	r6, {r0, r1, r2}
 810:Core/Src/hall_detection.c **** 	gen->hallA=empty_general.hallA;
 1750              		.loc 1 810 2 is_stmt 1 view .LVU502
 1751              		.loc 1 810 12 is_stmt 0 view .LVU503
 1752 004a 05F18806 		add	r6, r5, #136
 1753 004e 04F18807 		add	r7, r4, #136
 1754 0052 0FCF     		ldmia	r7!, {r0, r1, r2, r3}
 1755 0054 0FC6     		stmia	r6!, {r0, r1, r2, r3}
 1756 0056 0FCF     		ldmia	r7!, {r0, r1, r2, r3}
 1757 0058 0FC6     		stmia	r6!, {r0, r1, r2, r3}
 1758 005a 97E80700 		ldm	r7, {r0, r1, r2}
 1759 005e 86E80700 		stm	r6, {r0, r1, r2}
 811:Core/Src/hall_detection.c **** 	gen->hallB=empty_general.hallB;
 1760              		.loc 1 811 2 is_stmt 1 view .LVU504
 1761              		.loc 1 811 12 is_stmt 0 view .LVU505
 1762 0062 05F1B406 		add	r6, r5, #180
 1763 0066 04F1B407 		add	r7, r4, #180
 1764 006a 0FCF     		ldmia	r7!, {r0, r1, r2, r3}
 1765 006c 0FC6     		stmia	r6!, {r0, r1, r2, r3}
 1766 006e 0FCF     		ldmia	r7!, {r0, r1, r2, r3}
 1767 0070 0FC6     		stmia	r6!, {r0, r1, r2, r3}
 1768 0072 97E80700 		ldm	r7, {r0, r1, r2}
 1769 0076 86E80700 		stm	r6, {r0, r1, r2}
 812:Core/Src/hall_detection.c **** 	gen->hallC=empty_general.hallC;
 1770              		.loc 1 812 2 is_stmt 1 view .LVU506
 1771              		.loc 1 812 12 is_stmt 0 view .LVU507
 1772 007a 05F1E006 		add	r6, r5, #224
 1773 007e E034     		adds	r4, r4, #224
 1774 0080 0FCC     		ldmia	r4!, {r0, r1, r2, r3}
 1775 0082 0FC6     		stmia	r6!, {r0, r1, r2, r3}
 1776 0084 0FCC     		ldmia	r4!, {r0, r1, r2, r3}
 1777 0086 0FC6     		stmia	r6!, {r0, r1, r2, r3}
 1778 0088 94E80700 		ldm	r4, {r0, r1, r2}
 1779 008c 86E80700 		stm	r6, {r0, r1, r2}
 813:Core/Src/hall_detection.c **** 
 814:Core/Src/hall_detection.c **** 	gen->differences_phaseA[0]=empty_general.differences_phaseA[0];
 1780              		.loc 1 814 2 is_stmt 1 view .LVU508
 1781              		.loc 1 814 28 is_stmt 0 view .LVU509
 1782 0090 0023     		movs	r3, #0
 1783 0092 C5F80C31 		str	r3, [r5, #268]
 815:Core/Src/hall_detection.c **** 	gen->differences_phaseA[1]=empty_general.differences_phaseA[1];
 1784              		.loc 1 815 2 is_stmt 1 view .LVU510
 1785              		.loc 1 815 28 is_stmt 0 view .LVU511
 1786 0096 C5F81031 		str	r3, [r5, #272]
 816:Core/Src/hall_detection.c **** 	gen->differences_phaseA[2]=empty_general.differences_phaseA[2];
 1787              		.loc 1 816 2 is_stmt 1 view .LVU512
 1788              		.loc 1 816 28 is_stmt 0 view .LVU513
 1789 009a C5F81431 		str	r3, [r5, #276]
 817:Core/Src/hall_detection.c **** 
 818:Core/Src/hall_detection.c **** 	gen->differences_phaseB[0]=empty_general.differences_phaseB[0];
 1790              		.loc 1 818 2 is_stmt 1 view .LVU514
 1791              		.loc 1 818 28 is_stmt 0 view .LVU515
 1792 009e C5F81831 		str	r3, [r5, #280]
 819:Core/Src/hall_detection.c **** 	gen->differences_phaseB[1]=empty_general.differences_phaseB[1];
 1793              		.loc 1 819 2 is_stmt 1 view .LVU516
 1794              		.loc 1 819 28 is_stmt 0 view .LVU517
 1795 00a2 C5F81C31 		str	r3, [r5, #284]
ARM GAS  /tmp/ccsur3Tq.s 			page 50


 820:Core/Src/hall_detection.c **** 	gen->differences_phaseB[2]=empty_general.differences_phaseB[2];
 1796              		.loc 1 820 2 is_stmt 1 view .LVU518
 1797              		.loc 1 820 28 is_stmt 0 view .LVU519
 1798 00a6 C5F82031 		str	r3, [r5, #288]
 821:Core/Src/hall_detection.c **** 
 822:Core/Src/hall_detection.c **** 	gen->differences_phaseC[0]=empty_general.differences_phaseC[0];
 1799              		.loc 1 822 2 is_stmt 1 view .LVU520
 1800              		.loc 1 822 28 is_stmt 0 view .LVU521
 1801 00aa C5F82431 		str	r3, [r5, #292]
 823:Core/Src/hall_detection.c **** 	gen->differences_phaseC[1]=empty_general.differences_phaseC[1];
 1802              		.loc 1 823 2 is_stmt 1 view .LVU522
 1803              		.loc 1 823 28 is_stmt 0 view .LVU523
 1804 00ae C5F82831 		str	r3, [r5, #296]
 824:Core/Src/hall_detection.c **** 	gen->differences_phaseC[2]=empty_general.differences_phaseC[2];
 1805              		.loc 1 824 2 is_stmt 1 view .LVU524
 1806              		.loc 1 824 28 is_stmt 0 view .LVU525
 1807 00b2 C5F82C31 		str	r3, [r5, #300]
 825:Core/Src/hall_detection.c **** }
 1808              		.loc 1 825 1 view .LVU526
 1809 00b6 F0BC     		pop	{r4, r5, r6, r7}
 1810              	.LCFI28:
 1811              		.cfi_restore 7
 1812              		.cfi_restore 6
 1813              		.cfi_restore 5
 1814              		.cfi_restore 4
 1815              		.cfi_def_cfa_offset 0
 1816              	.LVL117:
 1817              		.loc 1 825 1 view .LVU527
 1818 00b8 7047     		bx	lr
 1819              	.L119:
 1820 00ba 00BF     		.align	2
 1821              	.L118:
 1822 00bc 00000000 		.word	.LANCHOR2
 1823              		.cfi_endproc
 1824              	.LFE254:
 1826              		.section	.text.resetVariables_diferences,"ax",%progbits
 1827              		.align	1
 1828              		.global	resetVariables_diferences
 1829              		.syntax unified
 1830              		.thumb
 1831              		.thumb_func
 1832              		.fpu fpv4-sp-d16
 1834              	resetVariables_diferences:
 1835              	.LVL118:
 1836              	.LFB255:
 826:Core/Src/hall_detection.c **** 
 827:Core/Src/hall_detection.c **** /**
 828:Core/Src/hall_detection.c **** * \brief just resets to 0 the identification related part
 829:Core/Src/hall_detection.c **** * \param hall_detection_general_struct *gen, pointer to the huge structure.
 830:Core/Src/hall_detection.c **** */
 831:Core/Src/hall_detection.c **** void resetVariables_diferences(hall_detection_general_struct *gen){
 1837              		.loc 1 831 67 is_stmt 1 view -0
 1838              		.cfi_startproc
 1839              		@ args = 0, pretend = 0, frame = 0
 1840              		@ frame_needed = 0, uses_anonymous_args = 0
 1841              		@ link register save eliminated.
 832:Core/Src/hall_detection.c **** 	gen->differences_phaseA[0]=empty_general.differences_phaseA[0];
ARM GAS  /tmp/ccsur3Tq.s 			page 51


 1842              		.loc 1 832 2 view .LVU529
 1843              		.loc 1 832 28 is_stmt 0 view .LVU530
 1844 0000 0023     		movs	r3, #0
 1845 0002 C0F80C31 		str	r3, [r0, #268]
 833:Core/Src/hall_detection.c **** 	gen->differences_phaseA[1]=empty_general.differences_phaseA[1];
 1846              		.loc 1 833 2 is_stmt 1 view .LVU531
 1847              		.loc 1 833 28 is_stmt 0 view .LVU532
 1848 0006 C0F81031 		str	r3, [r0, #272]
 834:Core/Src/hall_detection.c **** 	gen->differences_phaseA[2]=empty_general.differences_phaseA[2];
 1849              		.loc 1 834 2 is_stmt 1 view .LVU533
 1850              		.loc 1 834 28 is_stmt 0 view .LVU534
 1851 000a C0F81431 		str	r3, [r0, #276]
 835:Core/Src/hall_detection.c **** 
 836:Core/Src/hall_detection.c **** 	gen->differences_phaseB[0]=empty_general.differences_phaseB[0];
 1852              		.loc 1 836 2 is_stmt 1 view .LVU535
 1853              		.loc 1 836 28 is_stmt 0 view .LVU536
 1854 000e C0F81831 		str	r3, [r0, #280]
 837:Core/Src/hall_detection.c **** 	gen->differences_phaseB[1]=empty_general.differences_phaseB[1];
 1855              		.loc 1 837 2 is_stmt 1 view .LVU537
 1856              		.loc 1 837 28 is_stmt 0 view .LVU538
 1857 0012 C0F81C31 		str	r3, [r0, #284]
 838:Core/Src/hall_detection.c **** 	gen->differences_phaseB[2]=empty_general.differences_phaseB[2];
 1858              		.loc 1 838 2 is_stmt 1 view .LVU539
 1859              		.loc 1 838 28 is_stmt 0 view .LVU540
 1860 0016 C0F82031 		str	r3, [r0, #288]
 839:Core/Src/hall_detection.c **** 
 840:Core/Src/hall_detection.c **** 	gen->differences_phaseC[0]=empty_general.differences_phaseC[0];
 1861              		.loc 1 840 2 is_stmt 1 view .LVU541
 1862              		.loc 1 840 28 is_stmt 0 view .LVU542
 1863 001a C0F82431 		str	r3, [r0, #292]
 841:Core/Src/hall_detection.c **** 	gen->differences_phaseC[1]=empty_general.differences_phaseC[1];
 1864              		.loc 1 841 2 is_stmt 1 view .LVU543
 1865              		.loc 1 841 28 is_stmt 0 view .LVU544
 1866 001e C0F82831 		str	r3, [r0, #296]
 842:Core/Src/hall_detection.c **** 	gen->differences_phaseC[2]=empty_general.differences_phaseC[2];
 1867              		.loc 1 842 2 is_stmt 1 view .LVU545
 1868              		.loc 1 842 28 is_stmt 0 view .LVU546
 1869 0022 C0F82C31 		str	r3, [r0, #300]
 843:Core/Src/hall_detection.c **** }
 1870              		.loc 1 843 1 view .LVU547
 1871 0026 7047     		bx	lr
 1872              		.cfi_endproc
 1873              	.LFE255:
 1875              		.section	.text.validation,"ax",%progbits
 1876              		.align	1
 1877              		.global	validation
 1878              		.syntax unified
 1879              		.thumb
 1880              		.thumb_func
 1881              		.fpu fpv4-sp-d16
 1883              	validation:
 1884              	.LVL119:
 1885              	.LFB241:
 315:Core/Src/hall_detection.c **** 	//timeout or 	//reached results buffer full capacity
 1886              		.loc 1 315 80 is_stmt 1 view -0
 1887              		.cfi_startproc
 1888              		@ args = 0, pretend = 0, frame = 0
ARM GAS  /tmp/ccsur3Tq.s 			page 52


 1889              		@ frame_needed = 0, uses_anonymous_args = 0
 315:Core/Src/hall_detection.c **** 	//timeout or 	//reached results buffer full capacity
 1890              		.loc 1 315 80 is_stmt 0 view .LVU549
 1891 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 1892              	.LCFI29:
 1893              		.cfi_def_cfa_offset 24
 1894              		.cfi_offset 3, -24
 1895              		.cfi_offset 4, -20
 1896              		.cfi_offset 5, -16
 1897              		.cfi_offset 6, -12
 1898              		.cfi_offset 7, -8
 1899              		.cfi_offset 14, -4
 317:Core/Src/hall_detection.c **** 		*state=detection_ERROR_OR_TIMEOUT;
 1900              		.loc 1 317 2 is_stmt 1 view .LVU550
 317:Core/Src/hall_detection.c **** 		*state=detection_ERROR_OR_TIMEOUT;
 1901              		.loc 1 317 11 is_stmt 0 view .LVU551
 1902 0002 534B     		ldr	r3, .L150
 1903 0004 1A68     		ldr	r2, [r3]
 317:Core/Src/hall_detection.c **** 		*state=detection_ERROR_OR_TIMEOUT;
 1904              		.loc 1 317 4 view .LVU552
 1905 0006 534B     		ldr	r3, .L150+4
 1906 0008 9A42     		cmp	r2, r3
 1907 000a 06D8     		bhi	.L122
 317:Core/Src/hall_detection.c **** 		*state=detection_ERROR_OR_TIMEOUT;
 1908              		.loc 1 317 27 discriminator 1 view .LVU553
 1909 000c D1F85861 		ldr	r6, [r1, #344]
 317:Core/Src/hall_detection.c **** 		*state=detection_ERROR_OR_TIMEOUT;
 1910              		.loc 1 317 21 discriminator 1 view .LVU554
 1911 0010 062E     		cmp	r6, #6
 1912 0012 02D8     		bhi	.L122
 1913              	.LBB12:
 323:Core/Src/hall_detection.c **** 		if(gen->results[gen->numberOfresults-1].hall_order[i]==hall_A){
 1914              		.loc 1 323 16 view .LVU555
 1915 0014 0022     		movs	r2, #0
 1916              	.LBE12:
 322:Core/Src/hall_detection.c **** 	for (uint32_t i = 0;  i < NUMBEROFPHASES; ++ i) {
 1917              		.loc 1 322 11 view .LVU556
 1918 0016 1446     		mov	r4, r2
 1919 0018 07E0     		b	.L123
 1920              	.L122:
 318:Core/Src/hall_detection.c **** 		return;
 1921              		.loc 1 318 3 is_stmt 1 view .LVU557
 318:Core/Src/hall_detection.c **** 		return;
 1922              		.loc 1 318 9 is_stmt 0 view .LVU558
 1923 001a 0723     		movs	r3, #7
 1924 001c 0370     		strb	r3, [r0]
 319:Core/Src/hall_detection.c **** 	}
 1925              		.loc 1 319 3 is_stmt 1 view .LVU559
 1926              	.LVL120:
 1927              	.L121:
 377:Core/Src/hall_detection.c **** 
 1928              		.loc 1 377 1 is_stmt 0 view .LVU560
 1929 001e F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 1930              	.LVL121:
 1931              	.L125:
 1932              	.LBB13:
 326:Core/Src/hall_detection.c **** 			all_phases_not_repeated|=(1<<hall_B);
ARM GAS  /tmp/ccsur3Tq.s 			page 53


 1933              		.loc 1 326 9 is_stmt 1 view .LVU561
 326:Core/Src/hall_detection.c **** 			all_phases_not_repeated|=(1<<hall_B);
 1934              		.loc 1 326 11 is_stmt 0 view .LVU562
 1935 0020 012B     		cmp	r3, #1
 1936 0022 0FD0     		beq	.L145
 328:Core/Src/hall_detection.c **** 			all_phases_not_repeated|=(1<<hall_C);
 1937              		.loc 1 328 9 is_stmt 1 view .LVU563
 328:Core/Src/hall_detection.c **** 			all_phases_not_repeated|=(1<<hall_C);
 1938              		.loc 1 328 11 is_stmt 0 view .LVU564
 1939 0024 022B     		cmp	r3, #2
 1940 0026 10D0     		beq	.L146
 1941              	.L126:
 323:Core/Src/hall_detection.c **** 		if(gen->results[gen->numberOfresults-1].hall_order[i]==hall_A){
 1942              		.loc 1 323 44 discriminator 2 view .LVU565
 1943 0028 0132     		adds	r2, r2, #1
 1944              	.LVL122:
 1945              	.L123:
 323:Core/Src/hall_detection.c **** 		if(gen->results[gen->numberOfresults-1].hall_order[i]==hall_A){
 1946              		.loc 1 323 2 discriminator 1 view .LVU566
 1947 002a 022A     		cmp	r2, #2
 1948 002c 10D8     		bhi	.L147
 324:Core/Src/hall_detection.c **** 			all_phases_not_repeated|=(1<<hall_A);
 1949              		.loc 1 324 3 is_stmt 1 view .LVU567
 324:Core/Src/hall_detection.c **** 			all_phases_not_repeated|=(1<<hall_A);
 1950              		.loc 1 324 39 is_stmt 0 view .LVU568
 1951 002e 731E     		subs	r3, r6, #1
 324:Core/Src/hall_detection.c **** 			all_phases_not_repeated|=(1<<hall_A);
 1952              		.loc 1 324 53 view .LVU569
 1953 0030 01EB0313 		add	r3, r1, r3, lsl #4
 1954 0034 1344     		add	r3, r3, r2
 1955 0036 93F86831 		ldrb	r3, [r3, #360]	@ zero_extendqisi2
 324:Core/Src/hall_detection.c **** 			all_phases_not_repeated|=(1<<hall_A);
 1956              		.loc 1 324 5 view .LVU570
 1957 003a 002B     		cmp	r3, #0
 1958 003c F0D1     		bne	.L125
 325:Core/Src/hall_detection.c **** 		}else if(gen->results[gen->numberOfresults-1].hall_order[i]==hall_B){
 1959              		.loc 1 325 4 is_stmt 1 view .LVU571
 325:Core/Src/hall_detection.c **** 		}else if(gen->results[gen->numberOfresults-1].hall_order[i]==hall_B){
 1960              		.loc 1 325 27 is_stmt 0 view .LVU572
 1961 003e 44F00104 		orr	r4, r4, #1
 1962              	.LVL123:
 325:Core/Src/hall_detection.c **** 		}else if(gen->results[gen->numberOfresults-1].hall_order[i]==hall_B){
 1963              		.loc 1 325 27 view .LVU573
 1964 0042 F1E7     		b	.L126
 1965              	.L145:
 327:Core/Src/hall_detection.c **** 		}else if(gen->results[gen->numberOfresults-1].hall_order[i]==hall_C){
 1966              		.loc 1 327 4 is_stmt 1 view .LVU574
 327:Core/Src/hall_detection.c **** 		}else if(gen->results[gen->numberOfresults-1].hall_order[i]==hall_C){
 1967              		.loc 1 327 27 is_stmt 0 view .LVU575
 1968 0044 44F00204 		orr	r4, r4, #2
 1969              	.LVL124:
 327:Core/Src/hall_detection.c **** 		}else if(gen->results[gen->numberOfresults-1].hall_order[i]==hall_C){
 1970              		.loc 1 327 27 view .LVU576
 1971 0048 EEE7     		b	.L126
 1972              	.L146:
 329:Core/Src/hall_detection.c **** 		}
 1973              		.loc 1 329 4 is_stmt 1 view .LVU577
ARM GAS  /tmp/ccsur3Tq.s 			page 54


 329:Core/Src/hall_detection.c **** 		}
 1974              		.loc 1 329 27 is_stmt 0 view .LVU578
 1975 004a 44F00404 		orr	r4, r4, #4
 1976              	.LVL125:
 329:Core/Src/hall_detection.c **** 		}
 1977              		.loc 1 329 27 view .LVU579
 1978 004e EBE7     		b	.L126
 1979              	.L147:
 329:Core/Src/hall_detection.c **** 		}
 1980              		.loc 1 329 27 view .LVU580
 1981              	.LBE13:
 333:Core/Src/hall_detection.c **** 		gen->results[gen->numberOfresults-1].is_valid=YES;
 1982              		.loc 1 333 2 is_stmt 1 view .LVU581
 333:Core/Src/hall_detection.c **** 		gen->results[gen->numberOfresults-1].is_valid=YES;
 1983              		.loc 1 333 4 is_stmt 0 view .LVU582
 1984 0050 072C     		cmp	r4, #7
 1985 0052 07D0     		beq	.L148
 336:Core/Src/hall_detection.c **** 	}
 1986              		.loc 1 336 3 is_stmt 1 view .LVU583
 336:Core/Src/hall_detection.c **** 	}
 1987              		.loc 1 336 48 is_stmt 0 view .LVU584
 1988 0054 06F11503 		add	r3, r6, #21
 1989 0058 1B01     		lsls	r3, r3, #4
 1990 005a 0022     		movs	r2, #0
 1991              	.LVL126:
 336:Core/Src/hall_detection.c **** 	}
 1992              		.loc 1 336 48 view .LVU585
 1993 005c CA54     		strb	r2, [r1, r3]
 1994              	.L130:
 339:Core/Src/hall_detection.c **** 	for (uint32_t i = 0;  i < TOTAL_NUMBEROFRESULTS; ++ i) {
 1995              		.loc 1 339 2 is_stmt 1 view .LVU586
 1996              	.LVL127:
 340:Core/Src/hall_detection.c **** 		if(gen->results[i].is_valid==YES){
 1997              		.loc 1 340 2 view .LVU587
 1998              	.LBB14:
 340:Core/Src/hall_detection.c **** 		if(gen->results[i].is_valid==YES){
 1999              		.loc 1 340 7 view .LVU588
 340:Core/Src/hall_detection.c **** 		if(gen->results[i].is_valid==YES){
 2000              		.loc 1 340 16 is_stmt 0 view .LVU589
 2001 005e 0023     		movs	r3, #0
 2002              	.LBE14:
 339:Core/Src/hall_detection.c **** 	for (uint32_t i = 0;  i < TOTAL_NUMBEROFRESULTS; ++ i) {
 2003              		.loc 1 339 11 view .LVU590
 2004 0060 1C46     		mov	r4, r3
 2005              	.LVL128:
 2006              	.LBB15:
 340:Core/Src/hall_detection.c **** 		if(gen->results[i].is_valid==YES){
 2007              		.loc 1 340 2 view .LVU591
 2008 0062 06E0     		b	.L131
 2009              	.LVL129:
 2010              	.L148:
 340:Core/Src/hall_detection.c **** 		if(gen->results[i].is_valid==YES){
 2011              		.loc 1 340 2 view .LVU592
 2012              	.LBE15:
 334:Core/Src/hall_detection.c **** 	}else{
 2013              		.loc 1 334 3 is_stmt 1 view .LVU593
 334:Core/Src/hall_detection.c **** 	}else{
ARM GAS  /tmp/ccsur3Tq.s 			page 55


 2014              		.loc 1 334 48 is_stmt 0 view .LVU594
 2015 0064 06F11503 		add	r3, r6, #21
 2016 0068 1B01     		lsls	r3, r3, #4
 2017 006a 0122     		movs	r2, #1
 2018              	.LVL130:
 334:Core/Src/hall_detection.c **** 	}else{
 2019              		.loc 1 334 48 view .LVU595
 2020 006c CA54     		strb	r2, [r1, r3]
 2021 006e F6E7     		b	.L130
 2022              	.LVL131:
 2023              	.L132:
 2024              	.LBB16:
 340:Core/Src/hall_detection.c **** 		if(gen->results[i].is_valid==YES){
 2025              		.loc 1 340 51 discriminator 2 view .LVU596
 2026 0070 0133     		adds	r3, r3, #1
 2027              	.LVL132:
 2028              	.L131:
 340:Core/Src/hall_detection.c **** 		if(gen->results[i].is_valid==YES){
 2029              		.loc 1 340 2 discriminator 1 view .LVU597
 2030 0072 052B     		cmp	r3, #5
 2031 0074 07D8     		bhi	.L149
 341:Core/Src/hall_detection.c **** 			numberofvalid++;
 2032              		.loc 1 341 3 is_stmt 1 view .LVU598
 341:Core/Src/hall_detection.c **** 			numberofvalid++;
 2033              		.loc 1 341 21 is_stmt 0 view .LVU599
 2034 0076 03F11602 		add	r2, r3, #22
 2035 007a 1201     		lsls	r2, r2, #4
 2036 007c 8A5C     		ldrb	r2, [r1, r2]	@ zero_extendqisi2
 341:Core/Src/hall_detection.c **** 			numberofvalid++;
 2037              		.loc 1 341 5 view .LVU600
 2038 007e 012A     		cmp	r2, #1
 2039 0080 F6D1     		bne	.L132
 342:Core/Src/hall_detection.c **** 		}
 2040              		.loc 1 342 4 is_stmt 1 view .LVU601
 342:Core/Src/hall_detection.c **** 		}
 2041              		.loc 1 342 17 is_stmt 0 view .LVU602
 2042 0082 0134     		adds	r4, r4, #1
 2043              	.LVL133:
 342:Core/Src/hall_detection.c **** 		}
 2044              		.loc 1 342 17 view .LVU603
 2045 0084 F4E7     		b	.L132
 2046              	.L149:
 342:Core/Src/hall_detection.c **** 		}
 2047              		.loc 1 342 17 view .LVU604
 2048              	.LBE16:
 346:Core/Src/hall_detection.c **** 		for (uint32_t i = 0; i < gen->numberOfresults; ++i) {			//loop trough results
 2049              		.loc 1 346 2 is_stmt 1 view .LVU605
 346:Core/Src/hall_detection.c **** 		for (uint32_t i = 0; i < gen->numberOfresults; ++i) {			//loop trough results
 2050              		.loc 1 346 4 is_stmt 0 view .LVU606
 2051 0086 022C     		cmp	r4, #2
 2052 0088 54D9     		bls	.L135
 2053              	.LBB17:
 347:Core/Src/hall_detection.c **** 			if(gen->results[i].is_valid==YES){	//skip the not valid results.
 2054              		.loc 1 347 17 view .LVU607
 2055 008a 0022     		movs	r2, #0
 2056 008c 47E0     		b	.L134
 2057              	.LVL134:
ARM GAS  /tmp/ccsur3Tq.s 			page 56


 2058              	.L138:
 2059              	.LBB18:
 2060              	.LBB19:
 350:Core/Src/hall_detection.c **** 					if(
 2061              		.loc 1 350 52 discriminator 2 view .LVU608
 2062 008e 0133     		adds	r3, r3, #1
 2063              	.LVL135:
 2064              	.L136:
 350:Core/Src/hall_detection.c **** 					if(
 2065              		.loc 1 350 5 discriminator 1 view .LVU609
 2066 0090 9E42     		cmp	r6, r3
 2067 0092 43D9     		bls	.L137
 351:Core/Src/hall_detection.c **** 							gen->results[i].hall_order[0]==gen->results[j].hall_order[0] &&
 2068              		.loc 1 351 6 is_stmt 1 view .LVU610
 352:Core/Src/hall_detection.c **** 							gen->results[i].hall_order[1]==gen->results[j].hall_order[1] &&
 2069              		.loc 1 352 34 is_stmt 0 view .LVU611
 2070 0094 01EB0214 		add	r4, r1, r2, lsl #4
 2071 0098 94F86851 		ldrb	r5, [r4, #360]	@ zero_extendqisi2
 352:Core/Src/hall_detection.c **** 							gen->results[i].hall_order[1]==gen->results[j].hall_order[1] &&
 2072              		.loc 1 352 65 view .LVU612
 2073 009c 01EB0314 		add	r4, r1, r3, lsl #4
 2074 00a0 94F86841 		ldrb	r4, [r4, #360]	@ zero_extendqisi2
 351:Core/Src/hall_detection.c **** 							gen->results[i].hall_order[0]==gen->results[j].hall_order[0] &&
 2075              		.loc 1 351 8 view .LVU613
 2076 00a4 A542     		cmp	r5, r4
 2077 00a6 F2D1     		bne	.L138
 353:Core/Src/hall_detection.c **** 							gen->results[i].hall_order[2]==gen->results[j].hall_order[2] &&
 2078              		.loc 1 353 34 view .LVU614
 2079 00a8 01EB0214 		add	r4, r1, r2, lsl #4
 2080 00ac 94F86951 		ldrb	r5, [r4, #361]	@ zero_extendqisi2
 353:Core/Src/hall_detection.c **** 							gen->results[i].hall_order[2]==gen->results[j].hall_order[2] &&
 2081              		.loc 1 353 65 view .LVU615
 2082 00b0 01EB0314 		add	r4, r1, r3, lsl #4
 2083 00b4 94F86941 		ldrb	r4, [r4, #361]	@ zero_extendqisi2
 352:Core/Src/hall_detection.c **** 							gen->results[i].hall_order[1]==gen->results[j].hall_order[1] &&
 2084              		.loc 1 352 69 view .LVU616
 2085 00b8 A542     		cmp	r5, r4
 2086 00ba E8D1     		bne	.L138
 354:Core/Src/hall_detection.c **** 							gen->results[i].hall_polarity[0]==gen->results[j].hall_polarity[0] &&
 2087              		.loc 1 354 34 view .LVU617
 2088 00bc 01EB0214 		add	r4, r1, r2, lsl #4
 2089 00c0 94F86A51 		ldrb	r5, [r4, #362]	@ zero_extendqisi2
 354:Core/Src/hall_detection.c **** 							gen->results[i].hall_polarity[0]==gen->results[j].hall_polarity[0] &&
 2090              		.loc 1 354 65 view .LVU618
 2091 00c4 01EB0314 		add	r4, r1, r3, lsl #4
 2092 00c8 94F86A41 		ldrb	r4, [r4, #362]	@ zero_extendqisi2
 353:Core/Src/hall_detection.c **** 							gen->results[i].hall_order[2]==gen->results[j].hall_order[2] &&
 2093              		.loc 1 353 69 view .LVU619
 2094 00cc A542     		cmp	r5, r4
 2095 00ce DED1     		bne	.L138
 355:Core/Src/hall_detection.c **** 							gen->results[i].hall_polarity[1]==gen->results[j].hall_polarity[1] &&
 2096              		.loc 1 355 37 view .LVU620
 2097 00d0 01EB0214 		add	r4, r1, r2, lsl #4
 2098 00d4 94F86B51 		ldrb	r5, [r4, #363]	@ zero_extendqisi2
 355:Core/Src/hall_detection.c **** 							gen->results[i].hall_polarity[1]==gen->results[j].hall_polarity[1] &&
 2099              		.loc 1 355 71 view .LVU621
 2100 00d8 01EB0314 		add	r4, r1, r3, lsl #4
ARM GAS  /tmp/ccsur3Tq.s 			page 57


 2101 00dc 94F86B41 		ldrb	r4, [r4, #363]	@ zero_extendqisi2
 354:Core/Src/hall_detection.c **** 							gen->results[i].hall_polarity[0]==gen->results[j].hall_polarity[0] &&
 2102              		.loc 1 354 69 view .LVU622
 2103 00e0 A542     		cmp	r5, r4
 2104 00e2 D4D1     		bne	.L138
 356:Core/Src/hall_detection.c **** 							gen->results[i].hall_polarity[2]==gen->results[j].hall_polarity[2]
 2105              		.loc 1 356 37 view .LVU623
 2106 00e4 01EB0214 		add	r4, r1, r2, lsl #4
 2107 00e8 94F86C51 		ldrb	r5, [r4, #364]	@ zero_extendqisi2
 356:Core/Src/hall_detection.c **** 							gen->results[i].hall_polarity[2]==gen->results[j].hall_polarity[2]
 2108              		.loc 1 356 71 view .LVU624
 2109 00ec 01EB0314 		add	r4, r1, r3, lsl #4
 2110 00f0 94F86C41 		ldrb	r4, [r4, #364]	@ zero_extendqisi2
 355:Core/Src/hall_detection.c **** 							gen->results[i].hall_polarity[1]==gen->results[j].hall_polarity[1] &&
 2111              		.loc 1 355 75 view .LVU625
 2112 00f4 A542     		cmp	r5, r4
 2113 00f6 CAD1     		bne	.L138
 357:Core/Src/hall_detection.c **** 							){//do they match?
 2114              		.loc 1 357 37 view .LVU626
 2115 00f8 01EB0214 		add	r4, r1, r2, lsl #4
 2116 00fc 94F86D51 		ldrb	r5, [r4, #365]	@ zero_extendqisi2
 357:Core/Src/hall_detection.c **** 							){//do they match?
 2117              		.loc 1 357 71 view .LVU627
 2118 0100 01EB0314 		add	r4, r1, r3, lsl #4
 2119 0104 94F86D41 		ldrb	r4, [r4, #365]	@ zero_extendqisi2
 356:Core/Src/hall_detection.c **** 							gen->results[i].hall_polarity[2]==gen->results[j].hall_polarity[2]
 2120              		.loc 1 356 75 view .LVU628
 2121 0108 A542     		cmp	r5, r4
 2122 010a C0D1     		bne	.L138
 359:Core/Src/hall_detection.c **** 						if(number_of_results_matching>=NUMBER_OF_VALID_MATCHING_RESULTS){
 2123              		.loc 1 359 8 is_stmt 1 view .LVU629
 359:Core/Src/hall_detection.c **** 						if(number_of_results_matching>=NUMBER_OF_VALID_MATCHING_RESULTS){
 2124              		.loc 1 359 34 is_stmt 0 view .LVU630
 2125 010c 0137     		adds	r7, r7, #1
 2126              	.LVL136:
 360:Core/Src/hall_detection.c **** 							gen->indexOfcorrectResult=i;
 2127              		.loc 1 360 7 is_stmt 1 view .LVU631
 360:Core/Src/hall_detection.c **** 							gen->indexOfcorrectResult=i;
 2128              		.loc 1 360 9 is_stmt 0 view .LVU632
 2129 010e 022F     		cmp	r7, #2
 2130 0110 BDD9     		bls	.L138
 361:Core/Src/hall_detection.c **** 							*state=detection_PRESENTATION_FINISH;
 2131              		.loc 1 361 8 is_stmt 1 view .LVU633
 361:Core/Src/hall_detection.c **** 							*state=detection_PRESENTATION_FINISH;
 2132              		.loc 1 361 33 is_stmt 0 view .LVU634
 2133 0112 C1F85C21 		str	r2, [r1, #348]
 362:Core/Src/hall_detection.c **** 							return;
 2134              		.loc 1 362 8 is_stmt 1 view .LVU635
 362:Core/Src/hall_detection.c **** 							return;
 2135              		.loc 1 362 14 is_stmt 0 view .LVU636
 2136 0116 0623     		movs	r3, #6
 2137              	.LVL137:
 362:Core/Src/hall_detection.c **** 							return;
 2138              		.loc 1 362 14 view .LVU637
 2139 0118 0370     		strb	r3, [r0]
 363:Core/Src/hall_detection.c **** 						}
 2140              		.loc 1 363 8 is_stmt 1 view .LVU638
ARM GAS  /tmp/ccsur3Tq.s 			page 58


 2141 011a 80E7     		b	.L121
 2142              	.LVL138:
 2143              	.L137:
 363:Core/Src/hall_detection.c **** 						}
 2144              		.loc 1 363 8 is_stmt 0 view .LVU639
 2145              	.LBE19:
 2146              	.LBE18:
 347:Core/Src/hall_detection.c **** 			if(gen->results[i].is_valid==YES){	//skip the not valid results.
 2147              		.loc 1 347 50 discriminator 2 view .LVU640
 2148 011c 0132     		adds	r2, r2, #1
 2149              	.LVL139:
 2150              	.L134:
 347:Core/Src/hall_detection.c **** 			if(gen->results[i].is_valid==YES){	//skip the not valid results.
 2151              		.loc 1 347 3 discriminator 1 view .LVU641
 2152 011e 9642     		cmp	r6, r2
 2153 0120 08D9     		bls	.L135
 348:Core/Src/hall_detection.c **** 				uint32_t number_of_results_matching=0;
 2154              		.loc 1 348 4 is_stmt 1 view .LVU642
 348:Core/Src/hall_detection.c **** 				uint32_t number_of_results_matching=0;
 2155              		.loc 1 348 22 is_stmt 0 view .LVU643
 2156 0122 02F11603 		add	r3, r2, #22
 2157 0126 1B01     		lsls	r3, r3, #4
 2158 0128 CB5C     		ldrb	r3, [r1, r3]	@ zero_extendqisi2
 348:Core/Src/hall_detection.c **** 				uint32_t number_of_results_matching=0;
 2159              		.loc 1 348 6 view .LVU644
 2160 012a 012B     		cmp	r3, #1
 2161 012c F6D1     		bne	.L137
 2162              	.LBB21:
 2163              	.LBB20:
 350:Core/Src/hall_detection.c **** 					if(
 2164              		.loc 1 350 19 view .LVU645
 2165 012e 0023     		movs	r3, #0
 2166              	.LBE20:
 349:Core/Src/hall_detection.c **** 				for (uint32_t j = 0; j < gen->numberOfresults; ++j) {	//compare that one result with the rest
 2167              		.loc 1 349 14 view .LVU646
 2168 0130 1F46     		mov	r7, r3
 2169 0132 ADE7     		b	.L136
 2170              	.LVL140:
 2171              	.L135:
 349:Core/Src/hall_detection.c **** 				for (uint32_t j = 0; j < gen->numberOfresults; ++j) {	//compare that one result with the rest
 2172              		.loc 1 349 14 view .LVU647
 2173 0134 0C46     		mov	r4, r1
 2174 0136 0546     		mov	r5, r0
 2175              	.LBE21:
 2176              	.LBE17:
 372:Core/Src/hall_detection.c **** 	resetVariables_diferences(gen);
 2177              		.loc 1 372 2 is_stmt 1 view .LVU648
 2178 0138 0846     		mov	r0, r1
 2179              	.LVL141:
 372:Core/Src/hall_detection.c **** 	resetVariables_diferences(gen);
 2180              		.loc 1 372 2 is_stmt 0 view .LVU649
 2181 013a FFF7FEFF 		bl	resetVariables_adquisition
 2182              	.LVL142:
 373:Core/Src/hall_detection.c **** 	gen->start_adquisition_ticks=ticks;
 2183              		.loc 1 373 2 is_stmt 1 view .LVU650
 2184 013e 2046     		mov	r0, r4
 2185 0140 FFF7FEFF 		bl	resetVariables_diferences
ARM GAS  /tmp/ccsur3Tq.s 			page 59


 2186              	.LVL143:
 374:Core/Src/hall_detection.c **** 	*state=detection_ADQUISITION;
 2187              		.loc 1 374 2 view .LVU651
 374:Core/Src/hall_detection.c **** 	*state=detection_ADQUISITION;
 2188              		.loc 1 374 30 is_stmt 0 view .LVU652
 2189 0144 024B     		ldr	r3, .L150
 2190 0146 1B68     		ldr	r3, [r3]
 2191 0148 2360     		str	r3, [r4]
 375:Core/Src/hall_detection.c **** 	return;
 2192              		.loc 1 375 2 is_stmt 1 view .LVU653
 375:Core/Src/hall_detection.c **** 	return;
 2193              		.loc 1 375 8 is_stmt 0 view .LVU654
 2194 014a 0323     		movs	r3, #3
 2195 014c 2B70     		strb	r3, [r5]
 376:Core/Src/hall_detection.c **** }
 2196              		.loc 1 376 2 is_stmt 1 view .LVU655
 2197 014e 66E7     		b	.L121
 2198              	.L151:
 2199              		.align	2
 2200              	.L150:
 2201 0150 00000000 		.word	ticks
 2202 0154 38900D00 		.word	888888
 2203              		.cfi_endproc
 2204              	.LFE241:
 2206              		.global	__aeabi_d2iz
 2207              		.section	.text.assign_closest_phase_to_hall,"ax",%progbits
 2208              		.align	1
 2209              		.global	assign_closest_phase_to_hall
 2210              		.syntax unified
 2211              		.thumb
 2212              		.thumb_func
 2213              		.fpu fpv4-sp-d16
 2215              	assign_closest_phase_to_hall:
 2216              	.LVL144:
 2217              	.LFB252:
 692:Core/Src/hall_detection.c **** 
 2218              		.loc 1 692 70 view -0
 2219              		.cfi_startproc
 2220              		@ args = 0, pretend = 0, frame = 16
 2221              		@ frame_needed = 0, uses_anonymous_args = 0
 692:Core/Src/hall_detection.c **** 
 2222              		.loc 1 692 70 is_stmt 0 view .LVU657
 2223 0000 2DE9F043 		push	{r4, r5, r6, r7, r8, r9, lr}
 2224              	.LCFI30:
 2225              		.cfi_def_cfa_offset 28
 2226              		.cfi_offset 4, -28
 2227              		.cfi_offset 5, -24
 2228              		.cfi_offset 6, -20
 2229              		.cfi_offset 7, -16
 2230              		.cfi_offset 8, -12
 2231              		.cfi_offset 9, -8
 2232              		.cfi_offset 14, -4
 2233 0004 85B0     		sub	sp, sp, #20
 2234              	.LCFI31:
 2235              		.cfi_def_cfa_offset 48
 2236 0006 0446     		mov	r4, r0
 694:Core/Src/hall_detection.c **** 
ARM GAS  /tmp/ccsur3Tq.s 			page 60


 2237              		.loc 1 694 2 is_stmt 1 view .LVU658
 2238 0008 FFF7FEFF 		bl	resetVariables_diferences
 2239              	.LVL145:
 696:Core/Src/hall_detection.c **** 		gen->differences_phaseA[phase_A]+=absolute((int32_t)gen->currA.zerocrossings_tick[i]-(int32_t)gen
 2240              		.loc 1 696 2 view .LVU659
 2241              	.LBB22:
 696:Core/Src/hall_detection.c **** 		gen->differences_phaseA[phase_A]+=absolute((int32_t)gen->currA.zerocrossings_tick[i]-(int32_t)gen
 2242              		.loc 1 696 7 view .LVU660
 696:Core/Src/hall_detection.c **** 		gen->differences_phaseA[phase_A]+=absolute((int32_t)gen->currA.zerocrossings_tick[i]-(int32_t)gen
 2243              		.loc 1 696 16 is_stmt 0 view .LVU661
 2244 000c 0025     		movs	r5, #0
 2245              	.LVL146:
 2246              	.L153:
 696:Core/Src/hall_detection.c **** 		gen->differences_phaseA[phase_A]+=absolute((int32_t)gen->currA.zerocrossings_tick[i]-(int32_t)gen
 2247              		.loc 1 696 2 discriminator 1 view .LVU662
 2248 000e 052D     		cmp	r5, #5
 2249 0010 6AD8     		bhi	.L172
 697:Core/Src/hall_detection.c **** 		gen->differences_phaseA[phase_B]+=absolute((int32_t)gen->currA.zerocrossings_tick[i]-(int32_t)gen
 2250              		.loc 1 697 3 is_stmt 1 discriminator 3 view .LVU663
 697:Core/Src/hall_detection.c **** 		gen->differences_phaseA[phase_B]+=absolute((int32_t)gen->currA.zerocrossings_tick[i]-(int32_t)gen
 2251              		.loc 1 697 84 is_stmt 0 discriminator 3 view .LVU664
 2252 0012 AB1C     		adds	r3, r5, #2
 2253 0014 04EB8303 		add	r3, r4, r3, lsl #2
 2254 0018 5F68     		ldr	r7, [r3, #4]
 697:Core/Src/hall_detection.c **** 		gen->differences_phaseA[phase_B]+=absolute((int32_t)gen->currA.zerocrossings_tick[i]-(int32_t)gen
 2255              		.loc 1 697 126 discriminator 3 view .LVU665
 2256 001a 05F12403 		add	r3, r5, #36
 2257 001e 54F82390 		ldr	r9, [r4, r3, lsl #2]
 697:Core/Src/hall_detection.c **** 		gen->differences_phaseA[phase_B]+=absolute((int32_t)gen->currA.zerocrossings_tick[i]-(int32_t)gen
 2258              		.loc 1 697 37 discriminator 3 view .LVU666
 2259 0022 A7EB0900 		sub	r0, r7, r9
 2260 0026 FFF7FEFF 		bl	absolute
 2261              	.LVL147:
 697:Core/Src/hall_detection.c **** 		gen->differences_phaseA[phase_B]+=absolute((int32_t)gen->currA.zerocrossings_tick[i]-(int32_t)gen
 2262              		.loc 1 697 35 discriminator 3 view .LVU667
 2263 002a D4F80C31 		ldr	r3, [r4, #268]
 2264 002e 1844     		add	r0, r0, r3
 2265 0030 C4F80C01 		str	r0, [r4, #268]
 698:Core/Src/hall_detection.c **** 		gen->differences_phaseA[phase_C]+=absolute((int32_t)gen->currA.zerocrossings_tick[i]-(int32_t)gen
 2266              		.loc 1 698 3 is_stmt 1 discriminator 3 view .LVU668
 698:Core/Src/hall_detection.c **** 		gen->differences_phaseA[phase_C]+=absolute((int32_t)gen->currA.zerocrossings_tick[i]-(int32_t)gen
 2267              		.loc 1 698 126 is_stmt 0 discriminator 3 view .LVU669
 2268 0034 05F12E03 		add	r3, r5, #46
 2269 0038 04EB8303 		add	r3, r4, r3, lsl #2
 2270 003c D3F80480 		ldr	r8, [r3, #4]
 698:Core/Src/hall_detection.c **** 		gen->differences_phaseA[phase_C]+=absolute((int32_t)gen->currA.zerocrossings_tick[i]-(int32_t)gen
 2271              		.loc 1 698 37 discriminator 3 view .LVU670
 2272 0040 A7EB0800 		sub	r0, r7, r8
 2273 0044 FFF7FEFF 		bl	absolute
 2274              	.LVL148:
 698:Core/Src/hall_detection.c **** 		gen->differences_phaseA[phase_C]+=absolute((int32_t)gen->currA.zerocrossings_tick[i]-(int32_t)gen
 2275              		.loc 1 698 35 discriminator 3 view .LVU671
 2276 0048 D4F81031 		ldr	r3, [r4, #272]
 2277 004c 1844     		add	r0, r0, r3
 2278 004e C4F81001 		str	r0, [r4, #272]
 699:Core/Src/hall_detection.c **** 
 2279              		.loc 1 699 3 is_stmt 1 discriminator 3 view .LVU672
ARM GAS  /tmp/ccsur3Tq.s 			page 61


 699:Core/Src/hall_detection.c **** 
 2280              		.loc 1 699 126 is_stmt 0 discriminator 3 view .LVU673
 2281 0052 05F13A03 		add	r3, r5, #58
 2282 0056 54F82360 		ldr	r6, [r4, r3, lsl #2]
 699:Core/Src/hall_detection.c **** 
 2283              		.loc 1 699 37 discriminator 3 view .LVU674
 2284 005a B81B     		subs	r0, r7, r6
 2285 005c FFF7FEFF 		bl	absolute
 2286              	.LVL149:
 699:Core/Src/hall_detection.c **** 
 2287              		.loc 1 699 35 discriminator 3 view .LVU675
 2288 0060 D4F81431 		ldr	r3, [r4, #276]
 2289 0064 1844     		add	r0, r0, r3
 2290 0066 C4F81401 		str	r0, [r4, #276]
 701:Core/Src/hall_detection.c **** 		gen->differences_phaseB[phase_B]+=absolute((int32_t)gen->currB.zerocrossings_tick[i]-(int32_t)gen
 2291              		.loc 1 701 3 is_stmt 1 discriminator 3 view .LVU676
 701:Core/Src/hall_detection.c **** 		gen->differences_phaseB[phase_B]+=absolute((int32_t)gen->currB.zerocrossings_tick[i]-(int32_t)gen
 2292              		.loc 1 701 84 is_stmt 0 discriminator 3 view .LVU677
 2293 006a 05F10E03 		add	r3, r5, #14
 2294 006e 54F82370 		ldr	r7, [r4, r3, lsl #2]
 701:Core/Src/hall_detection.c **** 		gen->differences_phaseB[phase_B]+=absolute((int32_t)gen->currB.zerocrossings_tick[i]-(int32_t)gen
 2295              		.loc 1 701 37 discriminator 3 view .LVU678
 2296 0072 A7EB0900 		sub	r0, r7, r9
 2297 0076 FFF7FEFF 		bl	absolute
 2298              	.LVL150:
 701:Core/Src/hall_detection.c **** 		gen->differences_phaseB[phase_B]+=absolute((int32_t)gen->currB.zerocrossings_tick[i]-(int32_t)gen
 2299              		.loc 1 701 35 discriminator 3 view .LVU679
 2300 007a D4F81831 		ldr	r3, [r4, #280]
 2301 007e 1844     		add	r0, r0, r3
 2302 0080 C4F81801 		str	r0, [r4, #280]
 702:Core/Src/hall_detection.c **** 		gen->differences_phaseB[phase_C]+=absolute((int32_t)gen->currB.zerocrossings_tick[i]-(int32_t)gen
 2303              		.loc 1 702 3 is_stmt 1 discriminator 3 view .LVU680
 702:Core/Src/hall_detection.c **** 		gen->differences_phaseB[phase_C]+=absolute((int32_t)gen->currB.zerocrossings_tick[i]-(int32_t)gen
 2304              		.loc 1 702 37 is_stmt 0 discriminator 3 view .LVU681
 2305 0084 A7EB0800 		sub	r0, r7, r8
 2306 0088 FFF7FEFF 		bl	absolute
 2307              	.LVL151:
 702:Core/Src/hall_detection.c **** 		gen->differences_phaseB[phase_C]+=absolute((int32_t)gen->currB.zerocrossings_tick[i]-(int32_t)gen
 2308              		.loc 1 702 35 discriminator 3 view .LVU682
 2309 008c D4F81C31 		ldr	r3, [r4, #284]
 2310 0090 1844     		add	r0, r0, r3
 2311 0092 C4F81C01 		str	r0, [r4, #284]
 703:Core/Src/hall_detection.c **** 
 2312              		.loc 1 703 3 is_stmt 1 discriminator 3 view .LVU683
 703:Core/Src/hall_detection.c **** 
 2313              		.loc 1 703 37 is_stmt 0 discriminator 3 view .LVU684
 2314 0096 B81B     		subs	r0, r7, r6
 2315 0098 FFF7FEFF 		bl	absolute
 2316              	.LVL152:
 703:Core/Src/hall_detection.c **** 
 2317              		.loc 1 703 35 discriminator 3 view .LVU685
 2318 009c D4F82031 		ldr	r3, [r4, #288]
 2319 00a0 1844     		add	r0, r0, r3
 2320 00a2 C4F82001 		str	r0, [r4, #288]
 705:Core/Src/hall_detection.c **** 		gen->differences_phaseC[phase_B]+=absolute((int32_t)gen->currC.zerocrossings_tick[i]-(int32_t)gen
 2321              		.loc 1 705 3 is_stmt 1 discriminator 3 view .LVU686
 705:Core/Src/hall_detection.c **** 		gen->differences_phaseC[phase_B]+=absolute((int32_t)gen->currC.zerocrossings_tick[i]-(int32_t)gen
ARM GAS  /tmp/ccsur3Tq.s 			page 62


 2322              		.loc 1 705 84 is_stmt 0 discriminator 3 view .LVU687
 2323 00a6 05F11803 		add	r3, r5, #24
 2324 00aa 04EB8303 		add	r3, r4, r3, lsl #2
 2325 00ae 5F68     		ldr	r7, [r3, #4]
 705:Core/Src/hall_detection.c **** 		gen->differences_phaseC[phase_B]+=absolute((int32_t)gen->currC.zerocrossings_tick[i]-(int32_t)gen
 2326              		.loc 1 705 37 discriminator 3 view .LVU688
 2327 00b0 A7EB0900 		sub	r0, r7, r9
 2328 00b4 FFF7FEFF 		bl	absolute
 2329              	.LVL153:
 705:Core/Src/hall_detection.c **** 		gen->differences_phaseC[phase_B]+=absolute((int32_t)gen->currC.zerocrossings_tick[i]-(int32_t)gen
 2330              		.loc 1 705 35 discriminator 3 view .LVU689
 2331 00b8 D4F82431 		ldr	r3, [r4, #292]
 2332 00bc 1844     		add	r0, r0, r3
 2333 00be C4F82401 		str	r0, [r4, #292]
 706:Core/Src/hall_detection.c **** 		gen->differences_phaseC[phase_C]+=absolute((int32_t)gen->currC.zerocrossings_tick[i]-(int32_t)gen
 2334              		.loc 1 706 3 is_stmt 1 discriminator 3 view .LVU690
 706:Core/Src/hall_detection.c **** 		gen->differences_phaseC[phase_C]+=absolute((int32_t)gen->currC.zerocrossings_tick[i]-(int32_t)gen
 2335              		.loc 1 706 37 is_stmt 0 discriminator 3 view .LVU691
 2336 00c2 A7EB0800 		sub	r0, r7, r8
 2337 00c6 FFF7FEFF 		bl	absolute
 2338              	.LVL154:
 706:Core/Src/hall_detection.c **** 		gen->differences_phaseC[phase_C]+=absolute((int32_t)gen->currC.zerocrossings_tick[i]-(int32_t)gen
 2339              		.loc 1 706 35 discriminator 3 view .LVU692
 2340 00ca D4F82831 		ldr	r3, [r4, #296]
 2341 00ce 1844     		add	r0, r0, r3
 2342 00d0 C4F82801 		str	r0, [r4, #296]
 707:Core/Src/hall_detection.c **** 	}
 2343              		.loc 1 707 3 is_stmt 1 discriminator 3 view .LVU693
 707:Core/Src/hall_detection.c **** 	}
 2344              		.loc 1 707 37 is_stmt 0 discriminator 3 view .LVU694
 2345 00d4 B81B     		subs	r0, r7, r6
 2346 00d6 FFF7FEFF 		bl	absolute
 2347              	.LVL155:
 707:Core/Src/hall_detection.c **** 	}
 2348              		.loc 1 707 35 discriminator 3 view .LVU695
 2349 00da D4F82C31 		ldr	r3, [r4, #300]
 2350 00de 1844     		add	r0, r0, r3
 2351 00e0 C4F82C01 		str	r0, [r4, #300]
 696:Core/Src/hall_detection.c **** 		gen->differences_phaseA[phase_A]+=absolute((int32_t)gen->currA.zerocrossings_tick[i]-(int32_t)gen
 2352              		.loc 1 696 45 discriminator 3 view .LVU696
 2353 00e4 0135     		adds	r5, r5, #1
 2354              	.LVL156:
 696:Core/Src/hall_detection.c **** 		gen->differences_phaseA[phase_A]+=absolute((int32_t)gen->currA.zerocrossings_tick[i]-(int32_t)gen
 2355              		.loc 1 696 45 discriminator 3 view .LVU697
 2356 00e6 92E7     		b	.L153
 2357              	.L172:
 696:Core/Src/hall_detection.c **** 		gen->differences_phaseA[phase_A]+=absolute((int32_t)gen->currA.zerocrossings_tick[i]-(int32_t)gen
 2358              		.loc 1 696 45 discriminator 3 view .LVU698
 2359              	.LBE22:
 710:Core/Src/hall_detection.c **** 	int32_t _top_limit		=(int32_t)(gen->results[gen->numberOfresults].electricPeriod_ticks);
 2360              		.loc 1 710 2 is_stmt 1 view .LVU699
 710:Core/Src/hall_detection.c **** 	int32_t _top_limit		=(int32_t)(gen->results[gen->numberOfresults].electricPeriod_ticks);
 2361              		.loc 1 710 52 is_stmt 0 view .LVU700
 2362 00e8 D4F85831 		ldr	r3, [r4, #344]
 710:Core/Src/hall_detection.c **** 	int32_t _top_limit		=(int32_t)(gen->results[gen->numberOfresults].electricPeriod_ticks);
 2363              		.loc 1 710 70 view .LVU701
 2364 00ec 1633     		adds	r3, r3, #22
ARM GAS  /tmp/ccsur3Tq.s 			page 63


 2365 00ee 04EB0313 		add	r3, r4, r3, lsl #4
 2366 00f2 5F68     		ldr	r7, [r3, #4]
 710:Core/Src/hall_detection.c **** 	int32_t _top_limit		=(int32_t)(gen->results[gen->numberOfresults].electricPeriod_ticks);
 2367              		.loc 1 710 94 view .LVU702
 2368 00f4 7808     		lsrs	r0, r7, #1
 2369 00f6 FFF7FEFF 		bl	__aeabi_ui2d
 2370              	.LVL157:
 2371 00fa 6BA3     		adr	r3, .L177+8
 2372 00fc D3E90023 		ldrd	r2, [r3]
 2373 0100 FFF7FEFF 		bl	__aeabi_dmul
 2374              	.LVL158:
 710:Core/Src/hall_detection.c **** 	int32_t _top_limit		=(int32_t)(gen->results[gen->numberOfresults].electricPeriod_ticks);
 2375              		.loc 1 710 10 view .LVU703
 2376 0104 FFF7FEFF 		bl	__aeabi_d2iz
 2377              	.LVL159:
 2378 0108 0646     		mov	r6, r0
 2379              	.LVL160:
 711:Core/Src/hall_detection.c **** 	int32_t minimum[NUMBEROFPHASES]={0xFF,0xFF,0xFF};
 2380              		.loc 1 711 2 is_stmt 1 view .LVU704
 712:Core/Src/hall_detection.c **** 
 2381              		.loc 1 712 2 view .LVU705
 712:Core/Src/hall_detection.c **** 
 2382              		.loc 1 712 10 is_stmt 0 view .LVU706
 2383 010a 654B     		ldr	r3, .L177
 2384 010c 93E80700 		ldm	r3, {r0, r1, r2}
 2385              	.LVL161:
 712:Core/Src/hall_detection.c **** 
 2386              		.loc 1 712 10 view .LVU707
 2387 0110 04AB     		add	r3, sp, #16
 2388 0112 03E90700 		stmdb	r3, {r0, r1, r2}
 714:Core/Src/hall_detection.c **** 		gen->differences_phaseA[i]/=MAXZEROCROSSINGS;
 2389              		.loc 1 714 2 is_stmt 1 view .LVU708
 2390              	.LBB23:
 714:Core/Src/hall_detection.c **** 		gen->differences_phaseA[i]/=MAXZEROCROSSINGS;
 2391              		.loc 1 714 7 view .LVU709
 2392              	.LVL162:
 714:Core/Src/hall_detection.c **** 		gen->differences_phaseA[i]/=MAXZEROCROSSINGS;
 2393              		.loc 1 714 16 is_stmt 0 view .LVU710
 2394 0116 0023     		movs	r3, #0
 714:Core/Src/hall_detection.c **** 		gen->differences_phaseA[i]/=MAXZEROCROSSINGS;
 2395              		.loc 1 714 2 view .LVU711
 2396 0118 53E0     		b	.L155
 2397              	.LVL163:
 2398              	.L156:
 724:Core/Src/hall_detection.c **** 		}
 2399              		.loc 1 724 4 is_stmt 1 view .LVU712
 724:Core/Src/hall_detection.c **** 		}
 2400              		.loc 1 724 36 is_stmt 0 view .LVU713
 2401 011a 03F14C02 		add	r2, r3, #76
 2402 011e 0020     		movs	r0, #0
 2403 0120 44F82200 		str	r0, [r4, r2, lsl #2]
 2404              	.L157:
 727:Core/Src/hall_detection.c **** 			gen->differences_phaseB[i]%=_bottom_limit;
 2405              		.loc 1 727 3 is_stmt 1 view .LVU714
 727:Core/Src/hall_detection.c **** 			gen->differences_phaseB[i]%=_bottom_limit;
 2406              		.loc 1 727 5 is_stmt 0 view .LVU715
 2407 0124 B142     		cmp	r1, r6
ARM GAS  /tmp/ccsur3Tq.s 			page 64


 2408 0126 0FDD     		ble	.L158
 727:Core/Src/hall_detection.c **** 			gen->differences_phaseB[i]%=_bottom_limit;
 2409              		.loc 1 727 47 discriminator 1 view .LVU716
 2410 0128 B942     		cmp	r1, r7
 2411 012a 0DDA     		bge	.L158
 728:Core/Src/hall_detection.c **** 			gen->shifted_polarity[hall_B][i]=1;
 2412              		.loc 1 728 4 is_stmt 1 view .LVU717
 728:Core/Src/hall_detection.c **** 			gen->shifted_polarity[hall_B][i]=1;
 2413              		.loc 1 728 30 is_stmt 0 view .LVU718
 2414 012c 03F14600 		add	r0, r3, #70
 2415 0130 91FBF6F2 		sdiv	r2, r1, r6
 2416 0134 06FB1211 		mls	r1, r6, r2, r1
 2417 0138 44F82010 		str	r1, [r4, r0, lsl #2]
 729:Core/Src/hall_detection.c **** 		}else{
 2418              		.loc 1 729 4 is_stmt 1 view .LVU719
 729:Core/Src/hall_detection.c **** 		}else{
 2419              		.loc 1 729 36 is_stmt 0 view .LVU720
 2420 013c 03F14F02 		add	r2, r3, #79
 2421 0140 0121     		movs	r1, #1
 2422 0142 44F82210 		str	r1, [r4, r2, lsl #2]
 2423 0146 04E0     		b	.L159
 2424              	.L158:
 731:Core/Src/hall_detection.c **** 		}
 2425              		.loc 1 731 4 is_stmt 1 view .LVU721
 731:Core/Src/hall_detection.c **** 		}
 2426              		.loc 1 731 36 is_stmt 0 view .LVU722
 2427 0148 03F14F02 		add	r2, r3, #79
 2428 014c 0021     		movs	r1, #0
 2429 014e 44F82210 		str	r1, [r4, r2, lsl #2]
 2430              	.L159:
 734:Core/Src/hall_detection.c **** 			gen->differences_phaseC[i]%=_bottom_limit;
 2431              		.loc 1 734 3 is_stmt 1 view .LVU723
 734:Core/Src/hall_detection.c **** 			gen->differences_phaseC[i]%=_bottom_limit;
 2432              		.loc 1 734 29 is_stmt 0 view .LVU724
 2433 0152 03F14802 		add	r2, r3, #72
 2434 0156 04EB8202 		add	r2, r4, r2, lsl #2
 2435 015a 5268     		ldr	r2, [r2, #4]
 734:Core/Src/hall_detection.c **** 			gen->differences_phaseC[i]%=_bottom_limit;
 2436              		.loc 1 734 5 view .LVU725
 2437 015c B242     		cmp	r2, r6
 2438 015e 10DD     		ble	.L160
 734:Core/Src/hall_detection.c **** 			gen->differences_phaseC[i]%=_bottom_limit;
 2439              		.loc 1 734 47 discriminator 1 view .LVU726
 2440 0160 BA42     		cmp	r2, r7
 2441 0162 0EDA     		bge	.L160
 735:Core/Src/hall_detection.c **** 			gen->shifted_polarity[hall_C][i]=1;
 2442              		.loc 1 735 4 is_stmt 1 view .LVU727
 735:Core/Src/hall_detection.c **** 			gen->shifted_polarity[hall_C][i]=1;
 2443              		.loc 1 735 30 is_stmt 0 view .LVU728
 2444 0164 03F14801 		add	r1, r3, #72
 2445 0168 04EB8101 		add	r1, r4, r1, lsl #2
 2446 016c 92FBF6F0 		sdiv	r0, r2, r6
 2447 0170 06FB1022 		mls	r2, r6, r0, r2
 2448 0174 4A60     		str	r2, [r1, #4]
 736:Core/Src/hall_detection.c **** 		}else{
 2449              		.loc 1 736 4 is_stmt 1 view .LVU729
 736:Core/Src/hall_detection.c **** 		}else{
ARM GAS  /tmp/ccsur3Tq.s 			page 65


 2450              		.loc 1 736 36 is_stmt 0 view .LVU730
 2451 0176 03F15202 		add	r2, r3, #82
 2452 017a 0121     		movs	r1, #1
 2453 017c 44F82210 		str	r1, [r4, r2, lsl #2]
 2454 0180 04E0     		b	.L161
 2455              	.L160:
 738:Core/Src/hall_detection.c **** 		}
 2456              		.loc 1 738 4 is_stmt 1 view .LVU731
 738:Core/Src/hall_detection.c **** 		}
 2457              		.loc 1 738 36 is_stmt 0 view .LVU732
 2458 0182 03F15202 		add	r2, r3, #82
 2459 0186 0021     		movs	r1, #0
 2460 0188 44F82210 		str	r1, [r4, r2, lsl #2]
 2461              	.L161:
 742:Core/Src/hall_detection.c **** 			minimum[phase_A]=gen->differences_phaseA[i];
 2462              		.loc 1 742 3 is_stmt 1 view .LVU733
 742:Core/Src/hall_detection.c **** 			minimum[phase_A]=gen->differences_phaseA[i];
 2463              		.loc 1 742 29 is_stmt 0 view .LVU734
 2464 018c 03F14202 		add	r2, r3, #66
 2465 0190 04EB8202 		add	r2, r4, r2, lsl #2
 2466 0194 5268     		ldr	r2, [r2, #4]
 742:Core/Src/hall_detection.c **** 			minimum[phase_A]=gen->differences_phaseA[i];
 2467              		.loc 1 742 40 view .LVU735
 2468 0196 0199     		ldr	r1, [sp, #4]
 742:Core/Src/hall_detection.c **** 			minimum[phase_A]=gen->differences_phaseA[i];
 2469              		.loc 1 742 5 view .LVU736
 2470 0198 8A42     		cmp	r2, r1
 2471 019a 00DA     		bge	.L162
 743:Core/Src/hall_detection.c **** 		}
 2472              		.loc 1 743 4 is_stmt 1 view .LVU737
 743:Core/Src/hall_detection.c **** 		}
 2473              		.loc 1 743 20 is_stmt 0 view .LVU738
 2474 019c 0192     		str	r2, [sp, #4]
 2475              	.L162:
 746:Core/Src/hall_detection.c **** 			minimum[phase_B]=gen->differences_phaseB[i];
 2476              		.loc 1 746 3 is_stmt 1 view .LVU739
 746:Core/Src/hall_detection.c **** 			minimum[phase_B]=gen->differences_phaseB[i];
 2477              		.loc 1 746 29 is_stmt 0 view .LVU740
 2478 019e 03F14602 		add	r2, r3, #70
 2479 01a2 54F82220 		ldr	r2, [r4, r2, lsl #2]
 746:Core/Src/hall_detection.c **** 			minimum[phase_B]=gen->differences_phaseB[i];
 2480              		.loc 1 746 40 view .LVU741
 2481 01a6 0299     		ldr	r1, [sp, #8]
 746:Core/Src/hall_detection.c **** 			minimum[phase_B]=gen->differences_phaseB[i];
 2482              		.loc 1 746 5 view .LVU742
 2483 01a8 8A42     		cmp	r2, r1
 2484 01aa 00DA     		bge	.L163
 747:Core/Src/hall_detection.c **** 		}
 2485              		.loc 1 747 4 is_stmt 1 view .LVU743
 747:Core/Src/hall_detection.c **** 		}
 2486              		.loc 1 747 20 is_stmt 0 view .LVU744
 2487 01ac 0292     		str	r2, [sp, #8]
 2488              	.L163:
 750:Core/Src/hall_detection.c **** 			minimum[phase_C]=gen->differences_phaseC[i];
 2489              		.loc 1 750 3 is_stmt 1 view .LVU745
 750:Core/Src/hall_detection.c **** 			minimum[phase_C]=gen->differences_phaseC[i];
 2490              		.loc 1 750 29 is_stmt 0 view .LVU746
ARM GAS  /tmp/ccsur3Tq.s 			page 66


 2491 01ae 03F14802 		add	r2, r3, #72
 2492 01b2 04EB8202 		add	r2, r4, r2, lsl #2
 2493 01b6 5268     		ldr	r2, [r2, #4]
 750:Core/Src/hall_detection.c **** 			minimum[phase_C]=gen->differences_phaseC[i];
 2494              		.loc 1 750 40 view .LVU747
 2495 01b8 0399     		ldr	r1, [sp, #12]
 750:Core/Src/hall_detection.c **** 			minimum[phase_C]=gen->differences_phaseC[i];
 2496              		.loc 1 750 5 view .LVU748
 2497 01ba 8A42     		cmp	r2, r1
 2498 01bc 00DA     		bge	.L164
 751:Core/Src/hall_detection.c **** 		}
 2499              		.loc 1 751 4 is_stmt 1 view .LVU749
 751:Core/Src/hall_detection.c **** 		}
 2500              		.loc 1 751 20 is_stmt 0 view .LVU750
 2501 01be 0392     		str	r2, [sp, #12]
 2502              	.L164:
 714:Core/Src/hall_detection.c **** 		gen->differences_phaseA[i]/=MAXZEROCROSSINGS;
 2503              		.loc 1 714 43 discriminator 2 view .LVU751
 2504 01c0 0133     		adds	r3, r3, #1
 2505              	.LVL164:
 2506              	.L155:
 714:Core/Src/hall_detection.c **** 		gen->differences_phaseA[i]/=MAXZEROCROSSINGS;
 2507              		.loc 1 714 2 discriminator 1 view .LVU752
 2508 01c2 022B     		cmp	r3, #2
 2509 01c4 32D8     		bhi	.L173
 715:Core/Src/hall_detection.c **** 		gen->differences_phaseB[i]/=MAXZEROCROSSINGS;
 2510              		.loc 1 715 3 is_stmt 1 view .LVU753
 715:Core/Src/hall_detection.c **** 		gen->differences_phaseB[i]/=MAXZEROCROSSINGS;
 2511              		.loc 1 715 29 is_stmt 0 view .LVU754
 2512 01c6 03F14201 		add	r1, r3, #66
 2513 01ca 04EB8101 		add	r1, r4, r1, lsl #2
 2514 01ce 4868     		ldr	r0, [r1, #4]
 2515 01d0 344A     		ldr	r2, .L177+4
 2516 01d2 82FB00C5 		smull	ip, r5, r2, r0
 2517 01d6 A5EBE070 		sub	r0, r5, r0, asr #31
 2518 01da 4860     		str	r0, [r1, #4]
 716:Core/Src/hall_detection.c **** 		gen->differences_phaseC[i]/=MAXZEROCROSSINGS;
 2519              		.loc 1 716 3 is_stmt 1 view .LVU755
 716:Core/Src/hall_detection.c **** 		gen->differences_phaseC[i]/=MAXZEROCROSSINGS;
 2520              		.loc 1 716 29 is_stmt 0 view .LVU756
 2521 01dc 03F14605 		add	r5, r3, #70
 2522 01e0 54F82510 		ldr	r1, [r4, r5, lsl #2]
 2523 01e4 82FB01EC 		smull	lr, ip, r2, r1
 2524 01e8 ACEBE171 		sub	r1, ip, r1, asr #31
 2525 01ec 44F82510 		str	r1, [r4, r5, lsl #2]
 717:Core/Src/hall_detection.c **** 
 2526              		.loc 1 717 3 is_stmt 1 view .LVU757
 717:Core/Src/hall_detection.c **** 
 2527              		.loc 1 717 29 is_stmt 0 view .LVU758
 2528 01f0 03F14805 		add	r5, r3, #72
 2529 01f4 04EB8505 		add	r5, r4, r5, lsl #2
 2530 01f8 D5F804C0 		ldr	ip, [r5, #4]
 2531 01fc 82FB0CE2 		smull	lr, r2, r2, ip
 2532 0200 A2EBEC72 		sub	r2, r2, ip, asr #31
 2533 0204 6A60     		str	r2, [r5, #4]
 720:Core/Src/hall_detection.c **** 			gen->differences_phaseA[i]%=_bottom_limit;
 2534              		.loc 1 720 3 is_stmt 1 view .LVU759
ARM GAS  /tmp/ccsur3Tq.s 			page 67


 720:Core/Src/hall_detection.c **** 			gen->differences_phaseA[i]%=_bottom_limit;
 2535              		.loc 1 720 5 is_stmt 0 view .LVU760
 2536 0206 B042     		cmp	r0, r6
 2537 0208 87DD     		ble	.L156
 720:Core/Src/hall_detection.c **** 			gen->differences_phaseA[i]%=_bottom_limit;
 2538              		.loc 1 720 47 discriminator 1 view .LVU761
 2539 020a B842     		cmp	r0, r7
 2540 020c 85DA     		bge	.L156
 721:Core/Src/hall_detection.c **** 			gen->shifted_polarity[hall_A][i]=1;
 2541              		.loc 1 721 4 is_stmt 1 view .LVU762
 721:Core/Src/hall_detection.c **** 			gen->shifted_polarity[hall_A][i]=1;
 2542              		.loc 1 721 30 is_stmt 0 view .LVU763
 2543 020e 03F14202 		add	r2, r3, #66
 2544 0212 04EB8202 		add	r2, r4, r2, lsl #2
 2545 0216 90FBF6F5 		sdiv	r5, r0, r6
 2546 021a 06FB1500 		mls	r0, r6, r5, r0
 2547 021e 5060     		str	r0, [r2, #4]
 722:Core/Src/hall_detection.c **** 		}else{
 2548              		.loc 1 722 4 is_stmt 1 view .LVU764
 722:Core/Src/hall_detection.c **** 		}else{
 2549              		.loc 1 722 36 is_stmt 0 view .LVU765
 2550 0220 03F14C02 		add	r2, r3, #76
 2551 0224 0120     		movs	r0, #1
 2552 0226 44F82200 		str	r0, [r4, r2, lsl #2]
 2553 022a 7BE7     		b	.L157
 2554              	.L173:
 722:Core/Src/hall_detection.c **** 		}else{
 2555              		.loc 1 722 36 view .LVU766
 2556              	.LBE23:
 2557              	.LBB24:
 755:Core/Src/hall_detection.c **** 		if(gen->differences_phaseA[i]==minimum[phase_A]){
 2558              		.loc 1 755 16 view .LVU767
 2559 022c 0023     		movs	r3, #0
 2560              	.LVL165:
 755:Core/Src/hall_detection.c **** 		if(gen->differences_phaseA[i]==minimum[phase_A]){
 2561              		.loc 1 755 16 view .LVU768
 2562 022e 12E0     		b	.L166
 2563              	.LVL166:
 2564              	.L175:
 757:Core/Src/hall_detection.c **** 		}
 2565              		.loc 1 757 4 is_stmt 1 view .LVU769
 757:Core/Src/hall_detection.c **** 		}
 2566              		.loc 1 757 20 is_stmt 0 view .LVU770
 2567 0230 D4F85821 		ldr	r2, [r4, #344]
 757:Core/Src/hall_detection.c **** 		}
 2568              		.loc 1 757 52 view .LVU771
 2569 0234 04EB0212 		add	r2, r4, r2, lsl #4
 2570 0238 1A44     		add	r2, r2, r3
 2571 023a 0021     		movs	r1, #0
 2572 023c 82F86811 		strb	r1, [r2, #360]
 2573 0240 13E0     		b	.L167
 2574              	.L176:
 761:Core/Src/hall_detection.c **** 		}
 2575              		.loc 1 761 4 is_stmt 1 view .LVU772
 761:Core/Src/hall_detection.c **** 		}
 2576              		.loc 1 761 20 is_stmt 0 view .LVU773
 2577 0242 D4F85821 		ldr	r2, [r4, #344]
ARM GAS  /tmp/ccsur3Tq.s 			page 68


 761:Core/Src/hall_detection.c **** 		}
 2578              		.loc 1 761 52 view .LVU774
 2579 0246 04EB0212 		add	r2, r4, r2, lsl #4
 2580 024a 1A44     		add	r2, r2, r3
 2581 024c 0121     		movs	r1, #1
 2582 024e 82F86811 		strb	r1, [r2, #360]
 2583 0252 11E0     		b	.L168
 2584              	.L169:
 755:Core/Src/hall_detection.c **** 		if(gen->differences_phaseA[i]==minimum[phase_A]){
 2585              		.loc 1 755 43 discriminator 2 view .LVU775
 2586 0254 0133     		adds	r3, r3, #1
 2587              	.LVL167:
 2588              	.L166:
 755:Core/Src/hall_detection.c **** 		if(gen->differences_phaseA[i]==minimum[phase_A]){
 2589              		.loc 1 755 2 discriminator 1 view .LVU776
 2590 0256 022B     		cmp	r3, #2
 2591 0258 1FD8     		bhi	.L174
 756:Core/Src/hall_detection.c **** 			gen->results[gen->numberOfresults].hall_order[i]=phase_A;
 2592              		.loc 1 756 3 is_stmt 1 view .LVU777
 756:Core/Src/hall_detection.c **** 			gen->results[gen->numberOfresults].hall_order[i]=phase_A;
 2593              		.loc 1 756 29 is_stmt 0 view .LVU778
 2594 025a 03F14202 		add	r2, r3, #66
 2595 025e 04EB8202 		add	r2, r4, r2, lsl #2
 2596 0262 5168     		ldr	r1, [r2, #4]
 756:Core/Src/hall_detection.c **** 			gen->results[gen->numberOfresults].hall_order[i]=phase_A;
 2597              		.loc 1 756 41 view .LVU779
 2598 0264 019A     		ldr	r2, [sp, #4]
 756:Core/Src/hall_detection.c **** 			gen->results[gen->numberOfresults].hall_order[i]=phase_A;
 2599              		.loc 1 756 5 view .LVU780
 2600 0266 9142     		cmp	r1, r2
 2601 0268 E2D0     		beq	.L175
 2602              	.L167:
 760:Core/Src/hall_detection.c **** 			gen->results[gen->numberOfresults].hall_order[i]=phase_B;
 2603              		.loc 1 760 3 is_stmt 1 view .LVU781
 760:Core/Src/hall_detection.c **** 			gen->results[gen->numberOfresults].hall_order[i]=phase_B;
 2604              		.loc 1 760 29 is_stmt 0 view .LVU782
 2605 026a 03F14602 		add	r2, r3, #70
 2606 026e 54F82210 		ldr	r1, [r4, r2, lsl #2]
 760:Core/Src/hall_detection.c **** 			gen->results[gen->numberOfresults].hall_order[i]=phase_B;
 2607              		.loc 1 760 41 view .LVU783
 2608 0272 029A     		ldr	r2, [sp, #8]
 760:Core/Src/hall_detection.c **** 			gen->results[gen->numberOfresults].hall_order[i]=phase_B;
 2609              		.loc 1 760 5 view .LVU784
 2610 0274 9142     		cmp	r1, r2
 2611 0276 E4D0     		beq	.L176
 2612              	.L168:
 764:Core/Src/hall_detection.c **** 			gen->results[gen->numberOfresults].hall_order[i]=phase_C;
 2613              		.loc 1 764 3 is_stmt 1 view .LVU785
 764:Core/Src/hall_detection.c **** 			gen->results[gen->numberOfresults].hall_order[i]=phase_C;
 2614              		.loc 1 764 29 is_stmt 0 view .LVU786
 2615 0278 03F14802 		add	r2, r3, #72
 2616 027c 04EB8202 		add	r2, r4, r2, lsl #2
 2617 0280 5168     		ldr	r1, [r2, #4]
 764:Core/Src/hall_detection.c **** 			gen->results[gen->numberOfresults].hall_order[i]=phase_C;
 2618              		.loc 1 764 41 view .LVU787
 2619 0282 039A     		ldr	r2, [sp, #12]
 764:Core/Src/hall_detection.c **** 			gen->results[gen->numberOfresults].hall_order[i]=phase_C;
ARM GAS  /tmp/ccsur3Tq.s 			page 69


 2620              		.loc 1 764 5 view .LVU788
 2621 0284 9142     		cmp	r1, r2
 2622 0286 E5D1     		bne	.L169
 765:Core/Src/hall_detection.c **** 		}
 2623              		.loc 1 765 4 is_stmt 1 view .LVU789
 765:Core/Src/hall_detection.c **** 		}
 2624              		.loc 1 765 20 is_stmt 0 view .LVU790
 2625 0288 D4F85821 		ldr	r2, [r4, #344]
 765:Core/Src/hall_detection.c **** 		}
 2626              		.loc 1 765 52 view .LVU791
 2627 028c 04EB0212 		add	r2, r4, r2, lsl #4
 2628 0290 1A44     		add	r2, r2, r3
 2629 0292 0221     		movs	r1, #2
 2630 0294 82F86811 		strb	r1, [r2, #360]
 2631 0298 DCE7     		b	.L169
 2632              	.L174:
 765:Core/Src/hall_detection.c **** 		}
 2633              		.loc 1 765 52 view .LVU792
 2634              	.LBE24:
 768:Core/Src/hall_detection.c **** 
 2635              		.loc 1 768 1 view .LVU793
 2636 029a 05B0     		add	sp, sp, #20
 2637              	.LCFI32:
 2638              		.cfi_def_cfa_offset 28
 2639              		@ sp needed
 2640 029c BDE8F083 		pop	{r4, r5, r6, r7, r8, r9, pc}
 2641              	.LVL168:
 2642              	.L178:
 768:Core/Src/hall_detection.c **** 
 2643              		.loc 1 768 1 view .LVU794
 2644              		.align	3
 2645              	.L177:
 2646 02a0 00000000 		.word	.LANCHOR3
 2647 02a4 ABAAAA2A 		.word	715827883
 2648 02a8 66666666 		.word	1717986918
 2649 02ac 6666EE3F 		.word	1072588390
 2650              		.cfi_endproc
 2651              	.LFE252:
 2653              		.section	.text.interpretation,"ax",%progbits
 2654              		.align	1
 2655              		.global	interpretation
 2656              		.syntax unified
 2657              		.thumb
 2658              		.thumb_func
 2659              		.fpu fpv4-sp-d16
 2661              	interpretation:
 2662              	.LVL169:
 2663              	.LFB240:
 296:Core/Src/hall_detection.c **** 	//timeout
 2664              		.loc 1 296 84 is_stmt 1 view -0
 2665              		.cfi_startproc
 2666              		@ args = 0, pretend = 0, frame = 0
 2667              		@ frame_needed = 0, uses_anonymous_args = 0
 296:Core/Src/hall_detection.c **** 	//timeout
 2668              		.loc 1 296 84 is_stmt 0 view .LVU796
 2669 0000 38B5     		push	{r3, r4, r5, lr}
 2670              	.LCFI33:
ARM GAS  /tmp/ccsur3Tq.s 			page 70


 2671              		.cfi_def_cfa_offset 16
 2672              		.cfi_offset 3, -16
 2673              		.cfi_offset 4, -12
 2674              		.cfi_offset 5, -8
 2675              		.cfi_offset 14, -4
 298:Core/Src/hall_detection.c **** 		*state=detection_ERROR_OR_TIMEOUT;
 2676              		.loc 1 298 2 is_stmt 1 view .LVU797
 298:Core/Src/hall_detection.c **** 		*state=detection_ERROR_OR_TIMEOUT;
 2677              		.loc 1 298 11 is_stmt 0 view .LVU798
 2678 0002 0D4B     		ldr	r3, .L183
 2679 0004 1A68     		ldr	r2, [r3]
 298:Core/Src/hall_detection.c **** 		*state=detection_ERROR_OR_TIMEOUT;
 2680              		.loc 1 298 4 view .LVU799
 2681 0006 0D4B     		ldr	r3, .L183+4
 2682 0008 9A42     		cmp	r2, r3
 2683 000a 02D9     		bls	.L180
 299:Core/Src/hall_detection.c **** 		return;
 2684              		.loc 1 299 3 is_stmt 1 view .LVU800
 299:Core/Src/hall_detection.c **** 		return;
 2685              		.loc 1 299 9 is_stmt 0 view .LVU801
 2686 000c 0723     		movs	r3, #7
 2687 000e 0370     		strb	r3, [r0]
 300:Core/Src/hall_detection.c **** 	}
 2688              		.loc 1 300 3 is_stmt 1 view .LVU802
 2689              	.LVL170:
 2690              	.L179:
 307:Core/Src/hall_detection.c **** 
 2691              		.loc 1 307 1 is_stmt 0 view .LVU803
 2692 0010 38BD     		pop	{r3, r4, r5, pc}
 2693              	.LVL171:
 2694              	.L180:
 307:Core/Src/hall_detection.c **** 
 2695              		.loc 1 307 1 view .LVU804
 2696 0012 0C46     		mov	r4, r1
 2697 0014 0546     		mov	r5, r0
 302:Core/Src/hall_detection.c **** 	assign_polarity(gen);
 2698              		.loc 1 302 2 is_stmt 1 view .LVU805
 2699 0016 0846     		mov	r0, r1
 2700              	.LVL172:
 302:Core/Src/hall_detection.c **** 	assign_polarity(gen);
 2701              		.loc 1 302 2 is_stmt 0 view .LVU806
 2702 0018 FFF7FEFF 		bl	assign_closest_phase_to_hall
 2703              	.LVL173:
 303:Core/Src/hall_detection.c **** 	gen->numberOfresults++;
 2704              		.loc 1 303 2 is_stmt 1 view .LVU807
 2705 001c 2046     		mov	r0, r4
 2706 001e FFF7FEFF 		bl	assign_polarity
 2707              	.LVL174:
 304:Core/Src/hall_detection.c **** 	gen->start_adquisition_ticks=ticks;
 2708              		.loc 1 304 2 view .LVU808
 304:Core/Src/hall_detection.c **** 	gen->start_adquisition_ticks=ticks;
 2709              		.loc 1 304 5 is_stmt 0 view .LVU809
 2710 0022 D4F85831 		ldr	r3, [r4, #344]
 304:Core/Src/hall_detection.c **** 	gen->start_adquisition_ticks=ticks;
 2711              		.loc 1 304 22 view .LVU810
 2712 0026 0133     		adds	r3, r3, #1
 2713 0028 C4F85831 		str	r3, [r4, #344]
ARM GAS  /tmp/ccsur3Tq.s 			page 71


 305:Core/Src/hall_detection.c **** 	*state=detection_VALIDATION;
 2714              		.loc 1 305 2 is_stmt 1 view .LVU811
 305:Core/Src/hall_detection.c **** 	*state=detection_VALIDATION;
 2715              		.loc 1 305 30 is_stmt 0 view .LVU812
 2716 002c 024B     		ldr	r3, .L183
 2717 002e 1B68     		ldr	r3, [r3]
 2718 0030 2360     		str	r3, [r4]
 306:Core/Src/hall_detection.c **** }
 2719              		.loc 1 306 2 is_stmt 1 view .LVU813
 306:Core/Src/hall_detection.c **** }
 2720              		.loc 1 306 8 is_stmt 0 view .LVU814
 2721 0032 0523     		movs	r3, #5
 2722 0034 2B70     		strb	r3, [r5]
 2723 0036 EBE7     		b	.L179
 2724              	.L184:
 2725              		.align	2
 2726              	.L183:
 2727 0038 00000000 		.word	ticks
 2728 003c 38900D00 		.word	888888
 2729              		.cfi_endproc
 2730              	.LFE240:
 2732              		.section	.text.resetVariables_results,"ax",%progbits
 2733              		.align	1
 2734              		.global	resetVariables_results
 2735              		.syntax unified
 2736              		.thumb
 2737              		.thumb_func
 2738              		.fpu fpv4-sp-d16
 2740              	resetVariables_results:
 2741              	.LVL175:
 2742              	.LFB256:
 844:Core/Src/hall_detection.c **** 
 845:Core/Src/hall_detection.c **** /**
 846:Core/Src/hall_detection.c **** * \brief just resets to 0 the results (al resets are split like this because we are exection time c
 847:Core/Src/hall_detection.c **** * \param hall_detection_general_struct *gen, pointer to the huge structure.
 848:Core/Src/hall_detection.c **** */
 849:Core/Src/hall_detection.c **** void resetVariables_results(hall_detection_general_struct *gen){
 2743              		.loc 1 849 64 is_stmt 1 view -0
 2744              		.cfi_startproc
 2745              		@ args = 0, pretend = 0, frame = 0
 2746              		@ frame_needed = 0, uses_anonymous_args = 0
 2747              		@ link register save eliminated.
 2748              		.loc 1 849 64 is_stmt 0 view .LVU816
 2749 0000 70B4     		push	{r4, r5, r6}
 2750              	.LCFI34:
 2751              		.cfi_def_cfa_offset 12
 2752              		.cfi_offset 4, -12
 2753              		.cfi_offset 5, -8
 2754              		.cfi_offset 6, -4
 2755 0002 0446     		mov	r4, r0
 850:Core/Src/hall_detection.c **** 	gen->results[0]=empty_general.results[0];
 2756              		.loc 1 850 2 is_stmt 1 view .LVU817
 2757              		.loc 1 850 17 is_stmt 0 view .LVU818
 2758 0004 204D     		ldr	r5, .L187
 2759 0006 00F5B076 		add	r6, r0, #352
 2760 000a 05F5B073 		add	r3, r5, #352
 2761 000e 0FCB     		ldm	r3, {r0, r1, r2, r3}
ARM GAS  /tmp/ccsur3Tq.s 			page 72


 2762              	.LVL176:
 2763              		.loc 1 850 17 view .LVU819
 2764 0010 86E80F00 		stm	r6, {r0, r1, r2, r3}
 851:Core/Src/hall_detection.c **** 	gen->results[1]=empty_general.results[1];
 2765              		.loc 1 851 2 is_stmt 1 view .LVU820
 2766              		.loc 1 851 17 is_stmt 0 view .LVU821
 2767 0014 04F5B876 		add	r6, r4, #368
 2768 0018 05F5B873 		add	r3, r5, #368
 2769 001c 0FCB     		ldm	r3, {r0, r1, r2, r3}
 2770 001e 86E80F00 		stm	r6, {r0, r1, r2, r3}
 852:Core/Src/hall_detection.c **** 	gen->results[2]=empty_general.results[2];
 2771              		.loc 1 852 2 is_stmt 1 view .LVU822
 2772              		.loc 1 852 17 is_stmt 0 view .LVU823
 2773 0022 04F5C076 		add	r6, r4, #384
 2774 0026 05F5C073 		add	r3, r5, #384
 2775 002a 0FCB     		ldm	r3, {r0, r1, r2, r3}
 2776 002c 86E80F00 		stm	r6, {r0, r1, r2, r3}
 853:Core/Src/hall_detection.c **** 	gen->results[3]=empty_general.results[3];
 2777              		.loc 1 853 2 is_stmt 1 view .LVU824
 2778              		.loc 1 853 17 is_stmt 0 view .LVU825
 2779 0030 04F5C876 		add	r6, r4, #400
 2780 0034 05F5C873 		add	r3, r5, #400
 2781 0038 0FCB     		ldm	r3, {r0, r1, r2, r3}
 2782 003a 86E80F00 		stm	r6, {r0, r1, r2, r3}
 854:Core/Src/hall_detection.c **** 	gen->results[4]=empty_general.results[4];
 2783              		.loc 1 854 2 is_stmt 1 view .LVU826
 2784              		.loc 1 854 17 is_stmt 0 view .LVU827
 2785 003e 04F5D076 		add	r6, r4, #416
 2786 0042 05F5D073 		add	r3, r5, #416
 2787 0046 0FCB     		ldm	r3, {r0, r1, r2, r3}
 2788 0048 86E80F00 		stm	r6, {r0, r1, r2, r3}
 855:Core/Src/hall_detection.c **** 	gen->results[5]=empty_general.results[5];
 2789              		.loc 1 855 2 is_stmt 1 view .LVU828
 2790              		.loc 1 855 17 is_stmt 0 view .LVU829
 2791 004c 04F5D876 		add	r6, r4, #432
 2792 0050 05F5D875 		add	r5, r5, #432
 2793 0054 95E80F00 		ldm	r5, {r0, r1, r2, r3}
 2794 0058 86E80F00 		stm	r6, {r0, r1, r2, r3}
 856:Core/Src/hall_detection.c **** 
 857:Core/Src/hall_detection.c **** 	gen->shifted_polarity[0][0]=empty_general.shifted_polarity[0][0];
 2795              		.loc 1 857 2 is_stmt 1 view .LVU830
 2796              		.loc 1 857 29 is_stmt 0 view .LVU831
 2797 005c 0023     		movs	r3, #0
 2798 005e C4F83031 		str	r3, [r4, #304]
 858:Core/Src/hall_detection.c **** 	gen->shifted_polarity[0][1]=empty_general.shifted_polarity[0][0];
 2799              		.loc 1 858 2 is_stmt 1 view .LVU832
 2800              		.loc 1 858 29 is_stmt 0 view .LVU833
 2801 0062 C4F83431 		str	r3, [r4, #308]
 859:Core/Src/hall_detection.c **** 	gen->shifted_polarity[0][2]=empty_general.shifted_polarity[0][0];
 2802              		.loc 1 859 2 is_stmt 1 view .LVU834
 2803              		.loc 1 859 29 is_stmt 0 view .LVU835
 2804 0066 C4F83831 		str	r3, [r4, #312]
 860:Core/Src/hall_detection.c **** 
 861:Core/Src/hall_detection.c **** 	gen->shifted_polarity[1][0]=empty_general.shifted_polarity[0][0];
 2805              		.loc 1 861 2 is_stmt 1 view .LVU836
 2806              		.loc 1 861 29 is_stmt 0 view .LVU837
 2807 006a C4F83C31 		str	r3, [r4, #316]
ARM GAS  /tmp/ccsur3Tq.s 			page 73


 862:Core/Src/hall_detection.c **** 	gen->shifted_polarity[1][1]=empty_general.shifted_polarity[0][0];
 2808              		.loc 1 862 2 is_stmt 1 view .LVU838
 2809              		.loc 1 862 29 is_stmt 0 view .LVU839
 2810 006e C4F84031 		str	r3, [r4, #320]
 863:Core/Src/hall_detection.c **** 	gen->shifted_polarity[1][2]=empty_general.shifted_polarity[0][0];
 2811              		.loc 1 863 2 is_stmt 1 view .LVU840
 2812              		.loc 1 863 29 is_stmt 0 view .LVU841
 2813 0072 C4F84431 		str	r3, [r4, #324]
 864:Core/Src/hall_detection.c **** 
 865:Core/Src/hall_detection.c **** 	gen->shifted_polarity[2][0]=empty_general.shifted_polarity[0][0];
 2814              		.loc 1 865 2 is_stmt 1 view .LVU842
 2815              		.loc 1 865 29 is_stmt 0 view .LVU843
 2816 0076 C4F84831 		str	r3, [r4, #328]
 866:Core/Src/hall_detection.c **** 	gen->shifted_polarity[2][1]=empty_general.shifted_polarity[0][0];
 2817              		.loc 1 866 2 is_stmt 1 view .LVU844
 2818              		.loc 1 866 29 is_stmt 0 view .LVU845
 2819 007a C4F84C31 		str	r3, [r4, #332]
 867:Core/Src/hall_detection.c **** 	gen->shifted_polarity[2][2]=empty_general.shifted_polarity[0][0];
 2820              		.loc 1 867 2 is_stmt 1 view .LVU846
 2821              		.loc 1 867 29 is_stmt 0 view .LVU847
 2822 007e C4F85031 		str	r3, [r4, #336]
 868:Core/Src/hall_detection.c **** }
 2823              		.loc 1 868 1 view .LVU848
 2824 0082 70BC     		pop	{r4, r5, r6}
 2825              	.LCFI35:
 2826              		.cfi_restore 6
 2827              		.cfi_restore 5
 2828              		.cfi_restore 4
 2829              		.cfi_def_cfa_offset 0
 2830              	.LVL177:
 2831              		.loc 1 868 1 view .LVU849
 2832 0084 7047     		bx	lr
 2833              	.L188:
 2834 0086 00BF     		.align	2
 2835              	.L187:
 2836 0088 00000000 		.word	.LANCHOR2
 2837              		.cfi_endproc
 2838              	.LFE256:
 2840              		.global	__aeabi_d2uiz
 2841              		.section	.text.wait_for_the_current_stationary,"ax",%progbits
 2842              		.align	1
 2843              		.global	wait_for_the_current_stationary
 2844              		.syntax unified
 2845              		.thumb
 2846              		.thumb_func
 2847              		.fpu fpv4-sp-d16
 2849              	wait_for_the_current_stationary:
 2850              	.LVL178:
 2851              	.LFB238:
 228:Core/Src/hall_detection.c **** 	//timeout or currentisstationary
 2852              		.loc 1 228 4 is_stmt 1 view -0
 2853              		.cfi_startproc
 2854              		@ args = 12, pretend = 0, frame = 0
 2855              		@ frame_needed = 0, uses_anonymous_args = 0
 228:Core/Src/hall_detection.c **** 	//timeout or currentisstationary
 2856              		.loc 1 228 4 is_stmt 0 view .LVU851
 2857 0000 30B5     		push	{r4, r5, lr}
ARM GAS  /tmp/ccsur3Tq.s 			page 74


 2858              	.LCFI36:
 2859              		.cfi_def_cfa_offset 12
 2860              		.cfi_offset 4, -12
 2861              		.cfi_offset 5, -8
 2862              		.cfi_offset 14, -4
 2863 0002 83B0     		sub	sp, sp, #12
 2864              	.LCFI37:
 2865              		.cfi_def_cfa_offset 24
 2866 0004 0546     		mov	r5, r0
 2867 0006 0C46     		mov	r4, r1
 2868 0008 1146     		mov	r1, r2
 2869              	.LVL179:
 228:Core/Src/hall_detection.c **** 	//timeout or currentisstationary
 2870              		.loc 1 228 4 view .LVU852
 2871 000a 1A46     		mov	r2, r3
 2872              	.LVL180:
 230:Core/Src/hall_detection.c **** 	//timeout
 2873              		.loc 1 230 2 is_stmt 1 view .LVU853
 2874 000c 089B     		ldr	r3, [sp, #32]
 2875              	.LVL181:
 230:Core/Src/hall_detection.c **** 	//timeout
 2876              		.loc 1 230 2 is_stmt 0 view .LVU854
 2877 000e 0193     		str	r3, [sp, #4]
 2878 0010 079B     		ldr	r3, [sp, #28]
 2879 0012 0093     		str	r3, [sp]
 2880 0014 069B     		ldr	r3, [sp, #24]
 2881 0016 2046     		mov	r0, r4
 2882              	.LVL182:
 230:Core/Src/hall_detection.c **** 	//timeout
 2883              		.loc 1 230 2 view .LVU855
 2884 0018 FFF7FEFF 		bl	fill_buffers
 2885              	.LVL183:
 232:Core/Src/hall_detection.c **** 		*state=detection_ERROR_OR_TIMEOUT;
 2886              		.loc 1 232 2 is_stmt 1 view .LVU856
 232:Core/Src/hall_detection.c **** 		*state=detection_ERROR_OR_TIMEOUT;
 2887              		.loc 1 232 11 is_stmt 0 view .LVU857
 2888 001c 224B     		ldr	r3, .L197+8
 2889 001e 1B68     		ldr	r3, [r3]
 232:Core/Src/hall_detection.c **** 		*state=detection_ERROR_OR_TIMEOUT;
 2890              		.loc 1 232 4 view .LVU858
 2891 0020 224A     		ldr	r2, .L197+12
 2892 0022 9342     		cmp	r3, r2
 2893 0024 06D8     		bhi	.L194
 238:Core/Src/hall_detection.c **** 		if(detect_N_zerocrossings(gen,WAITING_STATIONARY_MAXZEROCROSSINGS)==YES){
 2894              		.loc 1 238 2 is_stmt 1 view .LVU859
 238:Core/Src/hall_detection.c **** 		if(detect_N_zerocrossings(gen,WAITING_STATIONARY_MAXZEROCROSSINGS)==YES){
 2895              		.loc 1 238 18 is_stmt 0 view .LVU860
 2896 0026 224A     		ldr	r2, .L197+16
 2897 0028 1268     		ldr	r2, [r2]
 238:Core/Src/hall_detection.c **** 		if(detect_N_zerocrossings(gen,WAITING_STATIONARY_MAXZEROCROSSINGS)==YES){
 2898              		.loc 1 238 42 view .LVU861
 2899 002a 0232     		adds	r2, r2, #2
 238:Core/Src/hall_detection.c **** 		if(detect_N_zerocrossings(gen,WAITING_STATIONARY_MAXZEROCROSSINGS)==YES){
 2900              		.loc 1 238 4 view .LVU862
 2901 002c 9342     		cmp	r3, r2
 2902 002e 04D8     		bhi	.L195
 2903              	.L189:
ARM GAS  /tmp/ccsur3Tq.s 			page 75


 253:Core/Src/hall_detection.c **** 
 2904              		.loc 1 253 1 view .LVU863
 2905 0030 03B0     		add	sp, sp, #12
 2906              	.LCFI38:
 2907              		.cfi_remember_state
 2908              		.cfi_def_cfa_offset 12
 2909              		@ sp needed
 2910 0032 30BD     		pop	{r4, r5, pc}
 2911              	.LVL184:
 2912              	.L194:
 2913              	.LCFI39:
 2914              		.cfi_restore_state
 233:Core/Src/hall_detection.c **** 		return;
 2915              		.loc 1 233 3 is_stmt 1 view .LVU864
 233:Core/Src/hall_detection.c **** 		return;
 2916              		.loc 1 233 9 is_stmt 0 view .LVU865
 2917 0034 0723     		movs	r3, #7
 2918 0036 2B70     		strb	r3, [r5]
 234:Core/Src/hall_detection.c **** 	}
 2919              		.loc 1 234 3 is_stmt 1 view .LVU866
 2920 0038 FAE7     		b	.L189
 2921              	.L195:
 239:Core/Src/hall_detection.c **** 			if(are_all_periods_stable(gen,WAITING_STATIONARY_MAXZEROCROSSINGS)==YES){
 2922              		.loc 1 239 3 view .LVU867
 239:Core/Src/hall_detection.c **** 			if(are_all_periods_stable(gen,WAITING_STATIONARY_MAXZEROCROSSINGS)==YES){
 2923              		.loc 1 239 6 is_stmt 0 view .LVU868
 2924 003a 0621     		movs	r1, #6
 2925 003c 2046     		mov	r0, r4
 2926 003e FFF7FEFF 		bl	detect_N_zerocrossings
 2927              	.LVL185:
 239:Core/Src/hall_detection.c **** 			if(are_all_periods_stable(gen,WAITING_STATIONARY_MAXZEROCROSSINGS)==YES){
 2928              		.loc 1 239 5 view .LVU869
 2929 0042 0128     		cmp	r0, #1
 2930 0044 F4D1     		bne	.L189
 240:Core/Src/hall_detection.c **** 				gen->lowpassfilter_ticks=gen->results[gen->numberOfresults].electricPeriod_ticks*0.1;
 2931              		.loc 1 240 4 is_stmt 1 view .LVU870
 240:Core/Src/hall_detection.c **** 				gen->lowpassfilter_ticks=gen->results[gen->numberOfresults].electricPeriod_ticks*0.1;
 2932              		.loc 1 240 7 is_stmt 0 view .LVU871
 2933 0046 0621     		movs	r1, #6
 2934 0048 2046     		mov	r0, r4
 2935 004a FFF7FEFF 		bl	are_all_periods_stable
 2936              	.LVL186:
 240:Core/Src/hall_detection.c **** 				gen->lowpassfilter_ticks=gen->results[gen->numberOfresults].electricPeriod_ticks*0.1;
 2937              		.loc 1 240 6 view .LVU872
 2938 004e 0128     		cmp	r0, #1
 2939 0050 07D0     		beq	.L196
 248:Core/Src/hall_detection.c **** 				general.start_adquisition_ticks=ticks;
 2940              		.loc 1 248 5 is_stmt 1 view .LVU873
 2941 0052 2046     		mov	r0, r4
 2942 0054 FFF7FEFF 		bl	resetVariables_adquisition
 2943              	.LVL187:
 249:Core/Src/hall_detection.c **** 			}
 2944              		.loc 1 249 5 view .LVU874
 249:Core/Src/hall_detection.c **** 			}
 2945              		.loc 1 249 36 is_stmt 0 view .LVU875
 2946 0058 134B     		ldr	r3, .L197+8
 2947 005a 1A68     		ldr	r2, [r3]
ARM GAS  /tmp/ccsur3Tq.s 			page 76


 2948 005c 144B     		ldr	r3, .L197+16
 2949 005e 1A60     		str	r2, [r3]
 2950 0060 E6E7     		b	.L189
 2951              	.L196:
 241:Core/Src/hall_detection.c **** 				resetVariables_adquisition(gen);
 2952              		.loc 1 241 5 is_stmt 1 view .LVU876
 241:Core/Src/hall_detection.c **** 				resetVariables_adquisition(gen);
 2953              		.loc 1 241 46 is_stmt 0 view .LVU877
 2954 0062 D4F85831 		ldr	r3, [r4, #344]
 241:Core/Src/hall_detection.c **** 				resetVariables_adquisition(gen);
 2955              		.loc 1 241 64 view .LVU878
 2956 0066 1633     		adds	r3, r3, #22
 2957 0068 04EB0313 		add	r3, r4, r3, lsl #4
 241:Core/Src/hall_detection.c **** 				resetVariables_adquisition(gen);
 2958              		.loc 1 241 85 view .LVU879
 2959 006c 5868     		ldr	r0, [r3, #4]
 2960 006e FFF7FEFF 		bl	__aeabi_ui2d
 2961              	.LVL188:
 2962 0072 0BA3     		adr	r3, .L197
 2963 0074 D3E90023 		ldrd	r2, [r3]
 2964 0078 FFF7FEFF 		bl	__aeabi_dmul
 2965              	.LVL189:
 241:Core/Src/hall_detection.c **** 				resetVariables_adquisition(gen);
 2966              		.loc 1 241 29 view .LVU880
 2967 007c FFF7FEFF 		bl	__aeabi_d2uiz
 2968              	.LVL190:
 2969 0080 C4F85401 		str	r0, [r4, #340]
 242:Core/Src/hall_detection.c **** 				resetVariables_results(gen);
 2970              		.loc 1 242 5 is_stmt 1 view .LVU881
 2971 0084 2046     		mov	r0, r4
 2972 0086 FFF7FEFF 		bl	resetVariables_adquisition
 2973              	.LVL191:
 243:Core/Src/hall_detection.c **** 				general.start_adquisition_ticks=ticks;
 2974              		.loc 1 243 5 view .LVU882
 2975 008a 2046     		mov	r0, r4
 2976 008c FFF7FEFF 		bl	resetVariables_results
 2977              	.LVL192:
 244:Core/Src/hall_detection.c **** 				*state=detection_ADQUISITION;
 2978              		.loc 1 244 5 view .LVU883
 244:Core/Src/hall_detection.c **** 				*state=detection_ADQUISITION;
 2979              		.loc 1 244 36 is_stmt 0 view .LVU884
 2980 0090 054B     		ldr	r3, .L197+8
 2981 0092 1A68     		ldr	r2, [r3]
 2982 0094 064B     		ldr	r3, .L197+16
 2983 0096 1A60     		str	r2, [r3]
 245:Core/Src/hall_detection.c **** 				return;
 2984              		.loc 1 245 5 is_stmt 1 view .LVU885
 245:Core/Src/hall_detection.c **** 				return;
 2985              		.loc 1 245 11 is_stmt 0 view .LVU886
 2986 0098 0323     		movs	r3, #3
 2987 009a 2B70     		strb	r3, [r5]
 246:Core/Src/hall_detection.c **** 			}else{
 2988              		.loc 1 246 5 is_stmt 1 view .LVU887
 2989 009c C8E7     		b	.L189
 2990              	.L198:
 2991 009e 00BF     		.align	3
 2992              	.L197:
ARM GAS  /tmp/ccsur3Tq.s 			page 77


 2993 00a0 9A999999 		.word	2576980378
 2994 00a4 9999B93F 		.word	1069128089
 2995 00a8 00000000 		.word	ticks
 2996 00ac 38900D00 		.word	888888
 2997 00b0 00000000 		.word	.LANCHOR1
 2998              		.cfi_endproc
 2999              	.LFE238:
 3001              		.section	.text.error_handler,"ax",%progbits
 3002              		.align	1
 3003              		.global	error_handler
 3004              		.syntax unified
 3005              		.thumb
 3006              		.thumb_func
 3007              		.fpu fpv4-sp-d16
 3009              	error_handler:
 3010              	.LFB257:
 869:Core/Src/hall_detection.c **** 
 870:Core/Src/hall_detection.c **** /**
 871:Core/Src/hall_detection.c **** * \brief for now just sends "error" via uart but it should do much more in the future
 872:Core/Src/hall_detection.c **** */
 873:Core/Src/hall_detection.c **** void error_handler(){
 3011              		.loc 1 873 21 view -0
 3012              		.cfi_startproc
 3013              		@ args = 0, pretend = 0, frame = 8
 3014              		@ frame_needed = 0, uses_anonymous_args = 0
 3015 0000 00B5     		push	{lr}
 3016              	.LCFI40:
 3017              		.cfi_def_cfa_offset 4
 3018              		.cfi_offset 14, -4
 3019 0002 83B0     		sub	sp, sp, #12
 3020              	.LCFI41:
 3021              		.cfi_def_cfa_offset 16
 874:Core/Src/hall_detection.c **** const uint8_t error_message[]="error";
 3022              		.loc 1 874 1 view .LVU889
 3023              		.loc 1 874 15 is_stmt 0 view .LVU890
 3024 0004 074B     		ldr	r3, .L201
 3025 0006 93E80300 		ldm	r3, {r0, r1}
 3026 000a 0090     		str	r0, [sp]
 3027 000c ADF80410 		strh	r1, [sp, #4]	@ movhi
 875:Core/Src/hall_detection.c **** #ifdef TESTuart
 876:Core/Src/hall_detection.c **** 	HAL_UART_Transmit(&huart2, (const uint8_t *)&error_message, sizeof(error_message),100);
 3028              		.loc 1 876 2 is_stmt 1 view .LVU891
 3029 0010 6423     		movs	r3, #100
 3030 0012 0622     		movs	r2, #6
 3031 0014 6946     		mov	r1, sp
 3032 0016 0448     		ldr	r0, .L201+4
 3033 0018 FFF7FEFF 		bl	HAL_UART_Transmit
 3034              	.LVL193:
 877:Core/Src/hall_detection.c **** #endif
 878:Core/Src/hall_detection.c **** }
 3035              		.loc 1 878 1 is_stmt 0 view .LVU892
 3036 001c 03B0     		add	sp, sp, #12
 3037              	.LCFI42:
 3038              		.cfi_def_cfa_offset 4
 3039              		@ sp needed
 3040 001e 5DF804FB 		ldr	pc, [sp], #4
 3041              	.L202:
ARM GAS  /tmp/ccsur3Tq.s 			page 78


 3042 0022 00BF     		.align	2
 3043              	.L201:
 3044 0024 00000000 		.word	.LC1
 3045 0028 00000000 		.word	huart2
 3046              		.cfi_endproc
 3047              	.LFE257:
 3049              		.section	.text.Hall_Identification_Test_measurement,"ax",%progbits
 3050              		.align	1
 3051              		.global	Hall_Identification_Test_measurement
 3052              		.syntax unified
 3053              		.thumb
 3054              		.thumb_func
 3055              		.fpu fpv4-sp-d16
 3057              	Hall_Identification_Test_measurement:
 3058              	.LVL194:
 3059              	.LFB237:
 174:Core/Src/hall_detection.c **** 	switch (detection_state) {
 3060              		.loc 1 174 4 is_stmt 1 view -0
 3061              		.cfi_startproc
 3062              		@ args = 4, pretend = 0, frame = 0
 3063              		@ frame_needed = 0, uses_anonymous_args = 0
 174:Core/Src/hall_detection.c **** 	switch (detection_state) {
 3064              		.loc 1 174 4 is_stmt 0 view .LVU894
 3065 0000 F0B5     		push	{r4, r5, r6, r7, lr}
 3066              	.LCFI43:
 3067              		.cfi_def_cfa_offset 20
 3068              		.cfi_offset 4, -20
 3069              		.cfi_offset 5, -16
 3070              		.cfi_offset 6, -12
 3071              		.cfi_offset 7, -8
 3072              		.cfi_offset 14, -4
 3073 0002 85B0     		sub	sp, sp, #20
 3074              	.LCFI44:
 3075              		.cfi_def_cfa_offset 40
 3076 0004 0446     		mov	r4, r0
 3077 0006 0D46     		mov	r5, r1
 3078 0008 1646     		mov	r6, r2
 175:Core/Src/hall_detection.c **** 		case detection_ENABLED:
 3079              		.loc 1 175 2 is_stmt 1 view .LVU895
 3080 000a 2F4A     		ldr	r2, .L214
 3081              	.LVL195:
 175:Core/Src/hall_detection.c **** 		case detection_ENABLED:
 3082              		.loc 1 175 2 is_stmt 0 view .LVU896
 3083 000c 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 3084 000e 013A     		subs	r2, r2, #1
 3085 0010 062A     		cmp	r2, #6
 3086 0012 11D8     		bhi	.L203
 3087 0014 DFE802F0 		tbb	[pc, r2]
 3088              	.LVL196:
 3089              	.L206:
 3090 0018 04       		.byte	(.L212-.L206)/2
 3091 0019 12       		.byte	(.L211-.L206)/2
 3092 001a 21       		.byte	(.L210-.L206)/2
 3093 001b 30       		.byte	(.L209-.L206)/2
 3094 001c 39       		.byte	(.L208-.L206)/2
 3095 001d 42       		.byte	(.L207-.L206)/2
 3096 001e 52       		.byte	(.L205-.L206)/2
ARM GAS  /tmp/ccsur3Tq.s 			page 79


 3097 001f 00       		.p2align 1
 3098              	.L212:
 177:Core/Src/hall_detection.c **** 			general.lowpassfilter_ticks=15;//minimum value
 3099              		.loc 1 177 4 is_stmt 1 view .LVU897
 177:Core/Src/hall_detection.c **** 			general.lowpassfilter_ticks=15;//minimum value
 3100              		.loc 1 177 9 is_stmt 0 view .LVU898
 3101 0020 2A4B     		ldr	r3, .L214+4
 3102              	.LVL197:
 177:Core/Src/hall_detection.c **** 			general.lowpassfilter_ticks=15;//minimum value
 3103              		.loc 1 177 9 view .LVU899
 3104 0022 0022     		movs	r2, #0
 3105 0024 1A60     		str	r2, [r3]
 178:Core/Src/hall_detection.c **** 			resetVariables_adquisition(&general);
 3106              		.loc 1 178 4 is_stmt 1 view .LVU900
 178:Core/Src/hall_detection.c **** 			resetVariables_adquisition(&general);
 3107              		.loc 1 178 31 is_stmt 0 view .LVU901
 3108 0026 2A48     		ldr	r0, .L214+8
 3109              	.LVL198:
 178:Core/Src/hall_detection.c **** 			resetVariables_adquisition(&general);
 3110              		.loc 1 178 31 view .LVU902
 3111 0028 0F23     		movs	r3, #15
 3112 002a C0F85431 		str	r3, [r0, #340]
 179:Core/Src/hall_detection.c **** 			detection_state=detection_WAIT_CURRENT_STATIONARY;
 3113              		.loc 1 179 4 is_stmt 1 view .LVU903
 3114 002e FFF7FEFF 		bl	resetVariables_adquisition
 3115              	.LVL199:
 180:Core/Src/hall_detection.c **** 			break;
 3116              		.loc 1 180 4 view .LVU904
 180:Core/Src/hall_detection.c **** 			break;
 3117              		.loc 1 180 19 is_stmt 0 view .LVU905
 3118 0032 254B     		ldr	r3, .L214
 3119 0034 0222     		movs	r2, #2
 3120 0036 1A70     		strb	r2, [r3]
 181:Core/Src/hall_detection.c **** 		case detection_WAIT_CURRENT_STATIONARY:
 3121              		.loc 1 181 4 is_stmt 1 view .LVU906
 3122              	.L203:
 210:Core/Src/hall_detection.c **** 
 3123              		.loc 1 210 1 is_stmt 0 view .LVU907
 3124 0038 05B0     		add	sp, sp, #20
 3125              	.LCFI45:
 3126              		.cfi_remember_state
 3127              		.cfi_def_cfa_offset 20
 3128              		@ sp needed
 3129 003a F0BD     		pop	{r4, r5, r6, r7, pc}
 3130              	.LVL200:
 3131              	.L211:
 3132              	.LCFI46:
 3133              		.cfi_restore_state
 183:Core/Src/hall_detection.c **** 			ticks++;
 3134              		.loc 1 183 4 is_stmt 1 view .LVU908
 3135 003c 0A9A     		ldr	r2, [sp, #40]
 3136 003e 0292     		str	r2, [sp, #8]
 3137 0040 0193     		str	r3, [sp, #4]
 3138 0042 0096     		str	r6, [sp]
 3139 0044 2B46     		mov	r3, r5
 3140              	.LVL201:
 183:Core/Src/hall_detection.c **** 			ticks++;
ARM GAS  /tmp/ccsur3Tq.s 			page 80


 3141              		.loc 1 183 4 is_stmt 0 view .LVU909
 3142 0046 0246     		mov	r2, r0
 3143 0048 2149     		ldr	r1, .L214+8
 3144 004a 1F48     		ldr	r0, .L214
 3145              	.LVL202:
 183:Core/Src/hall_detection.c **** 			ticks++;
 3146              		.loc 1 183 4 view .LVU910
 3147 004c FFF7FEFF 		bl	wait_for_the_current_stationary
 3148              	.LVL203:
 184:Core/Src/hall_detection.c **** 			break;
 3149              		.loc 1 184 4 is_stmt 1 view .LVU911
 184:Core/Src/hall_detection.c **** 			break;
 3150              		.loc 1 184 9 is_stmt 0 view .LVU912
 3151 0050 1E4A     		ldr	r2, .L214+4
 3152 0052 1368     		ldr	r3, [r2]
 3153 0054 0133     		adds	r3, r3, #1
 3154 0056 1360     		str	r3, [r2]
 185:Core/Src/hall_detection.c **** 		case detection_ADQUISITION:
 3155              		.loc 1 185 4 is_stmt 1 view .LVU913
 3156 0058 EEE7     		b	.L203
 3157              	.LVL204:
 3158              	.L210:
 187:Core/Src/hall_detection.c **** 			ticks++;
 3159              		.loc 1 187 4 view .LVU914
 3160 005a 0A9A     		ldr	r2, [sp, #40]
 3161 005c 0292     		str	r2, [sp, #8]
 3162 005e 0193     		str	r3, [sp, #4]
 3163 0060 0096     		str	r6, [sp]
 3164 0062 2B46     		mov	r3, r5
 3165              	.LVL205:
 187:Core/Src/hall_detection.c **** 			ticks++;
 3166              		.loc 1 187 4 is_stmt 0 view .LVU915
 3167 0064 0246     		mov	r2, r0
 3168 0066 1A49     		ldr	r1, .L214+8
 3169 0068 1748     		ldr	r0, .L214
 3170              	.LVL206:
 187:Core/Src/hall_detection.c **** 			ticks++;
 3171              		.loc 1 187 4 view .LVU916
 3172 006a FFF7FEFF 		bl	adquisition
 3173              	.LVL207:
 188:Core/Src/hall_detection.c **** 			break;
 3174              		.loc 1 188 4 is_stmt 1 view .LVU917
 188:Core/Src/hall_detection.c **** 			break;
 3175              		.loc 1 188 9 is_stmt 0 view .LVU918
 3176 006e 174A     		ldr	r2, .L214+4
 3177 0070 1368     		ldr	r3, [r2]
 3178 0072 0133     		adds	r3, r3, #1
 3179 0074 1360     		str	r3, [r2]
 189:Core/Src/hall_detection.c **** 		case detection_INTERPRETATION:
 3180              		.loc 1 189 4 is_stmt 1 view .LVU919
 3181 0076 DFE7     		b	.L203
 3182              	.LVL208:
 3183              	.L209:
 191:Core/Src/hall_detection.c **** 			ticks++;
 3184              		.loc 1 191 4 view .LVU920
 3185 0078 1549     		ldr	r1, .L214+8
 3186 007a 1348     		ldr	r0, .L214
ARM GAS  /tmp/ccsur3Tq.s 			page 81


 3187              	.LVL209:
 191:Core/Src/hall_detection.c **** 			ticks++;
 3188              		.loc 1 191 4 is_stmt 0 view .LVU921
 3189 007c FFF7FEFF 		bl	interpretation
 3190              	.LVL210:
 192:Core/Src/hall_detection.c **** 			break;
 3191              		.loc 1 192 4 is_stmt 1 view .LVU922
 192:Core/Src/hall_detection.c **** 			break;
 3192              		.loc 1 192 9 is_stmt 0 view .LVU923
 3193 0080 124A     		ldr	r2, .L214+4
 3194 0082 1368     		ldr	r3, [r2]
 3195 0084 0133     		adds	r3, r3, #1
 3196 0086 1360     		str	r3, [r2]
 193:Core/Src/hall_detection.c **** 		case detection_VALIDATION:
 3197              		.loc 1 193 4 is_stmt 1 view .LVU924
 3198 0088 D6E7     		b	.L203
 3199              	.LVL211:
 3200              	.L208:
 195:Core/Src/hall_detection.c **** 			ticks++;
 3201              		.loc 1 195 4 view .LVU925
 3202 008a 1149     		ldr	r1, .L214+8
 3203 008c 0E48     		ldr	r0, .L214
 3204              	.LVL212:
 195:Core/Src/hall_detection.c **** 			ticks++;
 3205              		.loc 1 195 4 is_stmt 0 view .LVU926
 3206 008e FFF7FEFF 		bl	validation
 3207              	.LVL213:
 196:Core/Src/hall_detection.c **** 			break;
 3208              		.loc 1 196 4 is_stmt 1 view .LVU927
 196:Core/Src/hall_detection.c **** 			break;
 3209              		.loc 1 196 9 is_stmt 0 view .LVU928
 3210 0092 0E4A     		ldr	r2, .L214+4
 3211 0094 1368     		ldr	r3, [r2]
 3212 0096 0133     		adds	r3, r3, #1
 3213 0098 1360     		str	r3, [r2]
 197:Core/Src/hall_detection.c **** 		case detection_PRESENTATION_FINISH:
 3214              		.loc 1 197 4 is_stmt 1 view .LVU929
 3215 009a CDE7     		b	.L203
 3216              	.LVL214:
 3217              	.L207:
 199:Core/Src/hall_detection.c **** 			swap_hall_gpios_with_detected_results(&general,H1_gpio, H2_gpio, H3_gpio);
 3218              		.loc 1 199 4 view .LVU930
 3219 009c 0C4F     		ldr	r7, .L214+8
 3220 009e 3946     		mov	r1, r7
 3221 00a0 0948     		ldr	r0, .L214
 3222              	.LVL215:
 199:Core/Src/hall_detection.c **** 			swap_hall_gpios_with_detected_results(&general,H1_gpio, H2_gpio, H3_gpio);
 3223              		.loc 1 199 4 is_stmt 0 view .LVU931
 3224 00a2 FFF7FEFF 		bl	present_and_finish
 3225              	.LVL216:
 200:Core/Src/hall_detection.c **** 			ticks++;
 3226              		.loc 1 200 4 is_stmt 1 view .LVU932
 3227 00a6 3346     		mov	r3, r6
 3228 00a8 2A46     		mov	r2, r5
 3229 00aa 2146     		mov	r1, r4
 3230 00ac 3846     		mov	r0, r7
 3231 00ae FFF7FEFF 		bl	swap_hall_gpios_with_detected_results
ARM GAS  /tmp/ccsur3Tq.s 			page 82


 3232              	.LVL217:
 201:Core/Src/hall_detection.c **** 			break;
 3233              		.loc 1 201 4 view .LVU933
 201:Core/Src/hall_detection.c **** 			break;
 3234              		.loc 1 201 9 is_stmt 0 view .LVU934
 3235 00b2 064A     		ldr	r2, .L214+4
 3236 00b4 1368     		ldr	r3, [r2]
 3237 00b6 0133     		adds	r3, r3, #1
 3238 00b8 1360     		str	r3, [r2]
 202:Core/Src/hall_detection.c **** 		case detection_ERROR_OR_TIMEOUT:
 3239              		.loc 1 202 4 is_stmt 1 view .LVU935
 3240 00ba BDE7     		b	.L203
 3241              	.LVL218:
 3242              	.L205:
 204:Core/Src/hall_detection.c **** 			detection_state=detection_DISABLED;
 3243              		.loc 1 204 4 view .LVU936
 3244 00bc FFF7FEFF 		bl	error_handler
 3245              	.LVL219:
 205:Core/Src/hall_detection.c **** 		case detection_DISABLED://do nothing
 3246              		.loc 1 205 4 view .LVU937
 205:Core/Src/hall_detection.c **** 		case detection_DISABLED://do nothing
 3247              		.loc 1 205 19 is_stmt 0 view .LVU938
 3248 00c0 014B     		ldr	r3, .L214
 3249 00c2 0022     		movs	r2, #0
 3250 00c4 1A70     		strb	r2, [r3]
 210:Core/Src/hall_detection.c **** 
 3251              		.loc 1 210 1 view .LVU939
 3252 00c6 B7E7     		b	.L203
 3253              	.L215:
 3254              		.align	2
 3255              	.L214:
 3256 00c8 00000000 		.word	.LANCHOR0
 3257 00cc 00000000 		.word	ticks
 3258 00d0 00000000 		.word	.LANCHOR1
 3259              		.cfi_endproc
 3260              	.LFE237:
 3262              		.global	empty_general
 3263              		.global	general
 3264              		.global	detection_state
 3265              		.comm	ticks,4,4
 3266              		.section	.rodata
 3267              		.align	2
 3268              		.set	.LANCHOR3,. + 0
 3269              	.LC0:
 3270 0000 FF000000 		.word	255
 3271 0004 FF000000 		.word	255
 3272 0008 FF000000 		.word	255
 3273              		.section	.bss.detection_state,"aw",%nobits
 3274              		.set	.LANCHOR0,. + 0
 3277              	detection_state:
 3278 0000 00       		.space	1
 3279              		.section	.bss.general,"aw",%nobits
 3280              		.align	2
 3281              		.set	.LANCHOR1,. + 0
 3284              	general:
 3285 0000 00000000 		.space	456
 3285      00000000 
ARM GAS  /tmp/ccsur3Tq.s 			page 83


 3285      00000000 
 3285      00000000 
 3285      00000000 
 3286              		.section	.rodata.empty_general,"a"
 3287              		.align	2
 3288              		.set	.LANCHOR2,. + 0
 3291              	empty_general:
 3292 0000 00000000 		.space	456
 3292      00000000 
 3292      00000000 
 3292      00000000 
 3292      00000000 
 3293              		.section	.rodata.error_handler.str1.4,"aMS",%progbits,1
 3294              		.align	2
 3295              	.LC1:
 3296 0000 6572726F 		.ascii	"error\000"
 3296      7200
 3297              		.text
 3298              	.Letext0:
 3299              		.file 2 "/usr/lib/gcc/arm-none-eabi/8.3.1/include/stdint.h"
 3300              		.file 3 "Drivers/CMSIS/Include/core_cm4.h"
 3301              		.file 4 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/system_stm32f4xx.h"
 3302              		.file 5 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f446xx.h"
 3303              		.file 6 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_def.h"
 3304              		.file 7 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_gpio.h"
 3305              		.file 8 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_dma.h"
 3306              		.file 9 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_uart.h"
 3307              		.file 10 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal.h"
 3308              		.file 11 "Core/Inc/main.h"
 3309              		.file 12 "Core/Inc/hall_detection.h"
 3310              		.file 13 "Core/Inc/usart.h"
ARM GAS  /tmp/ccsur3Tq.s 			page 84


DEFINED SYMBOLS
                            *ABS*:0000000000000000 hall_detection.c
     /tmp/ccsur3Tq.s:18     .text.Hall_start_detection:0000000000000000 $t
     /tmp/ccsur3Tq.s:26     .text.Hall_start_detection:0000000000000000 Hall_start_detection
     /tmp/ccsur3Tq.s:44     .text.Hall_start_detection:0000000000000008 $d
     /tmp/ccsur3Tq.s:49     .text.Hall_is_detection_finished:0000000000000000 $t
     /tmp/ccsur3Tq.s:56     .text.Hall_is_detection_finished:0000000000000000 Hall_is_detection_finished
     /tmp/ccsur3Tq.s:80     .text.Hall_is_detection_finished:0000000000000010 $d
     /tmp/ccsur3Tq.s:85     .text.present_and_finish:0000000000000000 $t
     /tmp/ccsur3Tq.s:92     .text.present_and_finish:0000000000000000 present_and_finish
     /tmp/ccsur3Tq.s:259    .text.present_and_finish:00000000000000b4 $d
     /tmp/ccsur3Tq.s:265    .text.fill_buffers:0000000000000000 $t
     /tmp/ccsur3Tq.s:272    .text.fill_buffers:0000000000000000 fill_buffers
     /tmp/ccsur3Tq.s:384    .text.detect_N_current_zerocrossings:0000000000000000 $t
     /tmp/ccsur3Tq.s:391    .text.detect_N_current_zerocrossings:0000000000000000 detect_N_current_zerocrossings
     /tmp/ccsur3Tq.s:536    .text.detect_N_hall_zerocrossings:0000000000000000 $t
     /tmp/ccsur3Tq.s:543    .text.detect_N_hall_zerocrossings:0000000000000000 detect_N_hall_zerocrossings
     /tmp/ccsur3Tq.s:610    .text.detect_N_zerocrossings:0000000000000000 $t
     /tmp/ccsur3Tq.s:617    .text.detect_N_zerocrossings:0000000000000000 detect_N_zerocrossings
     /tmp/ccsur3Tq.s:774    .text.detect_N_zerocrossings:00000000000000c0 $d
                            *COM*:0000000000000004 ticks
     /tmp/ccsur3Tq.s:780    .text.calculateElectricPeriod_inTicks:0000000000000000 $t
     /tmp/ccsur3Tq.s:787    .text.calculateElectricPeriod_inTicks:0000000000000000 calculateElectricPeriod_inTicks
     /tmp/ccsur3Tq.s:925    .text.calculateElectricPeriod_inTicks:0000000000000098 $d
     /tmp/ccsur3Tq.s:930    .text.adquisition:0000000000000000 $t
     /tmp/ccsur3Tq.s:937    .text.adquisition:0000000000000000 adquisition
     /tmp/ccsur3Tq.s:1032   .text.adquisition:0000000000000054 $d
     /tmp/ccsur3Tq.s:1042   .text.is_deviation_from_period_acceptable:0000000000000000 $t
     /tmp/ccsur3Tq.s:1049   .text.is_deviation_from_period_acceptable:0000000000000000 is_deviation_from_period_acceptable
     /tmp/ccsur3Tq.s:1190   .text.is_deviation_from_period_acceptable:0000000000000080 $d
     /tmp/ccsur3Tq.s:1197   .text.are_all_periods_stable:0000000000000000 $t
     /tmp/ccsur3Tq.s:1204   .text.are_all_periods_stable:0000000000000000 are_all_periods_stable
     /tmp/ccsur3Tq.s:1238   .text.swap_hall_gpios_with_detected_results:0000000000000000 $t
     /tmp/ccsur3Tq.s:1245   .text.swap_hall_gpios_with_detected_results:0000000000000000 swap_hall_gpios_with_detected_results
     /tmp/ccsur3Tq.s:1509   .text.absolute:0000000000000000 $t
     /tmp/ccsur3Tq.s:1516   .text.absolute:0000000000000000 absolute
     /tmp/ccsur3Tq.s:1536   .text.assign_polarity:0000000000000000 $t
     /tmp/ccsur3Tq.s:1543   .text.assign_polarity:0000000000000000 assign_polarity
     /tmp/ccsur3Tq.s:1693   .text.resetVariables_adquisition:0000000000000000 $t
     /tmp/ccsur3Tq.s:1700   .text.resetVariables_adquisition:0000000000000000 resetVariables_adquisition
     /tmp/ccsur3Tq.s:1822   .text.resetVariables_adquisition:00000000000000bc $d
     /tmp/ccsur3Tq.s:1827   .text.resetVariables_diferences:0000000000000000 $t
     /tmp/ccsur3Tq.s:1834   .text.resetVariables_diferences:0000000000000000 resetVariables_diferences
     /tmp/ccsur3Tq.s:1876   .text.validation:0000000000000000 $t
     /tmp/ccsur3Tq.s:1883   .text.validation:0000000000000000 validation
     /tmp/ccsur3Tq.s:2201   .text.validation:0000000000000150 $d
     /tmp/ccsur3Tq.s:2208   .text.assign_closest_phase_to_hall:0000000000000000 $t
     /tmp/ccsur3Tq.s:2215   .text.assign_closest_phase_to_hall:0000000000000000 assign_closest_phase_to_hall
     /tmp/ccsur3Tq.s:2646   .text.assign_closest_phase_to_hall:00000000000002a0 $d
     /tmp/ccsur3Tq.s:2654   .text.interpretation:0000000000000000 $t
     /tmp/ccsur3Tq.s:2661   .text.interpretation:0000000000000000 interpretation
     /tmp/ccsur3Tq.s:2727   .text.interpretation:0000000000000038 $d
     /tmp/ccsur3Tq.s:2733   .text.resetVariables_results:0000000000000000 $t
     /tmp/ccsur3Tq.s:2740   .text.resetVariables_results:0000000000000000 resetVariables_results
     /tmp/ccsur3Tq.s:2836   .text.resetVariables_results:0000000000000088 $d
     /tmp/ccsur3Tq.s:2842   .text.wait_for_the_current_stationary:0000000000000000 $t
     /tmp/ccsur3Tq.s:2849   .text.wait_for_the_current_stationary:0000000000000000 wait_for_the_current_stationary
ARM GAS  /tmp/ccsur3Tq.s 			page 85


     /tmp/ccsur3Tq.s:2993   .text.wait_for_the_current_stationary:00000000000000a0 $d
     /tmp/ccsur3Tq.s:3002   .text.error_handler:0000000000000000 $t
     /tmp/ccsur3Tq.s:3009   .text.error_handler:0000000000000000 error_handler
     /tmp/ccsur3Tq.s:3044   .text.error_handler:0000000000000024 $d
     /tmp/ccsur3Tq.s:3050   .text.Hall_Identification_Test_measurement:0000000000000000 $t
     /tmp/ccsur3Tq.s:3057   .text.Hall_Identification_Test_measurement:0000000000000000 Hall_Identification_Test_measurement
     /tmp/ccsur3Tq.s:3090   .text.Hall_Identification_Test_measurement:0000000000000018 $d
     /tmp/ccsur3Tq.s:3256   .text.Hall_Identification_Test_measurement:00000000000000c8 $d
     /tmp/ccsur3Tq.s:3291   .rodata.empty_general:0000000000000000 empty_general
     /tmp/ccsur3Tq.s:3284   .bss.general:0000000000000000 general
     /tmp/ccsur3Tq.s:3277   .bss.detection_state:0000000000000000 detection_state
     /tmp/ccsur3Tq.s:3267   .rodata:0000000000000000 $d
     /tmp/ccsur3Tq.s:3278   .bss.detection_state:0000000000000000 $d
     /tmp/ccsur3Tq.s:3280   .bss.general:0000000000000000 $d
     /tmp/ccsur3Tq.s:3287   .rodata.empty_general:0000000000000000 $d
     /tmp/ccsur3Tq.s:3294   .rodata.error_handler.str1.4:0000000000000000 $d
     /tmp/ccsur3Tq.s:3097   .text.Hall_Identification_Test_measurement:000000000000001f $d
     /tmp/ccsur3Tq.s:3097   .text.Hall_Identification_Test_measurement:0000000000000020 $t

UNDEFINED SYMBOLS
HAL_UART_Transmit
huart2
__aeabi_ui2d
__aeabi_dmul
__aeabi_d2f
__aeabi_d2iz
__aeabi_d2uiz
